MainProcess| 2023-05-14 14:59:27,978,978 multiprocessing INFO Starting run 	 | See log at : logs/run_ct-20230514-145927_insite-sindy-wsindy-crn-msm-gnet-ct-rmsn_cancer_sim-EQ_5_A-EQ_5_B-EQ_5_C-EQ_5_D-EQ_4_A-EQ_4_B-EQ_4_C-EQ_4_D_1_100-runs_log.txt
MainProcess| 2023-05-14 14:59:27,978,978 multiprocessing INFO [Main Config] {'run': {'epochs': 100, 'log_path': 'logs/run_ct-20230514-145927_insite-sindy-wsindy-crn-msm-gnet-ct-rmsn_cancer_sim-EQ_5_A-EQ_5_B-EQ_5_C-EQ_5_D-EQ_4_A-EQ_4_B-EQ_4_C-EQ_4_D_1_100-runs_log.txt', 'device': 'cuda:0', 'window': 50, 'train_samples': 1000, 'val_samples': 100, 'test_samples': 100, 'obs_noise': 0.01, 'bsv_noise': 0.01, 'domain_conf': 2.0, 'step_actions': 5, 'batch_size': 32, 'normalize_data': True, 'clip_grad_norm': 1.0, 'clip_grad_norm_on': True}, 'sindy': {'sindy_alpha': 0.5, 'dataset_params': {'sindy_threshold': {'cancer_sim': 0.001, 'EQ_5': 0.001, 'EQ_4': 0.1}, 'lam': {'cancer_sim': 10.0, 'EQ_5': 10.0, 'EQ_4': 10.0}}}, 'tecde': {'learning_rate': 0.01, 'hidden_channels_x': 8, 'hidden_units': 128, 'mcd': True, 'early_stopping': {'patience': 5, 'delta': 0.0001}}, 'gnet': {'mcsamples': 25}, 'setup': {'debug_mode': False, 'flush_mode': False, 'multi_process_results': False, 'multi_process_cores': 1, 'experiment': 'MAIN_TABLE', 'ct_methods_to_evaluate': ['insite', 'sindy', 'wsindy', 'crn', 'msm', 'gnet', 'ct', 'rmsn'], 'ct_datasets_to_evaluate': ['cancer_sim', 'EQ_5_A', 'EQ_5_B', 'EQ_5_C', 'EQ_5_D', 'EQ_4_A', 'EQ_4_B', 'EQ_4_C', 'EQ_4_D'], 'domain_confs': [0, 1, 2, 3, 4, 8, 16, 32, 64], 'wandb': {'project': 'CausalODEs', 'track': False}, 'log_dir': 'logs', 'torch_deterministic': True, 'seed_start': 1, 'seed_runs': 100, 'normalize_obs': True, 'cuda': True, 'load_from_cache': True, 'force_recache': False, 'treatment_mode': 'multilabel'}}
MainProcess| 2023-05-14 15:00:52,864,864 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 15:00:52,867,867 multiprocessing INFO Running cancer_sim sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:00:52,911,911 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:01:05,977,977 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 13.10905866900066, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:01:05,977,977 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 1, 2.0)
MainProcess| 2023-05-14 15:01:05,980,980 multiprocessing INFO Running cancer_sim crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:01:06,029,29 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:05:53,168,168 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.06268292454092, 'encoder_val_rmse_orig': 1.0185164722474689, 'encoder_test_rmse_all': 0.7746653931686749, 'encoder_test_rmse_orig': 0.5829092504394606, 'encoder_test_rmse_last': 0.7284312746750706, 'decoder_val_rmse_all': 0.34263807473017144, 'decoder_val_rmse_orig': 0.34263807473017127, 'decoder_test_rmse_2-step': 0.6653631231084373, 'decoder_test_rmse_3-step': 0.7147503351281943, 'decoder_test_rmse_4-step': 0.7729628218293052, 'decoder_test_rmse_5-step': 0.8250582189671155, 'decoder_test_rmse_6-step': 0.8677147141722886, 'method': 'crn', 'seed': 1, 'seconds_taken': 287.1877499839993, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:05:53,168,168 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 1, 2.0)
MainProcess| 2023-05-14 15:05:53,171,171 multiprocessing INFO Running cancer_sim msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:05:53,226,226 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:06:04,738,738 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 1, 'seconds_taken': 11.566778726999473, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:06:04,738,738 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 15:06:04,741,741 multiprocessing INFO Running cancer_sim gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:06:04,790,790 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:10:25,617,617 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1050623612458037, 'encoder_val_rmse_orig': 1.0584320730304118, 'encoder_test_rmse_all': 0.8019866274314194, 'encoder_test_rmse_orig': 0.5997718008667244, 'encoder_test_rmse_last': 0.6990883279107463, 'decoder_val_rmse_all': 1.1050623612458037, 'decoder_val_rmse_orig': 1.0584320730304118, 'decoder_test_rmse_2-step': 0.885196964358888, 'decoder_test_rmse_3-step': 1.1058341562345777, 'decoder_test_rmse_4-step': 1.2145851000361385, 'decoder_test_rmse_5-step': 1.3248688054118525, 'decoder_test_rmse_6-step': 1.4106658365650617, 'method': 'gnet', 'seed': 1, 'seconds_taken': 260.8760243100005, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:10:25,617,617 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 1, 2.0)
MainProcess| 2023-05-14 15:10:25,620,620 multiprocessing INFO Running cancer_sim ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:10:25,671,671 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:11:16,457,457 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.013156261326404, 'encoder_val_rmse_orig': 0.9719144027593891, 'encoder_test_rmse_all': 0.877858218587956, 'encoder_test_rmse_orig': 0.6648541309594466, 'encoder_test_rmse_last': 0.7540026107581562, 'decoder_val_rmse_all': 1.013156261326404, 'decoder_val_rmse_orig': 0.9719144027593891, 'decoder_test_rmse_2-step': 0.861185695925199, 'decoder_test_rmse_3-step': 0.8774626271151987, 'decoder_test_rmse_4-step': 0.935508505741203, 'decoder_test_rmse_5-step': 1.0138453879260754, 'decoder_test_rmse_6-step': 1.0698510210655698, 'method': 'ct', 'seed': 1, 'seconds_taken': 50.836724142000094, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:11:16,457,457 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 15:11:16,459,459 multiprocessing INFO Running cancer_sim rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:11:16,520,520 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:15:40,773,773 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7689925254727594, 'propensity_treatment_val_bce_orig': 0.7688794615379384, 'propensity_treatment_test_bce_all': 0.7607377907398682, 'propensity_treatment_test_bce_orig': 0.7626326572446259, 'propensity_history_val_bce_all': 0.761699319802458, 'propensity_history_val_bce_orig': 0.7617326213456971, 'propensity_history_test_bce_all': 0.7565688178862477, 'propensity_history_test_bce_orig': 0.7583786026268402, 'encoder_val_rmse_all': 1.3050429177574725, 'encoder_val_rmse_orig': 1.2498677015386954, 'encoder_test_rmse_all': 0.9083909637452883, 'encoder_test_rmse_orig': 0.6723945587810504, 'encoder_test_rmse_last': 0.8258003033918394, 'decoder_val_rmse_all': 0.3588953269839261, 'decoder_val_rmse_orig': 0.35889532698392607, 'decoder_test_rmse_2-step': 0.7954166227130959, 'decoder_test_rmse_3-step': 0.8482957918807311, 'decoder_test_rmse_4-step': 0.9494147769898184, 'decoder_test_rmse_5-step': 1.0845129382400112, 'decoder_test_rmse_6-step': 1.223936346377057, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 264.3132388670001, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:17:56,357,357 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 15:17:56,360,360 multiprocessing INFO Running EQ_5_A sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:17:56,409,409 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:18:09,867,867 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 13.505980486001135, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:18:09,867,867 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 1, 2.0)
MainProcess| 2023-05-14 15:18:09,870,870 multiprocessing INFO Running EQ_5_A crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:18:09,921,921 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:22:59,519,519 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8435595525187143, 'encoder_val_rmse_orig': 0.8160495817267719, 'encoder_test_rmse_all': 0.9208770235643234, 'encoder_test_rmse_orig': 0.6679501100522303, 'encoder_test_rmse_last': 0.7982959607193547, 'decoder_val_rmse_all': 0.33610744227725825, 'decoder_val_rmse_orig': 0.3361074422772584, 'decoder_test_rmse_2-step': 0.7869699182597362, 'decoder_test_rmse_3-step': 0.8826970141522764, 'decoder_test_rmse_4-step': 0.9911444109225986, 'decoder_test_rmse_5-step': 1.0886488406001051, 'decoder_test_rmse_6-step': 1.1508090569083256, 'method': 'crn', 'seed': 1, 'seconds_taken': 289.6496239219996, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:22:59,519,519 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 1, 2.0)
MainProcess| 2023-05-14 15:22:59,522,522 multiprocessing INFO Running EQ_5_A msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:22:59,569,569 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:23:10,731,731 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 1, 'seconds_taken': 11.208351847000813, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:23:10,731,731 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 15:23:10,734,734 multiprocessing INFO Running EQ_5_A gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:23:10,783,783 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:27:39,127,127 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8358280767909109, 'encoder_val_rmse_orig': 0.8082640415099204, 'encoder_test_rmse_all': 0.8274217876505288, 'encoder_test_rmse_orig': 0.5985920010836169, 'encoder_test_rmse_last': 0.8062464192170016, 'decoder_val_rmse_all': 0.8358280767909109, 'decoder_val_rmse_orig': 0.8082640415099204, 'decoder_test_rmse_2-step': 0.7802083541190897, 'decoder_test_rmse_3-step': 0.9007238019930068, 'decoder_test_rmse_4-step': 1.0013928747392349, 'decoder_test_rmse_5-step': 1.0818339837209239, 'decoder_test_rmse_6-step': 1.1247773292125927, 'method': 'gnet', 'seed': 1, 'seconds_taken': 268.39278614999967, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:27:39,127,127 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 1, 2.0)
MainProcess| 2023-05-14 15:27:39,130,130 multiprocessing INFO Running EQ_5_A ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:27:39,180,180 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:28:27,621,621 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9513060222624242, 'encoder_val_rmse_orig': 0.9202486348302394, 'encoder_test_rmse_all': 1.1704856141572166, 'encoder_test_rmse_orig': 0.8587425686928649, 'encoder_test_rmse_last': 1.05349056062788, 'decoder_val_rmse_all': 0.9513060222624242, 'decoder_val_rmse_orig': 0.9202486348302394, 'decoder_test_rmse_2-step': 1.0008793674374532, 'decoder_test_rmse_3-step': 1.0951214175234072, 'decoder_test_rmse_4-step': 1.1706759015648989, 'decoder_test_rmse_5-step': 1.1993963090882445, 'decoder_test_rmse_6-step': 1.2036732507072212, 'method': 'ct', 'seed': 1, 'seconds_taken': 48.490882499998406, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:28:27,621,621 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 15:28:27,624,624 multiprocessing INFO Running EQ_5_A rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:28:27,678,678 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:32:52,168,168 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7686869394558006, 'propensity_treatment_val_bce_orig': 0.7686004371977853, 'propensity_treatment_test_bce_all': 0.7634032663957202, 'propensity_treatment_test_bce_orig': 0.762752623604007, 'propensity_history_val_bce_all': 0.7613044074227078, 'propensity_history_val_bce_orig': 0.7613247667103908, 'propensity_history_test_bce_all': 0.7593818462611547, 'propensity_history_test_bce_orig': 0.7586795490293593, 'encoder_val_rmse_all': 1.3830030174342638, 'encoder_val_rmse_orig': 1.3362557753204658, 'encoder_test_rmse_all': 1.378467093718381, 'encoder_test_rmse_orig': 0.9923431859896094, 'encoder_test_rmse_last': 1.1904532467569635, 'decoder_val_rmse_all': 0.2603111179353095, 'decoder_val_rmse_orig': 0.2603111179353098, 'decoder_test_rmse_2-step': 1.0472698342402265, 'decoder_test_rmse_3-step': 1.131484407587482, 'decoder_test_rmse_4-step': 1.2832249051784115, 'decoder_test_rmse_5-step': 1.4115165028454262, 'decoder_test_rmse_6-step': 1.4810524376659497, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 264.5443803929993, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:34:28,877,877 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 15:34:28,880,880 multiprocessing INFO Running EQ_5_B sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:34:28,933,933 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:34:42,481,481 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 13.600934021000285, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:34:42,481,481 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 1, 2.0)
MainProcess| 2023-05-14 15:34:42,484,484 multiprocessing INFO Running EQ_5_B crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:34:42,528,528 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:39:35,457,457 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8435274987228089, 'encoder_val_rmse_orig': 0.816018617859592, 'encoder_test_rmse_all': 0.9209172182573339, 'encoder_test_rmse_orig': 0.6679793829805898, 'encoder_test_rmse_last': 0.7983289914717986, 'decoder_val_rmse_all': 0.33609448941796294, 'decoder_val_rmse_orig': 0.3360944894179632, 'decoder_test_rmse_2-step': 0.7869587514367606, 'decoder_test_rmse_3-step': 0.8826880570588768, 'decoder_test_rmse_4-step': 0.9911345759756323, 'decoder_test_rmse_5-step': 1.0886450871111701, 'decoder_test_rmse_6-step': 1.1508082707234024, 'method': 'crn', 'seed': 1, 'seconds_taken': 292.9730331770006, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:39:35,458,458 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 1, 2.0)
MainProcess| 2023-05-14 15:39:35,460,460 multiprocessing INFO Running EQ_5_B msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:39:35,510,510 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:39:46,716,716 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 1, 'seconds_taken': 11.255513219999557, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:39:46,716,716 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 15:39:46,719,719 multiprocessing INFO Running EQ_5_B gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:39:46,769,769 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:44:23,142,142 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8357932959146269, 'encoder_val_rmse_orig': 0.8082305456238361, 'encoder_test_rmse_all': 0.8274148658906232, 'encoder_test_rmse_orig': 0.5985872894005668, 'encoder_test_rmse_last': 0.8062431436007494, 'decoder_val_rmse_all': 0.8357932959146269, 'decoder_val_rmse_orig': 0.8082305456238361, 'decoder_test_rmse_2-step': 0.7810990722973172, 'decoder_test_rmse_3-step': 0.9204783535718979, 'decoder_test_rmse_4-step': 1.0082754960764295, 'decoder_test_rmse_5-step': 1.0948119355686965, 'decoder_test_rmse_6-step': 1.1435286039860464, 'method': 'gnet', 'seed': 1, 'seconds_taken': 276.4228138239996, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:44:23,142,142 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 1, 2.0)
MainProcess| 2023-05-14 15:44:23,145,145 multiprocessing INFO Running EQ_5_B ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:44:23,197,197 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:45:12,326,326 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9497140680561665, 'encoder_val_rmse_orig': 0.9187067675123232, 'encoder_test_rmse_all': 1.1595240889294085, 'encoder_test_rmse_orig': 0.8515271761530483, 'encoder_test_rmse_last': 1.0545196235224477, 'decoder_val_rmse_all': 0.9497140680561665, 'decoder_val_rmse_orig': 0.9187067675123232, 'decoder_test_rmse_2-step': 1.0044133509665514, 'decoder_test_rmse_3-step': 1.0944187770619787, 'decoder_test_rmse_4-step': 1.1761685423456105, 'decoder_test_rmse_5-step': 1.20910203015602, 'decoder_test_rmse_6-step': 1.2142468973805407, 'method': 'ct', 'seed': 1, 'seconds_taken': 49.18123510100122, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:45:12,327,327 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 15:45:12,329,329 multiprocessing INFO Running EQ_5_B rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:45:12,381,381 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:49:39,753,753 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7686869394558006, 'propensity_treatment_val_bce_orig': 0.7686004371977853, 'propensity_treatment_test_bce_all': 0.7634032663957202, 'propensity_treatment_test_bce_orig': 0.762752623604007, 'propensity_history_val_bce_all': 0.7604670479272916, 'propensity_history_val_bce_orig': 0.7604859299765031, 'propensity_history_test_bce_all': 0.7585564013784107, 'propensity_history_test_bce_orig': 0.7578911997309418, 'encoder_val_rmse_all': 1.3831151852560608, 'encoder_val_rmse_orig': 1.3363630678691274, 'encoder_test_rmse_all': 1.3792640837154535, 'encoder_test_rmse_orig': 0.992914954800375, 'encoder_test_rmse_last': 1.1914391226419816, 'decoder_val_rmse_all': 0.2599871399512296, 'decoder_val_rmse_orig': 0.25998713995122946, 'decoder_test_rmse_2-step': 1.0496635393780591, 'decoder_test_rmse_3-step': 1.1375460889696976, 'decoder_test_rmse_4-step': 1.2927660547898572, 'decoder_test_rmse_5-step': 1.418511948731489, 'decoder_test_rmse_6-step': 1.482884680075961, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 267.42320472699976, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:51:18,265,265 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 15:51:18,271,271 multiprocessing INFO Running EQ_5_C sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:51:18,319,319 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:51:31,796,796 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 13.524974570000268, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:51:31,796,796 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 1, 2.0)
MainProcess| 2023-05-14 15:51:31,799,799 multiprocessing INFO Running EQ_5_C crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:51:31,850,850 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:56:23,285,285 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5805433239530011, 'encoder_val_rmse_orig': 0.5650638704744158, 'encoder_test_rmse_all': 0.8066441895304046, 'encoder_test_rmse_orig': 0.5897554918578098, 'encoder_test_rmse_last': 0.8067400224092086, 'decoder_val_rmse_all': 0.3382570510111482, 'decoder_val_rmse_orig': 0.3382570510111483, 'decoder_test_rmse_2-step': 0.7909903226852304, 'decoder_test_rmse_3-step': 0.8467760933602902, 'decoder_test_rmse_4-step': 0.9231306996164366, 'decoder_test_rmse_5-step': 1.005987714495251, 'decoder_test_rmse_6-step': 1.0859580376571398, 'method': 'crn', 'seed': 1, 'seconds_taken': 291.4857431189994, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:56:23,285,285 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 1, 2.0)
MainProcess| 2023-05-14 15:56:23,288,288 multiprocessing INFO Running EQ_5_C msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:56:23,334,334 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 15:56:34,805,805 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 1, 'seconds_taken': 11.517421055999876, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 15:56:34,806,806 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 15:56:34,808,808 multiprocessing INFO Running EQ_5_C gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 15:56:34,856,856 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:01:04,462,462 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5799172253336583, 'encoder_val_rmse_orig': 0.564721365937369, 'encoder_test_rmse_all': 0.8524232044384591, 'encoder_test_rmse_orig': 0.6326210862338305, 'encoder_test_rmse_last': 0.9979769430363485, 'decoder_val_rmse_all': 0.5799172253336583, 'decoder_val_rmse_orig': 0.564721365937369, 'decoder_test_rmse_2-step': 0.952800152169391, 'decoder_test_rmse_3-step': 1.048097757267271, 'decoder_test_rmse_4-step': 1.1030281720269166, 'decoder_test_rmse_5-step': 1.139103721522255, 'decoder_test_rmse_6-step': 1.1419218088605818, 'method': 'gnet', 'seed': 1, 'seconds_taken': 269.6533142089993, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:01:04,462,462 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 1, 2.0)
MainProcess| 2023-05-14 16:01:04,465,465 multiprocessing INFO Running EQ_5_C ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:01:04,515,515 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:01:52,983,983 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7083416052756529, 'encoder_val_rmse_orig': 0.6894545059300727, 'encoder_test_rmse_all': 1.1384044928968817, 'encoder_test_rmse_orig': 0.8261850445167598, 'encoder_test_rmse_last': 1.015924518166441, 'decoder_val_rmse_all': 0.7083416052756529, 'decoder_val_rmse_orig': 0.6894545059300727, 'decoder_test_rmse_2-step': 0.9625155921357355, 'decoder_test_rmse_3-step': 1.0059095650222223, 'decoder_test_rmse_4-step': 0.9630112748313057, 'decoder_test_rmse_5-step': 0.9418231224099842, 'decoder_test_rmse_6-step': 0.9199046431769362, 'method': 'ct', 'seed': 1, 'seconds_taken': 48.51838564099853, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:01:52,983,983 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 16:01:52,986,986 multiprocessing INFO Running EQ_5_C rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:01:53,043,43 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:06:17,956,956 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7686102620650598, 'propensity_treatment_val_bce_orig': 0.7685871647876562, 'propensity_treatment_test_bce_all': 0.756507437415617, 'propensity_treatment_test_bce_orig': 0.7596810126326302, 'propensity_history_val_bce_all': 0.7602726883346521, 'propensity_history_val_bce_orig': 0.7603581065016761, 'propensity_history_test_bce_all': 0.7510972200900785, 'propensity_history_test_bce_orig': 0.7540869930490877, 'encoder_val_rmse_all': 1.133955002995517, 'encoder_val_rmse_orig': 1.1020631635911016, 'encoder_test_rmse_all': 1.0953908667459398, 'encoder_test_rmse_orig': 0.795146005781223, 'encoder_test_rmse_last': 1.1257618462226906, 'decoder_val_rmse_all': 0.3546629432884535, 'decoder_val_rmse_orig': 0.3546629432884539, 'decoder_test_rmse_2-step': 1.1088289112394014, 'decoder_test_rmse_3-step': 1.0677647547797577, 'decoder_test_rmse_4-step': 0.9964854751133014, 'decoder_test_rmse_5-step': 0.9238481586679426, 'decoder_test_rmse_6-step': 0.872297070021884, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 264.96937876800075, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:07:54,516,516 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 16:07:54,518,518 multiprocessing INFO Running EQ_5_D sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:07:54,569,569 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:08:08,069,69 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 13.550330067999312, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:08:08,069,69 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 1, 2.0)
MainProcess| 2023-05-14 16:08:08,072,72 multiprocessing INFO Running EQ_5_D crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:08:08,125,125 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:12:56,683,683 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6236476020686679, 'encoder_val_rmse_orig': 0.6134227906152241, 'encoder_test_rmse_all': 0.8393533615064486, 'encoder_test_rmse_orig': 0.6050965798935131, 'encoder_test_rmse_last': 0.7307239426073113, 'decoder_val_rmse_all': 0.39628761695088166, 'decoder_val_rmse_orig': 0.39628761695088227, 'decoder_test_rmse_2-step': 0.9361170912755009, 'decoder_test_rmse_3-step': 1.0126928524141212, 'decoder_test_rmse_4-step': 1.0481366218543609, 'decoder_test_rmse_5-step': 1.0696039152254995, 'decoder_test_rmse_6-step': 1.0670507910826532, 'method': 'crn', 'seed': 1, 'seconds_taken': 288.61110025500057, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:12:56,683,683 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 1, 2.0)
MainProcess| 2023-05-14 16:12:56,686,686 multiprocessing INFO Running EQ_5_D msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:12:56,731,731 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:13:07,595,595 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 1, 'seconds_taken': 10.908903253999597, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:13:07,595,595 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 16:13:07,598,598 multiprocessing INFO Running EQ_5_D gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:13:07,645,645 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:17:33,773,773 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6512993994970668, 'encoder_val_rmse_orig': 0.6407226512340467, 'encoder_test_rmse_all': 0.8278625365429811, 'encoder_test_rmse_orig': 0.6009535046631069, 'encoder_test_rmse_last': 0.790891513810901, 'decoder_val_rmse_all': 0.6512993994970668, 'decoder_val_rmse_orig': 0.6407226512340467, 'decoder_test_rmse_2-step': 1.094425904492884, 'decoder_test_rmse_3-step': 1.292382118218973, 'decoder_test_rmse_4-step': 1.3710466782380375, 'decoder_test_rmse_5-step': 1.455348832035921, 'decoder_test_rmse_6-step': 1.5172284784394643, 'method': 'gnet', 'seed': 1, 'seconds_taken': 266.1752020900003, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:17:33,774,774 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 1, 2.0)
MainProcess| 2023-05-14 16:17:33,776,776 multiprocessing INFO Running EQ_5_D ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:17:33,827,827 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:18:21,713,713 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8010582061910106, 'encoder_val_rmse_orig': 0.7877681141121754, 'encoder_test_rmse_all': 1.1231130288208504, 'encoder_test_rmse_orig': 0.8131277117604868, 'encoder_test_rmse_last': 0.9970914040557518, 'decoder_val_rmse_all': 0.8010582061910106, 'decoder_val_rmse_orig': 0.7877681141121754, 'decoder_test_rmse_2-step': 1.096819775581536, 'decoder_test_rmse_3-step': 1.210110156602792, 'decoder_test_rmse_4-step': 1.2016222728066774, 'decoder_test_rmse_5-step': 1.2053183890815726, 'decoder_test_rmse_6-step': 1.1807598096298686, 'method': 'ct', 'seed': 1, 'seconds_taken': 47.93631300599918, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:18:21,713,713 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 16:18:21,716,716 multiprocessing INFO Running EQ_5_D rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:18:21,770,770 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:22:46,572,572 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7693034607443945, 'propensity_treatment_val_bce_orig': 0.7692869113371539, 'propensity_treatment_test_bce_all': 0.7568818100849278, 'propensity_treatment_test_bce_orig': 0.7608506699817085, 'propensity_history_val_bce_all': 0.7623944972389618, 'propensity_history_val_bce_orig': 0.7624313444795519, 'propensity_history_test_bce_all': 0.7543805366479265, 'propensity_history_test_bce_orig': 0.7574880686351395, 'encoder_val_rmse_all': 1.1501567797768457, 'encoder_val_rmse_orig': 1.1291010166142263, 'encoder_test_rmse_all': 1.223921917653974, 'encoder_test_rmse_orig': 0.8814471414810346, 'encoder_test_rmse_last': 1.1026272675816253, 'decoder_val_rmse_all': 0.34775219262481116, 'decoder_val_rmse_orig': 0.3477521926248112, 'decoder_test_rmse_2-step': 1.172672534981754, 'decoder_test_rmse_3-step': 1.1508311821489612, 'decoder_test_rmse_4-step': 1.1381069101788461, 'decoder_test_rmse_5-step': 1.1718278542354454, 'decoder_test_rmse_6-step': 1.2056975251873643, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 264.8559223600005, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:24:29,672,672 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 16:24:29,675,675 multiprocessing INFO Running EQ_4_A sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:24:29,726,726 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:24:33,462,462 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 3.786441289001232, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:24:33,462,462 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 1, 2.0)
MainProcess| 2023-05-14 16:24:33,464,464 multiprocessing INFO Running EQ_4_A wsindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:24:33,515,515 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:24:38,929,929 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1319026909327777, 'encoder_test_rmse_orig': 0.11156475629642547, 'encoder_test_rmse_last': 0.11156735695622598, 'decoder_test_rmse_2-step': 0.11148150268041596, 'decoder_test_rmse_3-step': 0.11112356610939116, 'decoder_test_rmse_4-step': 0.11041446272217156, 'decoder_test_rmse_5-step': 0.10932779101219559, 'decoder_test_rmse_6-step': 0.1078691737938045, 'global_equation_string': 'Treatment 0: x_dot = +-1.008414269814878*x0*u0 | Treatment 1: x_dot = +-1.0084185497354392*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 1, 'seconds_taken': 5.464394476999587, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:24:38,929,929 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 1, 2.0)
MainProcess| 2023-05-14 16:24:38,932,932 multiprocessing INFO Running EQ_4_A crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:24:38,983,983 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:29:48,301,301 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7689498185206156, 'encoder_val_rmse_orig': 0.7689498185206156, 'encoder_test_rmse_all': 0.5951293691102463, 'encoder_test_rmse_orig': 0.7694965334150609, 'encoder_test_rmse_last': 0.7984281443799722, 'decoder_val_rmse_all': 0.351468035266984, 'decoder_val_rmse_orig': 0.35146803526698384, 'decoder_test_rmse_2-step': 0.8722590919130844, 'decoder_test_rmse_3-step': 0.8742829231429265, 'decoder_test_rmse_4-step': 0.9106264420337292, 'decoder_test_rmse_5-step': 0.9813556344855124, 'decoder_test_rmse_6-step': 1.0636400961167574, 'method': 'crn', 'seed': 1, 'seconds_taken': 309.3688636199986, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:29:48,301,301 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 1, 2.0)
MainProcess| 2023-05-14 16:29:48,304,304 multiprocessing INFO Running EQ_4_A msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:29:48,350,350 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:29:54,210,210 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 1, 'seconds_taken': 5.90585147299862, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:29:54,210,210 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 16:29:54,213,213 multiprocessing INFO Running EQ_4_A gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:29:54,261,261 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:34:24,375,375 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8722444611191278, 'encoder_val_rmse_orig': 0.8722444611191278, 'encoder_test_rmse_all': 0.9192621574231343, 'encoder_test_rmse_orig': 0.8721004044266303, 'encoder_test_rmse_last': 0.8777692659617387, 'decoder_val_rmse_all': 0.8722444611191278, 'decoder_val_rmse_orig': 0.8722444611191278, 'decoder_test_rmse_2-step': 1.0866492270950046, 'decoder_test_rmse_3-step': 1.2392126378295079, 'decoder_test_rmse_4-step': 1.3619739781029325, 'decoder_test_rmse_5-step': 1.4598014911237711, 'decoder_test_rmse_6-step': 1.5383094116055704, 'method': 'gnet', 'seed': 1, 'seconds_taken': 270.16198256200005, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:34:24,375,375 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 1, 2.0)
MainProcess| 2023-05-14 16:34:24,378,378 multiprocessing INFO Running EQ_4_A ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:34:24,431,431 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:35:11,907,907 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.29892381207874574, 'encoder_val_rmse_orig': 0.29892381207874574, 'encoder_test_rmse_all': 0.39352888880077386, 'encoder_test_rmse_orig': 0.30383138698015005, 'encoder_test_rmse_last': 0.38621579008410784, 'decoder_val_rmse_all': 0.29892381207874574, 'decoder_val_rmse_orig': 0.29892381207874574, 'decoder_test_rmse_2-step': 0.45701725851286834, 'decoder_test_rmse_3-step': 0.6511039140022172, 'decoder_test_rmse_4-step': 0.7184722279118352, 'decoder_test_rmse_5-step': 0.7669199624199854, 'decoder_test_rmse_6-step': 0.8146773822460242, 'method': 'ct', 'seed': 1, 'seconds_taken': 47.52862145200197, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:35:11,907,907 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 16:35:11,910,910 multiprocessing INFO Running EQ_4_A rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:35:11,969,969 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:39:42,752,752 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4946240898613202, 'propensity_treatment_val_bce_orig': 0.49462408986132034, 'propensity_treatment_test_bce_all': 0.5084553883511804, 'propensity_treatment_test_bce_orig': 0.5157207827756527, 'propensity_history_val_bce_all': 0.49211512981329936, 'propensity_history_val_bce_orig': 0.49211512981329936, 'propensity_history_test_bce_all': 0.5048731067221885, 'propensity_history_test_bce_orig': 0.5133705973554704, 'encoder_val_rmse_all': 2.4441156854305675, 'encoder_val_rmse_orig': 2.4441156854305675, 'encoder_test_rmse_all': 3.3987178115029835, 'encoder_test_rmse_orig': 2.4497800941633026, 'encoder_test_rmse_last': 2.6509881692433503, 'decoder_val_rmse_all': 0.22037729760476218, 'decoder_val_rmse_orig': 0.22037729760476218, 'decoder_test_rmse_2-step': 2.21073956751211, 'decoder_test_rmse_3-step': 2.059308811345128, 'decoder_test_rmse_4-step': 1.922207636647083, 'decoder_test_rmse_5-step': 1.7852674739935417, 'decoder_test_rmse_6-step': 1.6559983476879032, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 270.8419945079986, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:41:25,510,510 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 16:41:25,513,513 multiprocessing INFO Running EQ_4_B sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:41:25,563,563 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:41:29,191,191 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 3.6786403990008694, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:41:29,192,192 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 1, 2.0)
MainProcess| 2023-05-14 16:41:29,195,195 multiprocessing INFO Running EQ_4_B wsindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:41:29,246,246 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:41:34,695,695 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13327384057986338, 'encoder_test_rmse_orig': 0.11317255521988384, 'encoder_test_rmse_last': 0.11325975358416794, 'decoder_test_rmse_2-step': 0.1130891984821712, 'decoder_test_rmse_3-step': 0.11280586282885251, 'decoder_test_rmse_4-step': 0.11216000549669083, 'decoder_test_rmse_5-step': 0.11090203277311164, 'decoder_test_rmse_6-step': 0.10947634951906939, 'global_equation_string': 'Treatment 0: x_dot = +-1.0083587063308534*x0*u0 | Treatment 1: x_dot = +-1.0084167149594725*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 1, 'seconds_taken': 5.4998651440000685, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:41:34,695,695 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 1, 2.0)
MainProcess| 2023-05-14 16:41:34,698,698 multiprocessing INFO Running EQ_4_B crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:41:34,745,745 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:46:45,975,975 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7732904728193558, 'encoder_val_rmse_orig': 0.7732904728193559, 'encoder_test_rmse_all': 0.5980720546896928, 'encoder_test_rmse_orig': 0.7740139729210628, 'encoder_test_rmse_last': 0.8026898957520947, 'decoder_val_rmse_all': 0.3522847267047547, 'decoder_val_rmse_orig': 0.3522847267047548, 'decoder_test_rmse_2-step': 0.8729665061137284, 'decoder_test_rmse_3-step': 0.874979504223542, 'decoder_test_rmse_4-step': 0.9112704135249384, 'decoder_test_rmse_5-step': 0.9817207677214798, 'decoder_test_rmse_6-step': 1.0639590271096253, 'method': 'crn', 'seed': 1, 'seconds_taken': 311.27647985399744, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:46:45,975,975 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 1, 2.0)
MainProcess| 2023-05-14 16:46:45,978,978 multiprocessing INFO Running EQ_4_B msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:46:46,026,26 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:46:51,545,545 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 1, 'seconds_taken': 5.566903012000694, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:46:51,546,546 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 16:46:51,548,548 multiprocessing INFO Running EQ_4_B gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:46:51,597,597 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:51:24,695,695 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8732131402894102, 'encoder_val_rmse_orig': 0.8732131402894101, 'encoder_test_rmse_all': 0.9198968092269975, 'encoder_test_rmse_orig': 0.8730607689037798, 'encoder_test_rmse_last': 0.8784720359332268, 'decoder_val_rmse_all': 0.8732131402894102, 'decoder_val_rmse_orig': 0.8732131402894101, 'decoder_test_rmse_2-step': 1.0874938291095526, 'decoder_test_rmse_3-step': 1.2401853667302711, 'decoder_test_rmse_4-step': 1.3628748022277632, 'decoder_test_rmse_5-step': 1.4604874864216422, 'decoder_test_rmse_6-step': 1.5390838747997206, 'method': 'gnet', 'seed': 1, 'seconds_taken': 273.1467157859988, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:51:24,695,695 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 1, 2.0)
MainProcess| 2023-05-14 16:51:24,698,698 multiprocessing INFO Running EQ_4_B ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:51:24,749,749 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:52:12,256,256 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.296399488734329, 'encoder_val_rmse_orig': 0.29639948873432903, 'encoder_test_rmse_all': 0.3885404501324662, 'encoder_test_rmse_orig': 0.3012360237423928, 'encoder_test_rmse_last': 0.38238100864711644, 'decoder_val_rmse_all': 0.296399488734329, 'decoder_val_rmse_orig': 0.29639948873432903, 'decoder_test_rmse_2-step': 0.4521019661724494, 'decoder_test_rmse_3-step': 0.6458091690780637, 'decoder_test_rmse_4-step': 0.7124664404759345, 'decoder_test_rmse_5-step': 0.7604193217603223, 'decoder_test_rmse_6-step': 0.8084611336361448, 'method': 'ct', 'seed': 1, 'seconds_taken': 47.55796677499893, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:52:12,256,256 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 16:52:12,259,259 multiprocessing INFO Running EQ_4_B rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:52:12,314,314 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:56:44,711,711 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4946240898613202, 'propensity_treatment_val_bce_orig': 0.49462408986132034, 'propensity_treatment_test_bce_all': 0.5084553883511804, 'propensity_treatment_test_bce_orig': 0.5157207827756527, 'propensity_history_val_bce_all': 0.49206275031223135, 'propensity_history_val_bce_orig': 0.49206275031223135, 'propensity_history_test_bce_all': 0.504775126162306, 'propensity_history_test_bce_orig': 0.5133194616603394, 'encoder_val_rmse_all': 2.4800156481227056, 'encoder_val_rmse_orig': 2.4800156481227056, 'encoder_test_rmse_all': 3.445046689553909, 'encoder_test_rmse_orig': 2.485536049740372, 'encoder_test_rmse_last': 2.6704292106694227, 'decoder_val_rmse_all': 0.22238284927867916, 'decoder_val_rmse_orig': 0.2223828492786792, 'decoder_test_rmse_2-step': 2.213684330501035, 'decoder_test_rmse_3-step': 2.0553264472668613, 'decoder_test_rmse_4-step': 1.9129421798969144, 'decoder_test_rmse_5-step': 1.773203008602769, 'decoder_test_rmse_6-step': 1.6412381517584105, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 272.45152916699953, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:58:28,737,737 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 16:58:28,740,740 multiprocessing INFO Running EQ_4_C sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:58:28,789,789 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:58:32,334,334 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 3.5938569870013453, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:58:32,334,334 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 1, 2.0)
MainProcess| 2023-05-14 16:58:32,337,337 multiprocessing INFO Running EQ_4_C wsindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:58:32,769,769 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 16:58:38,361,361 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.14960526855499903, 'encoder_test_rmse_orig': 0.12191156686588962, 'encoder_test_rmse_last': 0.12184865841697548, 'decoder_test_rmse_2-step': 0.1215675256558032, 'decoder_test_rmse_3-step': 0.12085441955148278, 'decoder_test_rmse_4-step': 0.11958232538492324, 'decoder_test_rmse_5-step': 0.11747055242653988, 'decoder_test_rmse_6-step': 0.11505876030366377, 'global_equation_string': 'Treatment 0: x_dot = +-0.04517751848621408*x0+-1.019334322800825*x0*u0 | Treatment 1: x_dot = +-0.14647857674417597*x0+-1.0214097933150041*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 1, 'seconds_taken': 6.0245340520014, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 16:58:38,362,362 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 1, 2.0)
MainProcess| 2023-05-14 16:58:38,364,364 multiprocessing INFO Running EQ_4_C crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 16:58:38,414,414 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:03:48,847,847 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5046060784577987, 'encoder_val_rmse_orig': 0.5046060784577987, 'encoder_test_rmse_all': 0.43582297402222825, 'encoder_test_rmse_orig': 0.5071089537798473, 'encoder_test_rmse_last': 0.5494962773231197, 'decoder_val_rmse_all': 0.30733920980023416, 'decoder_val_rmse_orig': 0.30733920980023427, 'decoder_test_rmse_2-step': 0.4736157011647382, 'decoder_test_rmse_3-step': 0.500327829503433, 'decoder_test_rmse_4-step': 0.5910150716936822, 'decoder_test_rmse_5-step': 0.6982845739540926, 'decoder_test_rmse_6-step': 0.7944202220924182, 'method': 'crn', 'seed': 1, 'seconds_taken': 310.48252651200164, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:03:48,847,847 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 1, 2.0)
MainProcess| 2023-05-14 17:03:48,850,850 multiprocessing INFO Running EQ_4_C msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:03:48,899,899 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:03:54,402,402 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 1, 'seconds_taken': 5.551836630002072, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:03:54,402,402 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 17:03:54,405,405 multiprocessing INFO Running EQ_4_C gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:03:54,451,451 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:08:28,228,228 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6627264196577806, 'encoder_val_rmse_orig': 0.6627264196577806, 'encoder_test_rmse_all': 0.7550353398039055, 'encoder_test_rmse_orig': 0.6625810826880139, 'encoder_test_rmse_last': 0.6637376790097351, 'decoder_val_rmse_all': 0.6627264196577806, 'decoder_val_rmse_orig': 0.6627264196577806, 'decoder_test_rmse_2-step': 0.8205846061770663, 'decoder_test_rmse_3-step': 0.9211052112537399, 'decoder_test_rmse_4-step': 0.9979883949311609, 'decoder_test_rmse_5-step': 1.0555312995004424, 'decoder_test_rmse_6-step': 1.0978340441659564, 'method': 'gnet', 'seed': 1, 'seconds_taken': 273.82251741599976, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:08:28,228,228 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 1, 2.0)
MainProcess| 2023-05-14 17:08:28,230,230 multiprocessing INFO Running EQ_4_C ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:08:28,280,280 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:09:16,097,97 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.27712953086111025, 'encoder_val_rmse_orig': 0.27712953086111025, 'encoder_test_rmse_all': 0.3619058874626809, 'encoder_test_rmse_orig': 0.27778777699438706, 'encoder_test_rmse_last': 0.3047763725345241, 'decoder_val_rmse_all': 0.27712953086111025, 'decoder_val_rmse_orig': 0.27712953086111025, 'decoder_test_rmse_2-step': 0.35136502902121075, 'decoder_test_rmse_3-step': 0.5032283154820579, 'decoder_test_rmse_4-step': 0.5763807408923385, 'decoder_test_rmse_5-step': 0.616636065399041, 'decoder_test_rmse_6-step': 0.6574960957617451, 'method': 'ct', 'seed': 1, 'seconds_taken': 47.86647312399873, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:09:16,097,97 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 17:09:16,100,100 multiprocessing INFO Running EQ_4_C rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:09:16,156,156 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:13:47,373,373 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4946240898613202, 'propensity_treatment_val_bce_orig': 0.49462408986132034, 'propensity_treatment_test_bce_all': 0.5084553883511804, 'propensity_treatment_test_bce_orig': 0.5157207827756527, 'propensity_history_val_bce_all': 0.4920833802576792, 'propensity_history_val_bce_orig': 0.49208338025767917, 'propensity_history_test_bce_all': 0.5048133403860916, 'propensity_history_test_bce_orig': 0.5133391346868298, 'encoder_val_rmse_all': 2.5899535706239067, 'encoder_val_rmse_orig': 2.589953570623907, 'encoder_test_rmse_all': 3.6072523569252493, 'encoder_test_rmse_orig': 2.5960217159172156, 'encoder_test_rmse_last': 2.776676671213606, 'decoder_val_rmse_all': 0.21319599516741583, 'decoder_val_rmse_orig': 0.21319599516741594, 'decoder_test_rmse_2-step': 2.2904729159459856, 'decoder_test_rmse_3-step': 2.073573790458011, 'decoder_test_rmse_4-step': 1.8857687927491669, 'decoder_test_rmse_5-step': 1.7118953806994537, 'decoder_test_rmse_6-step': 1.555244540793018, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 271.2728158479986, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:15:34,608,608 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 1, 2.0)
MainProcess| 2023-05-14 17:15:34,611,611 multiprocessing INFO Running EQ_4_D sindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:15:34,661,661 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:15:38,126,126 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 3.515600261001964, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:15:38,127,127 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 1, 2.0)
MainProcess| 2023-05-14 17:15:38,129,129 multiprocessing INFO Running EQ_4_D wsindy 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:15:38,179,179 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:15:43,685,685 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.11960401473862156, 'encoder_test_rmse_orig': 0.10155173925062833, 'encoder_test_rmse_last': 0.1020044216864682, 'decoder_test_rmse_2-step': 0.10209051315216525, 'decoder_test_rmse_3-step': 0.1024175327429632, 'decoder_test_rmse_4-step': 0.1024296122412803, 'decoder_test_rmse_5-step': 0.1021392571160109, 'decoder_test_rmse_6-step': 0.10131029464749104, 'global_equation_string': 'Treatment 0: x_dot = +0.19785341080595292*x0+-1.0097649326211493*x0*u0 | Treatment 1: x_dot = +-0.0904463168633012*x0+-1.0211104571446916*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 1, 'seconds_taken': 5.5557961109989265, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:15:43,685,685 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 1, 2.0)
MainProcess| 2023-05-14 17:15:43,688,688 multiprocessing INFO Running EQ_4_D crn 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:15:43,733,733 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:20:55,177,177 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.829358494676704, 'encoder_val_rmse_orig': 0.829358494676704, 'encoder_test_rmse_all': 0.7232957344853277, 'encoder_test_rmse_orig': 0.8594176736596302, 'encoder_test_rmse_last': 1.1369880092476137, 'decoder_val_rmse_all': 0.43861931725355763, 'decoder_val_rmse_orig': 0.43861931725355763, 'decoder_test_rmse_2-step': 2.0930628077804125, 'decoder_test_rmse_3-step': 2.013163189617115, 'decoder_test_rmse_4-step': 2.014751008597286, 'decoder_test_rmse_5-step': 2.050228413137972, 'decoder_test_rmse_6-step': 2.1009119483623775, 'method': 'crn', 'seed': 1, 'seconds_taken': 311.4889930829995, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:20:55,177,177 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 1, 2.0)
MainProcess| 2023-05-14 17:20:55,180,180 multiprocessing INFO Running EQ_4_D msm 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:20:55,229,229 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:21:00,724,724 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 1, 'seconds_taken': 5.543770401000074, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:21:00,724,724 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 1, 2.0)
MainProcess| 2023-05-14 17:21:00,727,727 multiprocessing INFO Running EQ_4_D gnet 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:21:00,776,776 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:25:34,430,430 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7666919352240432, 'encoder_val_rmse_orig': 0.7666919352240431, 'encoder_test_rmse_all': 0.7810973929835912, 'encoder_test_rmse_orig': 0.7670057256188028, 'encoder_test_rmse_last': 0.771189812539035, 'decoder_val_rmse_all': 0.7666919352240432, 'decoder_val_rmse_orig': 0.7666919352240431, 'decoder_test_rmse_2-step': 0.9101903005691924, 'decoder_test_rmse_3-step': 1.0377324254623246, 'decoder_test_rmse_4-step': 1.1459686807287106, 'decoder_test_rmse_5-step': 1.2409034422899587, 'decoder_test_rmse_6-step': 1.323173178742601, 'method': 'gnet', 'seed': 1, 'seconds_taken': 273.70267579999927, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:25:34,430,430 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 1, 2.0)
MainProcess| 2023-05-14 17:25:34,433,433 multiprocessing INFO Running EQ_4_D ct 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:25:34,485,485 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:26:22,138,138 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3236173662582482, 'encoder_val_rmse_orig': 0.32361736625824816, 'encoder_test_rmse_all': 0.4267774115461617, 'encoder_test_rmse_orig': 0.3568282642203633, 'encoder_test_rmse_last': 0.6313058859163548, 'decoder_val_rmse_all': 0.3236173662582482, 'decoder_val_rmse_orig': 0.32361736625824816, 'decoder_test_rmse_2-step': 0.6728128897710445, 'decoder_test_rmse_3-step': 0.736113727318921, 'decoder_test_rmse_4-step': 0.830908261229246, 'decoder_test_rmse_5-step': 0.9203042893363975, 'decoder_test_rmse_6-step': 0.9823188222628452, 'method': 'ct', 'seed': 1, 'seconds_taken': 47.704976969998825, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:26:22,138,138 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 1, 2.0)
MainProcess| 2023-05-14 17:26:22,141,141 multiprocessing INFO Running EQ_4_D rmsn 1 | domain_conf=2.0
MainProcess| 2023-05-14 17:26:22,195,195 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:30:56,511,511 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5021398862943811, 'propensity_treatment_val_bce_orig': 0.502139886294381, 'propensity_treatment_test_bce_all': 0.5155667422137692, 'propensity_treatment_test_bce_orig': 0.5224502352476013, 'propensity_history_val_bce_all': 0.49976921519990697, 'propensity_history_val_bce_orig': 0.49976921519990686, 'propensity_history_test_bce_all': 0.5122495978998263, 'propensity_history_test_bce_orig': 0.5202327629151859, 'encoder_val_rmse_all': 2.646038659884096, 'encoder_val_rmse_orig': 2.6460386598840953, 'encoder_test_rmse_all': 3.6535904022837564, 'encoder_test_rmse_orig': 2.6564123424674797, 'encoder_test_rmse_last': 2.8205272377187938, 'decoder_val_rmse_all': 0.2944063216002188, 'decoder_val_rmse_orig': 0.29440632160021846, 'decoder_test_rmse_2-step': 2.4056468659482446, 'decoder_test_rmse_3-step': 2.2680158596594984, 'decoder_test_rmse_4-step': 2.171462711997721, 'decoder_test_rmse_5-step': 2.0917614599458094, 'decoder_test_rmse_6-step': 2.0288723810701343, 'method': 'rmsn', 'seed': 1, 'seconds_taken': 274.3698315030015, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:32:20,139,139 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 17:32:20,142,142 multiprocessing INFO Running cancer_sim sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:32:20,186,186 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:32:33,439,439 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 13.296474888000375, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:32:33,439,439 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 2, 2.0)
MainProcess| 2023-05-14 17:32:33,443,443 multiprocessing INFO Running cancer_sim crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:32:33,493,493 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:37:23,047,47 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.095539149593397, 'encoder_val_rmse_orig': 1.0496928255451425, 'encoder_test_rmse_all': 0.7638464915095334, 'encoder_test_rmse_orig': 0.5747489584941415, 'encoder_test_rmse_last': 0.7192005870163879, 'decoder_val_rmse_all': 0.3323524356906971, 'decoder_val_rmse_orig': 0.33235243569069695, 'decoder_test_rmse_2-step': 0.7070073214077692, 'decoder_test_rmse_3-step': 0.780943294527372, 'decoder_test_rmse_4-step': 0.8577432406298238, 'decoder_test_rmse_5-step': 0.9222583208664685, 'decoder_test_rmse_6-step': 0.9746764018748324, 'method': 'crn', 'seed': 2, 'seconds_taken': 289.60453698100173, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:37:23,047,47 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 2, 2.0)
MainProcess| 2023-05-14 17:37:23,050,50 multiprocessing INFO Running cancer_sim msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:37:23,099,99 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:37:34,669,669 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 2, 'seconds_taken': 11.618856213000981, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:37:34,669,669 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 17:37:34,672,672 multiprocessing INFO Running cancer_sim gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:37:34,719,719 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:42:02,748,748 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.146773820193619, 'encoder_val_rmse_orig': 1.0983079397993356, 'encoder_test_rmse_all': 0.7197691149803657, 'encoder_test_rmse_orig': 0.5435870367367664, 'encoder_test_rmse_last': 0.6793549471940411, 'decoder_val_rmse_all': 1.146773820193619, 'decoder_val_rmse_orig': 1.0983079397993356, 'decoder_test_rmse_2-step': 0.791588255606801, 'decoder_test_rmse_3-step': 0.9459301603933157, 'decoder_test_rmse_4-step': 0.9902905608581595, 'decoder_test_rmse_5-step': 1.0228526990594944, 'decoder_test_rmse_6-step': 1.0324504638248548, 'method': 'gnet', 'seed': 2, 'seconds_taken': 268.07558571700065, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:42:02,748,748 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 2, 2.0)
MainProcess| 2023-05-14 17:42:02,751,751 multiprocessing INFO Running cancer_sim ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:42:02,802,802 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:42:52,681,681 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9946181368255859, 'encoder_val_rmse_orig': 0.9539891823380032, 'encoder_test_rmse_all': 0.8117458807339032, 'encoder_test_rmse_orig': 0.6091322791115779, 'encoder_test_rmse_last': 0.7351870429955143, 'decoder_val_rmse_all': 0.9946181368255859, 'decoder_val_rmse_orig': 0.9539891823380032, 'decoder_test_rmse_2-step': 0.7906662289449468, 'decoder_test_rmse_3-step': 0.8735087991635058, 'decoder_test_rmse_4-step': 0.9704401400399671, 'decoder_test_rmse_5-step': 1.0370228547314473, 'decoder_test_rmse_6-step': 1.08070930675087, 'method': 'ct', 'seed': 2, 'seconds_taken': 49.93015887900037, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:42:52,681,681 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 17:42:52,685,685 multiprocessing INFO Running cancer_sim rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:42:52,734,734 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:47:18,782,782 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7666903221211832, 'propensity_treatment_val_bce_orig': 0.7665389915994175, 'propensity_treatment_test_bce_all': 0.7602824229971161, 'propensity_treatment_test_bce_orig': 0.7610373882265213, 'propensity_history_val_bce_all': 0.7609834636728786, 'propensity_history_val_bce_orig': 0.7610845787672373, 'propensity_history_test_bce_all': 0.756248174859985, 'propensity_history_test_bce_orig': 0.7581893939307219, 'encoder_val_rmse_all': 1.2670745603112321, 'encoder_val_rmse_orig': 1.215029900106304, 'encoder_test_rmse_all': 0.9672877314032857, 'encoder_test_rmse_orig': 0.7300898644682556, 'encoder_test_rmse_last': 0.8586862841013624, 'decoder_val_rmse_all': 0.3431945627307694, 'decoder_val_rmse_orig': 0.34319456273076976, 'decoder_test_rmse_2-step': 0.7821857851295562, 'decoder_test_rmse_3-step': 0.8241730093172275, 'decoder_test_rmse_4-step': 0.8681673321218277, 'decoder_test_rmse_5-step': 0.9200858201441249, 'decoder_test_rmse_6-step': 0.9777875013699228, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 266.09681645899764, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:49:34,053,53 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 17:49:34,056,56 multiprocessing INFO Running EQ_5_A sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:49:34,104,104 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:49:47,313,313 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 13.257293938000657, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:49:47,313,313 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 2, 2.0)
MainProcess| 2023-05-14 17:49:47,316,316 multiprocessing INFO Running EQ_5_A crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:49:47,366,366 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:54:39,701,701 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8582570204702525, 'encoder_val_rmse_orig': 0.8302013965934751, 'encoder_test_rmse_all': 0.9342660424993423, 'encoder_test_rmse_orig': 0.678094155332682, 'encoder_test_rmse_last': 0.7947262905857782, 'decoder_val_rmse_all': 0.3346325159986977, 'decoder_val_rmse_orig': 0.33463251599869753, 'decoder_test_rmse_2-step': 0.8311465011549491, 'decoder_test_rmse_3-step': 0.9275615634340474, 'decoder_test_rmse_4-step': 1.0011660845404728, 'decoder_test_rmse_5-step': 1.0445360435716957, 'decoder_test_rmse_6-step': 1.0361126277209634, 'method': 'crn', 'seed': 2, 'seconds_taken': 292.38448289900043, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:54:39,701,701 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 2, 2.0)
MainProcess| 2023-05-14 17:54:39,704,704 multiprocessing INFO Running EQ_5_A msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:54:39,749,749 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:54:50,215,215 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 2, 'seconds_taken': 10.510746972999186, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:54:50,215,215 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 17:54:50,218,218 multiprocessing INFO Running EQ_5_A gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:54:50,265,265 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 17:59:34,802,802 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8338833137159857, 'encoder_val_rmse_orig': 0.8064959778593724, 'encoder_test_rmse_all': 0.8519136278019516, 'encoder_test_rmse_orig': 0.6162749988295743, 'encoder_test_rmse_last': 0.7560706080370798, 'decoder_val_rmse_all': 0.8338833137159857, 'decoder_val_rmse_orig': 0.8064959778593724, 'decoder_test_rmse_2-step': 0.752823204126675, 'decoder_test_rmse_3-step': 0.8245954387189441, 'decoder_test_rmse_4-step': 0.8865585277888461, 'decoder_test_rmse_5-step': 0.9262759084582038, 'decoder_test_rmse_6-step': 0.9644219456151046, 'method': 'gnet', 'seed': 2, 'seconds_taken': 284.5844272800023, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 17:59:34,802,802 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 2, 2.0)
MainProcess| 2023-05-14 17:59:34,805,805 multiprocessing INFO Running EQ_5_A ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 17:59:34,854,854 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:00:23,705,705 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9840342076733467, 'encoder_val_rmse_orig': 0.9519500540155571, 'encoder_test_rmse_all': 1.152966424650655, 'encoder_test_rmse_orig': 0.8453013147340399, 'encoder_test_rmse_last': 1.1284390381248823, 'decoder_val_rmse_all': 0.9840342076733467, 'decoder_val_rmse_orig': 0.9519500540155571, 'decoder_test_rmse_2-step': 1.0428333613770138, 'decoder_test_rmse_3-step': 1.1784154699994398, 'decoder_test_rmse_4-step': 1.2907239583079135, 'decoder_test_rmse_5-step': 1.3299887304534928, 'decoder_test_rmse_6-step': 1.319078590728788, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.899120813999616, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:00:23,705,705 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 18:00:23,707,707 multiprocessing INFO Running EQ_5_A rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:00:23,761,761 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:04:52,123,123 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.766309426874817, 'propensity_treatment_val_bce_orig': 0.7662142966753606, 'propensity_treatment_test_bce_all': 0.7618137278700019, 'propensity_treatment_test_bce_orig': 0.7605340733301842, 'propensity_history_val_bce_all': 0.7605931275873721, 'propensity_history_val_bce_orig': 0.7607106880076019, 'propensity_history_test_bce_all': 0.7585256014544268, 'propensity_history_test_bce_orig': 0.758522065120052, 'encoder_val_rmse_all': 1.2862042281854036, 'encoder_val_rmse_orig': 1.2433432704825886, 'encoder_test_rmse_all': 1.289595544335028, 'encoder_test_rmse_orig': 0.9355639018678995, 'encoder_test_rmse_last': 1.1582311670663756, 'decoder_val_rmse_all': 0.28373551699463984, 'decoder_val_rmse_orig': 0.28373551699463984, 'decoder_test_rmse_2-step': 1.0841494865199577, 'decoder_test_rmse_3-step': 1.1187176219292072, 'decoder_test_rmse_4-step': 1.1828206951109814, 'decoder_test_rmse_5-step': 1.2410505854945844, 'decoder_test_rmse_6-step': 1.2733627714941855, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 268.41494527599934, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:06:26,982,982 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 18:06:26,984,984 multiprocessing INFO Running EQ_5_B sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:06:27,030,30 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:06:40,821,821 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 13.836065556999529, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:06:40,821,821 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 2, 2.0)
MainProcess| 2023-05-14 18:06:40,824,824 multiprocessing INFO Running EQ_5_B crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:06:40,872,872 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:11:31,516,516 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8582285986751483, 'encoder_val_rmse_orig': 0.8301740521131622, 'encoder_test_rmse_all': 0.9342665928307746, 'encoder_test_rmse_orig': 0.6780950724290022, 'encoder_test_rmse_last': 0.7947357360505943, 'decoder_val_rmse_all': 0.3346268619004487, 'decoder_val_rmse_orig': 0.33462686190044877, 'decoder_test_rmse_2-step': 0.831142145196203, 'decoder_test_rmse_3-step': 0.927553955765645, 'decoder_test_rmse_4-step': 1.0011537134446553, 'decoder_test_rmse_5-step': 1.0445208665556327, 'decoder_test_rmse_6-step': 1.0360983212222707, 'method': 'crn', 'seed': 2, 'seconds_taken': 290.6920560610015, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:11:31,516,516 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 2, 2.0)
MainProcess| 2023-05-14 18:11:31,519,519 multiprocessing INFO Running EQ_5_B msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:11:31,566,566 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:11:42,745,745 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 2, 'seconds_taken': 11.226020386999153, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:11:42,745,745 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 18:11:42,748,748 multiprocessing INFO Running EQ_5_B gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:11:42,796,796 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:16:23,103,103 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8338562582929924, 'encoder_val_rmse_orig': 0.8064699883208929, 'encoder_test_rmse_all': 0.8519205965054911, 'encoder_test_rmse_orig': 0.6162809675911485, 'encoder_test_rmse_last': 0.7560852559897466, 'decoder_val_rmse_all': 0.8338562582929924, 'decoder_val_rmse_orig': 0.8064699883208929, 'decoder_test_rmse_2-step': 0.7528296890600519, 'decoder_test_rmse_3-step': 0.8246202251831508, 'decoder_test_rmse_4-step': 0.8865741087673275, 'decoder_test_rmse_5-step': 0.9262917807154923, 'decoder_test_rmse_6-step': 0.9644398134831662, 'method': 'gnet', 'seed': 2, 'seconds_taken': 280.3551988229992, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:16:23,103,103 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 2, 2.0)
MainProcess| 2023-05-14 18:16:23,106,106 multiprocessing INFO Running EQ_5_B ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:16:23,157,157 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:17:12,007,7 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9833900755077184, 'encoder_val_rmse_orig': 0.9512483891501764, 'encoder_test_rmse_all': 1.1543631770612655, 'encoder_test_rmse_orig': 0.8451841195721429, 'encoder_test_rmse_last': 1.1277900150510427, 'decoder_val_rmse_all': 0.9833900755077184, 'decoder_val_rmse_orig': 0.9512483891501764, 'decoder_test_rmse_2-step': 1.0586816093528852, 'decoder_test_rmse_3-step': 1.1973544205686129, 'decoder_test_rmse_4-step': 1.2970754754625249, 'decoder_test_rmse_5-step': 1.3329535490316304, 'decoder_test_rmse_6-step': 1.3140078520402243, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.90078795700174, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:17:12,007,7 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 18:17:12,010,10 multiprocessing INFO Running EQ_5_B rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:17:12,062,62 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:21:41,418,418 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.766309426874817, 'propensity_treatment_val_bce_orig': 0.7662142966753606, 'propensity_treatment_test_bce_all': 0.7618137278700019, 'propensity_treatment_test_bce_orig': 0.7605340733301842, 'propensity_history_val_bce_all': 0.7604438667083103, 'propensity_history_val_bce_orig': 0.7605594108912647, 'propensity_history_test_bce_all': 0.7587597639079363, 'propensity_history_test_bce_orig': 0.7585818025016204, 'encoder_val_rmse_all': 1.2914106215362398, 'encoder_val_rmse_orig': 1.2483659405436165, 'encoder_test_rmse_all': 1.298870366552367, 'encoder_test_rmse_orig': 0.9421524549336008, 'encoder_test_rmse_last': 1.164360032871739, 'decoder_val_rmse_all': 0.2844080089232077, 'decoder_val_rmse_orig': 0.28440800892320756, 'decoder_test_rmse_2-step': 1.0897432305098682, 'decoder_test_rmse_3-step': 1.1298145701667845, 'decoder_test_rmse_4-step': 1.1991388011618773, 'decoder_test_rmse_5-step': 1.260415454714884, 'decoder_test_rmse_6-step': 1.293801380737735, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 269.4076398690013, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:23:17,447,447 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 18:23:17,449,449 multiprocessing INFO Running EQ_5_C sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:23:17,498,498 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:23:31,360,360 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 13.910578536000685, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:23:31,360,360 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 2, 2.0)
MainProcess| 2023-05-14 18:23:31,363,363 multiprocessing INFO Running EQ_5_C crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:23:31,416,416 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:28:24,376,376 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5924915092656486, 'encoder_val_rmse_orig': 0.5766743544308675, 'encoder_test_rmse_all': 0.8421669633911743, 'encoder_test_rmse_orig': 0.6151525173510582, 'encoder_test_rmse_last': 0.8261243016406239, 'decoder_val_rmse_all': 0.3268653696273513, 'decoder_val_rmse_orig': 0.3268653696273513, 'decoder_test_rmse_2-step': 0.7557835704256327, 'decoder_test_rmse_3-step': 0.7651984037061408, 'decoder_test_rmse_4-step': 0.7812625856345241, 'decoder_test_rmse_5-step': 0.7946957692327463, 'decoder_test_rmse_6-step': 0.79470323207998, 'method': 'crn', 'seed': 2, 'seconds_taken': 293.01297621699996, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:28:24,376,376 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 2, 2.0)
MainProcess| 2023-05-14 18:28:24,379,379 multiprocessing INFO Running EQ_5_C msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:28:24,427,427 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:28:34,929,929 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 2, 'seconds_taken': 10.550116898000852, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:28:34,930,930 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 18:28:34,935,935 multiprocessing INFO Running EQ_5_C gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:28:34,984,984 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:33:16,585,585 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5807343713054527, 'encoder_val_rmse_orig': 0.5651575769705326, 'encoder_test_rmse_all': 0.8205103662259403, 'encoder_test_rmse_orig': 0.609334006776569, 'encoder_test_rmse_last': 0.9599548406207069, 'decoder_val_rmse_all': 0.5807343713054527, 'decoder_val_rmse_orig': 0.5651575769705326, 'decoder_test_rmse_2-step': 0.7595793711228143, 'decoder_test_rmse_3-step': 0.8141594274579774, 'decoder_test_rmse_4-step': 0.8344746053334353, 'decoder_test_rmse_5-step': 0.8345375856432974, 'decoder_test_rmse_6-step': 0.8142609543733713, 'method': 'gnet', 'seed': 2, 'seconds_taken': 281.6496847849994, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:33:16,585,585 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 2, 2.0)
MainProcess| 2023-05-14 18:33:16,588,588 multiprocessing INFO Running EQ_5_C ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:33:16,638,638 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:34:05,349,349 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6980531574575956, 'encoder_val_rmse_orig': 0.6796558047319293, 'encoder_test_rmse_all': 1.1907398252207313, 'encoder_test_rmse_orig': 0.8667584832828176, 'encoder_test_rmse_last': 1.050112963478453, 'decoder_val_rmse_all': 0.6980531574575956, 'decoder_val_rmse_orig': 0.6796558047319293, 'decoder_test_rmse_2-step': 1.028094883909093, 'decoder_test_rmse_3-step': 1.0515668636439706, 'decoder_test_rmse_4-step': 1.0416209532949658, 'decoder_test_rmse_5-step': 1.0320069952759752, 'decoder_test_rmse_6-step': 0.9690954416521519, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.760851844999706, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:34:05,349,349 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 18:34:05,352,352 multiprocessing INFO Running EQ_5_C rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:34:05,406,406 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:38:35,108,108 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7669964283356537, 'propensity_treatment_val_bce_orig': 0.7669548732396393, 'propensity_treatment_test_bce_all': 0.755769127237607, 'propensity_treatment_test_bce_orig': 0.758325810558291, 'propensity_history_val_bce_all': 0.7616517450683905, 'propensity_history_val_bce_orig': 0.7617537347569149, 'propensity_history_test_bce_all': 0.7524505486841429, 'propensity_history_test_bce_orig': 0.7555567000577431, 'encoder_val_rmse_all': 1.111210766889851, 'encoder_val_rmse_orig': 1.080972083043621, 'encoder_test_rmse_all': 1.1050580000730374, 'encoder_test_rmse_orig': 0.8114145360552865, 'encoder_test_rmse_last': 1.142483823248678, 'decoder_val_rmse_all': 0.29974786768107886, 'decoder_val_rmse_orig': 0.2997478676810789, 'decoder_test_rmse_2-step': 1.0305150192024868, 'decoder_test_rmse_3-step': 0.9851652365335186, 'decoder_test_rmse_4-step': 0.9147244866760267, 'decoder_test_rmse_5-step': 0.8650790365206135, 'decoder_test_rmse_6-step': 0.8390952738436085, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 269.7562005450018, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:40:10,407,407 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 18:40:10,409,409 multiprocessing INFO Running EQ_5_D sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:40:10,457,457 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:40:23,843,843 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 13.433468076000281, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:40:23,843,843 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 2, 2.0)
MainProcess| 2023-05-14 18:40:23,846,846 multiprocessing INFO Running EQ_5_D crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:40:23,900,900 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:45:16,091,91 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6209352119954421, 'encoder_val_rmse_orig': 0.6107083094644309, 'encoder_test_rmse_all': 0.8032213255211288, 'encoder_test_rmse_orig': 0.5794732091103344, 'encoder_test_rmse_last': 0.7250432623564517, 'decoder_val_rmse_all': 0.41567500078285197, 'decoder_val_rmse_orig': 0.4156750007828524, 'decoder_test_rmse_2-step': 0.8812945176767808, 'decoder_test_rmse_3-step': 0.9901353996837111, 'decoder_test_rmse_4-step': 1.0333774123360775, 'decoder_test_rmse_5-step': 1.0455391604809476, 'decoder_test_rmse_6-step': 1.015182134755189, 'method': 'crn', 'seed': 2, 'seconds_taken': 292.24500903599983, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:45:16,092,92 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 2, 2.0)
MainProcess| 2023-05-14 18:45:16,094,94 multiprocessing INFO Running EQ_5_D msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:45:16,143,143 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:45:26,521,521 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 2, 'seconds_taken': 10.426460135000525, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:45:26,521,521 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 18:45:26,524,524 multiprocessing INFO Running EQ_5_D gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:45:26,569,569 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:50:04,137,137 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6461088497134391, 'encoder_val_rmse_orig': 0.6361213049761636, 'encoder_test_rmse_all': 0.7047310985999145, 'encoder_test_rmse_orig': 0.5094837404766724, 'encoder_test_rmse_last': 0.6837641830338792, 'decoder_val_rmse_all': 0.6461088497134391, 'decoder_val_rmse_orig': 0.6361213049761636, 'decoder_test_rmse_2-step': 0.9349412467293797, 'decoder_test_rmse_3-step': 1.1166672951035919, 'decoder_test_rmse_4-step': 1.1588011903678566, 'decoder_test_rmse_5-step': 1.1803958029205999, 'decoder_test_rmse_6-step': 1.1759020632423245, 'method': 'gnet', 'seed': 2, 'seconds_taken': 277.6125786909979, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:50:04,137,137 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 2, 2.0)
MainProcess| 2023-05-14 18:50:04,140,140 multiprocessing INFO Running EQ_5_D ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:50:04,191,191 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:50:52,802,802 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.83586357173648, 'encoder_val_rmse_orig': 0.8217157681077925, 'encoder_test_rmse_all': 1.1639187932032022, 'encoder_test_rmse_orig': 0.8416102829385655, 'encoder_test_rmse_last': 1.0359299367958303, 'decoder_val_rmse_all': 0.83586357173648, 'decoder_val_rmse_orig': 0.8217157681077925, 'decoder_test_rmse_2-step': 1.1174361096334093, 'decoder_test_rmse_3-step': 1.15993331519888, 'decoder_test_rmse_4-step': 1.2034953596748745, 'decoder_test_rmse_5-step': 1.2262186150060406, 'decoder_test_rmse_6-step': 1.203744948043069, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.6622839820011, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:50:52,802,802 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 18:50:52,805,805 multiprocessing INFO Running EQ_5_D rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:50:52,860,860 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:55:22,602,602 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.767051052308028, 'propensity_treatment_val_bce_orig': 0.7670071319678369, 'propensity_treatment_test_bce_all': 0.7564131897719363, 'propensity_treatment_test_bce_orig': 0.7593243531064514, 'propensity_history_val_bce_all': 0.7605937847121829, 'propensity_history_val_bce_orig': 0.7606634164602286, 'propensity_history_test_bce_all': 0.7534415253558046, 'propensity_history_test_bce_orig': 0.7565895834265236, 'encoder_val_rmse_all': 1.095558951949181, 'encoder_val_rmse_orig': 1.0757735018780779, 'encoder_test_rmse_all': 1.2463596717435774, 'encoder_test_rmse_orig': 0.9000729963265527, 'encoder_test_rmse_last': 1.1177453759231761, 'decoder_val_rmse_all': 0.346790495888628, 'decoder_val_rmse_orig': 0.3467904958886284, 'decoder_test_rmse_2-step': 1.2026096709044571, 'decoder_test_rmse_3-step': 1.2181471330303202, 'decoder_test_rmse_4-step': 1.2005381821593901, 'decoder_test_rmse_5-step': 1.1978679464103101, 'decoder_test_rmse_6-step': 1.198635871775226, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 269.797090150998, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:56:50,173,173 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 18:56:50,176,176 multiprocessing INFO Running EQ_4_A sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:56:50,225,225 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:56:53,644,644 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 3.4675569649989484, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:56:53,644,644 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 2, 2.0)
MainProcess| 2023-05-14 18:56:53,647,647 multiprocessing INFO Running EQ_4_A wsindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:56:53,697,697 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 18:56:59,130,130 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.131678457000829, 'encoder_test_rmse_orig': 0.11137538297923545, 'encoder_test_rmse_last': 0.11137874160653649, 'decoder_test_rmse_2-step': 0.11129302032372576, 'decoder_test_rmse_3-step': 0.11093640301502894, 'decoder_test_rmse_4-step': 0.11022914086472181, 'decoder_test_rmse_5-step': 0.10914487012355942, 'decoder_test_rmse_6-step': 0.10768920391737334, 'global_equation_string': 'Treatment 0: x_dot = +-1.008403129648014*x0*u0 | Treatment 1: x_dot = +-1.00840222799005*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 2, 'seconds_taken': 5.483678454998881, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 18:56:59,131,131 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 2, 2.0)
MainProcess| 2023-05-14 18:56:59,133,133 multiprocessing INFO Running EQ_4_A crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 18:56:59,185,185 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:01:59,843,843 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2538602036197166, 'encoder_val_rmse_orig': 1.2538602036197166, 'encoder_test_rmse_all': 0.9272559189956625, 'encoder_test_rmse_orig': 1.25400891248, 'encoder_test_rmse_last': 1.2791285485409478, 'decoder_val_rmse_all': 0.3499759485894935, 'decoder_val_rmse_orig': 0.3499759485894934, 'decoder_test_rmse_2-step': 0.7550124170798986, 'decoder_test_rmse_3-step': 0.7817367066114793, 'decoder_test_rmse_4-step': 0.8650785961607492, 'decoder_test_rmse_5-step': 0.9763172254367123, 'decoder_test_rmse_6-step': 1.0930874887956274, 'method': 'crn', 'seed': 2, 'seconds_taken': 300.7094462660025, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:01:59,843,843 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 2, 2.0)
MainProcess| 2023-05-14 19:01:59,846,846 multiprocessing INFO Running EQ_4_A msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:01:59,894,894 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:02:05,319,319 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 2, 'seconds_taken': 5.472975507000228, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:02:05,319,319 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 19:02:05,322,322 multiprocessing INFO Running EQ_4_A gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:02:05,370,370 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:06:27,724,724 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4489727896628456, 'encoder_val_rmse_orig': 0.4489727896628456, 'encoder_test_rmse_all': 0.485240974927734, 'encoder_test_rmse_orig': 0.4487447292826933, 'encoder_test_rmse_last': 0.4476437529948962, 'decoder_val_rmse_all': 0.4489727896628456, 'decoder_val_rmse_orig': 0.4489727896628456, 'decoder_test_rmse_2-step': 0.5837606797597436, 'decoder_test_rmse_3-step': 0.6687391015320922, 'decoder_test_rmse_4-step': 0.7376217357876115, 'decoder_test_rmse_5-step': 0.7983076985640013, 'decoder_test_rmse_6-step': 0.8499662868420851, 'method': 'gnet', 'seed': 2, 'seconds_taken': 262.4014612320025, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:06:27,724,724 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 2, 2.0)
MainProcess| 2023-05-14 19:06:27,726,726 multiprocessing INFO Running EQ_4_A ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:06:27,775,775 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:07:15,933,933 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.33091082318606413, 'encoder_val_rmse_orig': 0.33091082318606413, 'encoder_test_rmse_all': 0.42133378604010924, 'encoder_test_rmse_orig': 0.3348622405679876, 'encoder_test_rmse_last': 0.44643738861977034, 'decoder_val_rmse_all': 0.33091082318606413, 'decoder_val_rmse_orig': 0.33091082318606413, 'decoder_test_rmse_2-step': 0.5091072439705533, 'decoder_test_rmse_3-step': 0.6015292861818015, 'decoder_test_rmse_4-step': 0.6701761026521521, 'decoder_test_rmse_5-step': 0.7134660032106224, 'decoder_test_rmse_6-step': 0.7319175939200536, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.20611233800082, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:07:15,933,933 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 19:07:15,936,936 multiprocessing INFO Running EQ_4_A rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:07:15,989,989 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:11:53,194,194 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49404073640451596, 'propensity_treatment_val_bce_orig': 0.49404073640451596, 'propensity_treatment_test_bce_all': 0.5076597552235517, 'propensity_treatment_test_bce_orig': 0.5151725136277345, 'propensity_history_val_bce_all': 0.4920618670269594, 'propensity_history_val_bce_orig': 0.4920618670269595, 'propensity_history_test_bce_all': 0.5047762157977638, 'propensity_history_test_bce_orig': 0.513318107098549, 'encoder_val_rmse_all': 2.6968804401802933, 'encoder_val_rmse_orig': 2.696880440180293, 'encoder_test_rmse_all': 3.737713825982188, 'encoder_test_rmse_orig': 2.7106256080843076, 'encoder_test_rmse_last': 2.8987862957115977, 'decoder_val_rmse_all': 0.48586729507766413, 'decoder_val_rmse_orig': 0.4858672950776643, 'decoder_test_rmse_2-step': 2.336862114549497, 'decoder_test_rmse_3-step': 2.2979325661110392, 'decoder_test_rmse_4-step': 2.29920635973251, 'decoder_test_rmse_5-step': 2.307390640724782, 'decoder_test_rmse_6-step': 2.3232487371731065, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 277.25789770700067, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:13:19,790,790 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 19:13:19,793,793 multiprocessing INFO Running EQ_4_B sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:13:19,843,843 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:13:24,091,91 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 4.297705419001431, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:13:24,091,91 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 2, 2.0)
MainProcess| 2023-05-14 19:13:24,094,94 multiprocessing INFO Running EQ_4_B wsindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:13:24,144,144 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:13:29,672,672 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1337496339846018, 'encoder_test_rmse_orig': 0.11357370835698738, 'encoder_test_rmse_last': 0.11366528290798368, 'decoder_test_rmse_2-step': 0.11349425074884308, 'decoder_test_rmse_3-step': 0.11321330651354196, 'decoder_test_rmse_4-step': 0.1125681655923184, 'decoder_test_rmse_5-step': 0.11130892738662966, 'decoder_test_rmse_6-step': 0.10988031584870997, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084071931464025*x0*u0 | Treatment 1: x_dot = +-1.0084372247450006*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 2, 'seconds_taken': 5.578329730000405, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:13:29,672,672 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 2, 2.0)
MainProcess| 2023-05-14 19:13:29,675,675 multiprocessing INFO Running EQ_4_B crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:13:29,724,724 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:18:31,386,386 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2501313461823582, 'encoder_val_rmse_orig': 1.2501313461823582, 'encoder_test_rmse_all': 0.9268920480659262, 'encoder_test_rmse_orig': 1.2504981571012528, 'encoder_test_rmse_last': 1.2770077142201817, 'decoder_val_rmse_all': 0.35135451281341257, 'decoder_val_rmse_orig': 0.35135451281341257, 'decoder_test_rmse_2-step': 0.7562469213188743, 'decoder_test_rmse_3-step': 0.7817291833445008, 'decoder_test_rmse_4-step': 0.8645906890205741, 'decoder_test_rmse_5-step': 0.9759665991590304, 'decoder_test_rmse_6-step': 1.0932818227953727, 'method': 'crn', 'seed': 2, 'seconds_taken': 301.71120510900073, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:18:31,387,387 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 2, 2.0)
MainProcess| 2023-05-14 19:18:31,389,389 multiprocessing INFO Running EQ_4_B msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:18:31,438,438 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:18:37,047,47 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 2, 'seconds_taken': 5.656998344002204, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:18:37,047,47 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 19:18:37,049,49 multiprocessing INFO Running EQ_4_B gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:18:37,101,101 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:22:56,343,343 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4495774601453519, 'encoder_val_rmse_orig': 0.4495774601453519, 'encoder_test_rmse_all': 0.48583307202610315, 'encoder_test_rmse_orig': 0.4493524849547999, 'encoder_test_rmse_last': 0.4480815328365303, 'decoder_val_rmse_all': 0.4495774601453519, 'decoder_val_rmse_orig': 0.4495774601453519, 'decoder_test_rmse_2-step': 0.584468776644234, 'decoder_test_rmse_3-step': 0.669677070473095, 'decoder_test_rmse_4-step': 0.7387942834989673, 'decoder_test_rmse_5-step': 0.7992347319266637, 'decoder_test_rmse_6-step': 0.8509404131022318, 'method': 'gnet', 'seed': 2, 'seconds_taken': 259.2929469240007, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:22:56,343,343 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 2, 2.0)
MainProcess| 2023-05-14 19:22:56,346,346 multiprocessing INFO Running EQ_4_B ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:22:56,394,394 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:23:44,280,280 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3303756757394648, 'encoder_val_rmse_orig': 0.3303756757394648, 'encoder_test_rmse_all': 0.4200811164411958, 'encoder_test_rmse_orig': 0.33425471903025566, 'encoder_test_rmse_last': 0.44557863447362117, 'decoder_val_rmse_all': 0.3303756757394648, 'decoder_val_rmse_orig': 0.3303756757394648, 'decoder_test_rmse_2-step': 0.5074082218830287, 'decoder_test_rmse_3-step': 0.5995840729841108, 'decoder_test_rmse_4-step': 0.6676261666813244, 'decoder_test_rmse_5-step': 0.7106359724786985, 'decoder_test_rmse_6-step': 0.7286942491162801, 'method': 'ct', 'seed': 2, 'seconds_taken': 47.93435207899893, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:23:44,280,280 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 19:23:44,283,283 multiprocessing INFO Running EQ_4_B rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:23:44,338,338 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:28:26,688,688 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49404073640451596, 'propensity_treatment_val_bce_orig': 0.49404073640451596, 'propensity_treatment_test_bce_all': 0.5076597552235517, 'propensity_treatment_test_bce_orig': 0.5151725136277345, 'propensity_history_val_bce_all': 0.4920626576068038, 'propensity_history_val_bce_orig': 0.49206265760680373, 'propensity_history_test_bce_all': 0.5047818392265147, 'propensity_history_test_bce_orig': 0.5133196151841464, 'encoder_val_rmse_all': 2.7075677019033506, 'encoder_val_rmse_orig': 2.7075677019033506, 'encoder_test_rmse_all': 3.747011378129772, 'encoder_test_rmse_orig': 2.7218413917399618, 'encoder_test_rmse_last': 2.9080352650999854, 'decoder_val_rmse_all': 0.5690657278454639, 'decoder_val_rmse_orig': 0.5690657278454639, 'decoder_test_rmse_2-step': 2.403732916015409, 'decoder_test_rmse_3-step': 2.410259954409154, 'decoder_test_rmse_4-step': 2.466497878945928, 'decoder_test_rmse_5-step': 2.5287877573795225, 'decoder_test_rmse_6-step': 2.590818309919837, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 282.4044894059989, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:29:54,975,975 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 19:29:54,978,978 multiprocessing INFO Running EQ_4_C sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:29:55,026,26 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:29:58,541,541 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 3.562650117000885, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:29:58,541,541 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 2, 2.0)
MainProcess| 2023-05-14 19:29:58,544,544 multiprocessing INFO Running EQ_4_C wsindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:29:58,595,595 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:30:04,159,159 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.15095073080062915, 'encoder_test_rmse_orig': 0.12302910702281845, 'encoder_test_rmse_last': 0.12299155426872455, 'decoder_test_rmse_2-step': 0.12270734416253712, 'decoder_test_rmse_3-step': 0.12200707255452024, 'decoder_test_rmse_4-step': 0.12073829692634955, 'decoder_test_rmse_5-step': 0.11862135587005758, 'decoder_test_rmse_6-step': 0.11619671066875922, 'global_equation_string': 'Treatment 0: x_dot = +-0.04536408780459111*x0+-1.019176701031092*x0*u0 | Treatment 1: x_dot = +-0.1462190726857637*x0+-1.0219806172609005*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 2, 'seconds_taken': 5.614410756003053, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:30:04,159,159 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 2, 2.0)
MainProcess| 2023-05-14 19:30:04,161,161 multiprocessing INFO Running EQ_4_C crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:30:04,213,213 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:35:06,357,357 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2373274560027676, 'encoder_val_rmse_orig': 1.2373274560027674, 'encoder_test_rmse_all': 0.9375415912661729, 'encoder_test_rmse_orig': 1.2373164434979969, 'encoder_test_rmse_last': 1.2425558937049765, 'decoder_val_rmse_all': 0.31187992920804797, 'decoder_val_rmse_orig': 0.3118799292080477, 'decoder_test_rmse_2-step': 0.42976399156234035, 'decoder_test_rmse_3-step': 0.46571498449217796, 'decoder_test_rmse_4-step': 0.5654643840172578, 'decoder_test_rmse_5-step': 0.703559479138171, 'decoder_test_rmse_6-step': 0.8401014203752099, 'method': 'crn', 'seed': 2, 'seconds_taken': 302.19544413900076, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:35:06,357,357 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 2, 2.0)
MainProcess| 2023-05-14 19:35:06,360,360 multiprocessing INFO Running EQ_4_C msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:35:06,408,408 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:35:11,806,806 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 2, 'seconds_taken': 5.44571928699952, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:35:11,806,806 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 19:35:11,809,809 multiprocessing INFO Running EQ_4_C gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:35:11,856,856 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:39:32,305,305 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.41415377075233956, 'encoder_val_rmse_orig': 0.41415377075233956, 'encoder_test_rmse_all': 0.45494231374912564, 'encoder_test_rmse_orig': 0.41354757012325527, 'encoder_test_rmse_last': 0.4135790922726988, 'decoder_val_rmse_all': 0.41415377075233956, 'decoder_val_rmse_orig': 0.41415377075233956, 'decoder_test_rmse_2-step': 0.5162115555208024, 'decoder_test_rmse_3-step': 0.5770828597845151, 'decoder_test_rmse_4-step': 0.6210548469579844, 'decoder_test_rmse_5-step': 0.6586510272818595, 'decoder_test_rmse_6-step': 0.6892027957056834, 'method': 'gnet', 'seed': 2, 'seconds_taken': 260.49569558799703, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:39:32,305,305 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 2, 2.0)
MainProcess| 2023-05-14 19:39:32,308,308 multiprocessing INFO Running EQ_4_C ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:39:32,354,354 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:40:20,442,442 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3736285749698569, 'encoder_val_rmse_orig': 0.37362857496985685, 'encoder_test_rmse_all': 0.48852897925286254, 'encoder_test_rmse_orig': 0.37422872069646607, 'encoder_test_rmse_last': 0.39967975944296297, 'decoder_val_rmse_all': 0.3736285749698569, 'decoder_val_rmse_orig': 0.37362857496985685, 'decoder_test_rmse_2-step': 0.5191558117849878, 'decoder_test_rmse_3-step': 0.6659034102267076, 'decoder_test_rmse_4-step': 0.7574740586522196, 'decoder_test_rmse_5-step': 0.8118167967494202, 'decoder_test_rmse_6-step': 0.8407338217871709, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.13457160100006, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:40:20,442,442 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 19:40:20,446,446 multiprocessing INFO Running EQ_4_C rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:40:20,500,500 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:45:02,592,592 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49404073640451596, 'propensity_treatment_val_bce_orig': 0.49404073640451596, 'propensity_treatment_test_bce_all': 0.5076597552235517, 'propensity_treatment_test_bce_orig': 0.5151725136277345, 'propensity_history_val_bce_all': 0.49204316239740886, 'propensity_history_val_bce_orig': 0.4920431623974089, 'propensity_history_test_bce_all': 0.5047373683313697, 'propensity_history_test_bce_orig': 0.5132998190867389, 'encoder_val_rmse_all': 2.3696318582296767, 'encoder_val_rmse_orig': 2.369631858229677, 'encoder_test_rmse_all': 3.2865581262777304, 'encoder_test_rmse_orig': 2.3835018728460144, 'encoder_test_rmse_last': 2.5785386102631556, 'decoder_val_rmse_all': 0.4621718836002246, 'decoder_val_rmse_orig': 0.46217188360022515, 'decoder_test_rmse_2-step': 2.114828101322033, 'decoder_test_rmse_3-step': 2.065567125537073, 'decoder_test_rmse_4-step': 2.0734874485956096, 'decoder_test_rmse_5-step': 2.0882151202359567, 'decoder_test_rmse_6-step': 2.107335254917488, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 282.1459786409978, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:46:33,575,575 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 2, 2.0)
MainProcess| 2023-05-14 19:46:33,578,578 multiprocessing INFO Running EQ_4_D sindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:46:33,629,629 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:46:37,249,249 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 3.6714996979972057, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:46:37,250,250 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 2, 2.0)
MainProcess| 2023-05-14 19:46:37,254,254 multiprocessing INFO Running EQ_4_D wsindy 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:46:37,307,307 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:46:42,995,995 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.12000317073819268, 'encoder_test_rmse_orig': 0.10194103499103718, 'encoder_test_rmse_last': 0.10239826993529251, 'decoder_test_rmse_2-step': 0.102485605189058, 'decoder_test_rmse_3-step': 0.10281543818204679, 'decoder_test_rmse_4-step': 0.10282891210206216, 'decoder_test_rmse_5-step': 0.10253781102025492, 'decoder_test_rmse_6-step': 0.10170758775686552, 'global_equation_string': 'Treatment 0: x_dot = +0.19787009258626057*x0+-1.0098261578619065*x0*u0 | Treatment 1: x_dot = +-0.09096121070589018*x0+-1.0200979440956335*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 2, 'seconds_taken': 5.740868315999251, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:46:42,995,995 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 2, 2.0)
MainProcess| 2023-05-14 19:46:42,998,998 multiprocessing INFO Running EQ_4_D crn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:46:43,050,50 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:51:45,960,960 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9489410570675115, 'encoder_val_rmse_orig': 0.9489410570675115, 'encoder_test_rmse_all': 0.8100188285382506, 'encoder_test_rmse_orig': 0.9751064852079914, 'encoder_test_rmse_last': 1.2144912986976384, 'decoder_val_rmse_all': 0.41635618583021755, 'decoder_val_rmse_orig': 0.41635618583021755, 'decoder_test_rmse_2-step': 1.9085849995042685, 'decoder_test_rmse_3-step': 1.8305223516210718, 'decoder_test_rmse_4-step': 1.8225903781972248, 'decoder_test_rmse_5-step': 1.849326759669849, 'decoder_test_rmse_6-step': 1.8977537564866531, 'method': 'crn', 'seed': 2, 'seconds_taken': 302.96122222100166, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:51:45,960,960 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 2, 2.0)
MainProcess| 2023-05-14 19:51:45,962,962 multiprocessing INFO Running EQ_4_D msm 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:51:46,011,11 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:51:51,687,687 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 2, 'seconds_taken': 5.724524911998742, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:51:51,687,687 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 2, 2.0)
MainProcess| 2023-05-14 19:51:51,690,690 multiprocessing INFO Running EQ_4_D gnet 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:51:51,739,739 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:56:08,870,870 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7318664442866544, 'encoder_val_rmse_orig': 0.7318664442866544, 'encoder_test_rmse_all': 0.7252704744821346, 'encoder_test_rmse_orig': 0.7298909070286362, 'encoder_test_rmse_last': 0.7155925463826737, 'decoder_val_rmse_all': 0.7318664442866544, 'decoder_val_rmse_orig': 0.7318664442866544, 'decoder_test_rmse_2-step': 0.8326396549977861, 'decoder_test_rmse_3-step': 0.9223050960446977, 'decoder_test_rmse_4-step': 0.9944748445012654, 'decoder_test_rmse_5-step': 1.0600493777006115, 'decoder_test_rmse_6-step': 1.1170969823512042, 'method': 'gnet', 'seed': 2, 'seconds_taken': 257.17971936899994, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:56:08,870,870 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 2, 2.0)
MainProcess| 2023-05-14 19:56:08,873,873 multiprocessing INFO Running EQ_4_D ct 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:56:08,923,923 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 19:56:57,724,724 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3723782869089705, 'encoder_val_rmse_orig': 0.3723782869089705, 'encoder_test_rmse_all': 0.45667523340103233, 'encoder_test_rmse_orig': 0.3926657665890879, 'encoder_test_rmse_last': 0.560579910293129, 'decoder_val_rmse_all': 0.3723782869089705, 'decoder_val_rmse_orig': 0.3723782869089705, 'decoder_test_rmse_2-step': 0.6271892753424465, 'decoder_test_rmse_3-step': 0.8332657199690248, 'decoder_test_rmse_4-step': 0.9138864424975712, 'decoder_test_rmse_5-step': 0.9873304381606879, 'decoder_test_rmse_6-step': 1.0479829021313847, 'method': 'ct', 'seed': 2, 'seconds_taken': 48.85056739499851, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 19:56:57,724,724 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 2, 2.0)
MainProcess| 2023-05-14 19:56:57,727,727 multiprocessing INFO Running EQ_4_D rmsn 2 | domain_conf=2.0
MainProcess| 2023-05-14 19:56:57,781,781 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:01:41,596,596 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5016502678596367, 'propensity_treatment_val_bce_orig': 0.5016502678596368, 'propensity_treatment_test_bce_all': 0.5149360834622787, 'propensity_treatment_test_bce_orig': 0.521991198068992, 'propensity_history_val_bce_all': 0.4997512086872327, 'propensity_history_val_bce_orig': 0.49975120868723266, 'propensity_history_test_bce_all': 0.5122169908454357, 'propensity_history_test_bce_orig': 0.5202158152747361, 'encoder_val_rmse_all': 2.186570661011754, 'encoder_val_rmse_orig': 2.186570661011754, 'encoder_test_rmse_all': 2.9803710297560206, 'encoder_test_rmse_orig': 2.2133790620067537, 'encoder_test_rmse_last': 2.4847842687059085, 'decoder_val_rmse_all': 0.23832739164589123, 'decoder_val_rmse_orig': 0.23832739164589115, 'decoder_test_rmse_2-step': 1.9917507058911308, 'decoder_test_rmse_3-step': 1.7921604833684257, 'decoder_test_rmse_4-step': 1.6839878001007682, 'decoder_test_rmse_5-step': 1.6072901321255568, 'decoder_test_rmse_6-step': 1.5515080019279859, 'method': 'rmsn', 'seed': 2, 'seconds_taken': 283.8695285270005, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:03:05,611,611 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 20:03:05,613,613 multiprocessing INFO Running cancer_sim sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:03:05,663,663 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:03:18,549,549 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 12.935060960997362, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:03:18,549,549 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 3, 2.0)
MainProcess| 2023-05-14 20:03:18,552,552 multiprocessing INFO Running cancer_sim crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:03:18,604,604 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:08:08,790,790 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0765320479080742, 'encoder_val_rmse_orig': 1.0320283776543986, 'encoder_test_rmse_all': 0.7989099782662382, 'encoder_test_rmse_orig': 0.6041779884165389, 'encoder_test_rmse_last': 0.7400515318780451, 'decoder_val_rmse_all': 0.34300858990859806, 'decoder_val_rmse_orig': 0.34300858990859834, 'decoder_test_rmse_2-step': 0.697880396199087, 'decoder_test_rmse_3-step': 0.749054257853547, 'decoder_test_rmse_4-step': 0.8024669582619822, 'decoder_test_rmse_5-step': 0.8536224539115613, 'decoder_test_rmse_6-step': 0.8958516956991042, 'method': 'crn', 'seed': 3, 'seconds_taken': 290.2384060000004, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:08:08,790,790 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 3, 2.0)
MainProcess| 2023-05-14 20:08:08,793,793 multiprocessing INFO Running cancer_sim msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:08:08,842,842 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:08:20,231,231 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 3, 'seconds_taken': 11.437700498001504, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:08:20,231,231 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 20:08:20,234,234 multiprocessing INFO Running cancer_sim gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:08:20,285,285 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:12:52,264,264 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1863212958088032, 'encoder_val_rmse_orig': 1.1360479907370005, 'encoder_test_rmse_all': 0.7728723033550204, 'encoder_test_rmse_orig': 0.5734316137712517, 'encoder_test_rmse_last': 0.6427916859177311, 'decoder_val_rmse_all': 1.1863212958088032, 'decoder_val_rmse_orig': 1.1360479907370005, 'decoder_test_rmse_2-step': 0.8623327318991738, 'decoder_test_rmse_3-step': 1.050288358964429, 'decoder_test_rmse_4-step': 1.2008515853484136, 'decoder_test_rmse_5-step': 1.3431154481583838, 'decoder_test_rmse_6-step': 1.4778082554586063, 'method': 'gnet', 'seed': 3, 'seconds_taken': 272.0299106169987, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:12:52,264,264 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 3, 2.0)
MainProcess| 2023-05-14 20:12:52,268,268 multiprocessing INFO Running cancer_sim ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:12:52,316,316 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:13:42,696,696 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.978783973165493, 'encoder_val_rmse_orig': 0.938920713017825, 'encoder_test_rmse_all': 0.8388391045327391, 'encoder_test_rmse_orig': 0.6356620318676439, 'encoder_test_rmse_last': 0.7111476075749273, 'decoder_val_rmse_all': 0.978783973165493, 'decoder_val_rmse_orig': 0.938920713017825, 'decoder_test_rmse_2-step': 0.8283913370400938, 'decoder_test_rmse_3-step': 0.9300912244305376, 'decoder_test_rmse_4-step': 1.0453236565774324, 'decoder_test_rmse_5-step': 1.1497781740222206, 'decoder_test_rmse_6-step': 1.239504022185768, 'method': 'ct', 'seed': 3, 'seconds_taken': 50.427651075999165, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:13:42,696,696 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 20:13:42,698,698 multiprocessing INFO Running cancer_sim rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:13:42,752,752 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:18:14,699,699 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7655681136119624, 'propensity_treatment_val_bce_orig': 0.7654504439138083, 'propensity_treatment_test_bce_all': 0.75843282573485, 'propensity_treatment_test_bce_orig': 0.7596917500070495, 'propensity_history_val_bce_all': 0.7609757415581704, 'propensity_history_val_bce_orig': 0.7609933008802217, 'propensity_history_test_bce_all': 0.7559666575990938, 'propensity_history_test_bce_orig': 0.7575826015304751, 'encoder_val_rmse_all': 1.2866904254310658, 'encoder_val_rmse_orig': 1.2326967977119507, 'encoder_test_rmse_all': 0.9418009126415177, 'encoder_test_rmse_orig': 0.6998960082557226, 'encoder_test_rmse_last': 0.8512499457608004, 'decoder_val_rmse_all': 0.31389787667020164, 'decoder_val_rmse_orig': 0.3138978766702019, 'decoder_test_rmse_2-step': 0.8087263817988551, 'decoder_test_rmse_3-step': 0.8622210646577968, 'decoder_test_rmse_4-step': 0.8886364560872715, 'decoder_test_rmse_5-step': 0.9091710270257328, 'decoder_test_rmse_6-step': 0.9281936649890611, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 271.9999589520012, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:20:29,899,899 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 20:20:29,902,902 multiprocessing INFO Running EQ_5_A sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:20:29,952,952 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:20:43,416,416 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 13.514411314001336, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:20:43,417,417 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 3, 2.0)
MainProcess| 2023-05-14 20:20:43,419,419 multiprocessing INFO Running EQ_5_A crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:20:43,468,468 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:25:35,886,886 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8515622530196986, 'encoder_val_rmse_orig': 0.8238173232127052, 'encoder_test_rmse_all': 0.9364013364918286, 'encoder_test_rmse_orig': 0.6796802087668552, 'encoder_test_rmse_last': 0.8006893212565588, 'decoder_val_rmse_all': 0.3287091072885181, 'decoder_val_rmse_orig': 0.3287091072885179, 'decoder_test_rmse_2-step': 0.7914933013291184, 'decoder_test_rmse_3-step': 0.8701944816845546, 'decoder_test_rmse_4-step': 0.9502578021056206, 'decoder_test_rmse_5-step': 1.0111639690467893, 'decoder_test_rmse_6-step': 1.0213968345293676, 'method': 'crn', 'seed': 3, 'seconds_taken': 292.4660543249993, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:25:35,886,886 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 3, 2.0)
MainProcess| 2023-05-14 20:25:35,889,889 multiprocessing INFO Running EQ_5_A msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:25:35,936,936 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:25:47,180,180 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 3, 'seconds_taken': 11.29112909900141, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:25:47,180,180 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 20:25:47,183,183 multiprocessing INFO Running EQ_5_A gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:25:47,226,226 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:30:23,829,829 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8631712680270937, 'encoder_val_rmse_orig': 0.834810420020155, 'encoder_test_rmse_all': 0.8764479227423181, 'encoder_test_rmse_orig': 0.6334517195164041, 'encoder_test_rmse_last': 0.8357674898200415, 'decoder_val_rmse_all': 0.8631712680270937, 'decoder_val_rmse_orig': 0.834810420020155, 'decoder_test_rmse_2-step': 0.891477785370379, 'decoder_test_rmse_3-step': 1.0435665659781994, 'decoder_test_rmse_4-step': 1.19628926113212, 'decoder_test_rmse_5-step': 1.3623694080328277, 'decoder_test_rmse_6-step': 1.5502678635472695, 'method': 'gnet', 'seed': 3, 'seconds_taken': 276.6461999139974, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:30:23,829,829 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 3, 2.0)
MainProcess| 2023-05-14 20:30:23,832,832 multiprocessing INFO Running EQ_5_A ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:30:23,884,884 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:31:13,149,149 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9871017711777514, 'encoder_val_rmse_orig': 0.9546764945877046, 'encoder_test_rmse_all': 1.1383091165783554, 'encoder_test_rmse_orig': 0.8325500711305726, 'encoder_test_rmse_last': 1.0818854483519957, 'decoder_val_rmse_all': 0.9871017711777514, 'decoder_val_rmse_orig': 0.9546764945877046, 'decoder_test_rmse_2-step': 1.0107796636936262, 'decoder_test_rmse_3-step': 1.1160708043725833, 'decoder_test_rmse_4-step': 1.21352309242868, 'decoder_test_rmse_5-step': 1.2782070464963033, 'decoder_test_rmse_6-step': 1.307565536831651, 'method': 'ct', 'seed': 3, 'seconds_taken': 49.31637896100074, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:31:13,149,149 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 20:31:13,152,152 multiprocessing INFO Running EQ_5_A rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:31:13,206,206 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:35:43,173,173 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7644426518404334, 'propensity_treatment_val_bce_orig': 0.7643601885385047, 'propensity_treatment_test_bce_all': 0.7598448065624209, 'propensity_treatment_test_bce_orig': 0.7586719870036656, 'propensity_history_val_bce_all': 0.7598811143611764, 'propensity_history_val_bce_orig': 0.7599069337879486, 'propensity_history_test_bce_all': 0.7583165030126432, 'propensity_history_test_bce_orig': 0.757456003751643, 'encoder_val_rmse_all': 1.320378785936771, 'encoder_val_rmse_orig': 1.2760208753147004, 'encoder_test_rmse_all': 1.3137648870954266, 'encoder_test_rmse_orig': 0.9486795889852982, 'encoder_test_rmse_last': 1.2024326248276307, 'decoder_val_rmse_all': 0.2762028323703126, 'decoder_val_rmse_orig': 0.2762028323703129, 'decoder_test_rmse_2-step': 1.0190709850879813, 'decoder_test_rmse_3-step': 1.039382213133334, 'decoder_test_rmse_4-step': 1.1076879154027464, 'decoder_test_rmse_5-step': 1.1812728549579559, 'decoder_test_rmse_6-step': 1.2621946849740173, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 270.0212552810008, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:37:18,164,164 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 20:37:18,167,167 multiprocessing INFO Running EQ_5_B sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:37:18,217,217 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:37:31,581,581 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 13.413282008998067, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:37:31,581,581 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 3, 2.0)
MainProcess| 2023-05-14 20:37:31,586,586 multiprocessing INFO Running EQ_5_B crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:37:31,635,635 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:42:24,445,445 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8515342180558481, 'encoder_val_rmse_orig': 0.8237903395667951, 'encoder_test_rmse_all': 0.9364002227322039, 'encoder_test_rmse_orig': 0.6796797934272483, 'encoder_test_rmse_last': 0.8006988938901051, 'decoder_val_rmse_all': 0.3283208620291204, 'decoder_val_rmse_orig': 0.32832086202912036, 'decoder_test_rmse_2-step': 0.7912768844695128, 'decoder_test_rmse_3-step': 0.8697056218751357, 'decoder_test_rmse_4-step': 0.949594458341238, 'decoder_test_rmse_5-step': 1.010401815014336, 'decoder_test_rmse_6-step': 1.02059686564477, 'method': 'crn', 'seed': 3, 'seconds_taken': 292.85911130399836, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:42:24,446,446 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 3, 2.0)
MainProcess| 2023-05-14 20:42:24,448,448 multiprocessing INFO Running EQ_5_B msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:42:24,496,496 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:42:34,941,941 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 3, 'seconds_taken': 10.492347729999892, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:42:34,941,941 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 20:42:34,944,944 multiprocessing INFO Running EQ_5_B gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:42:34,989,989 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:47:11,817,817 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8631418742551646, 'encoder_val_rmse_orig': 0.8347820031553725, 'encoder_test_rmse_all': 0.8764380537990354, 'encoder_test_rmse_orig': 0.6334444212002804, 'encoder_test_rmse_last': 0.8357531323349041, 'decoder_val_rmse_all': 0.8631418742551646, 'decoder_val_rmse_orig': 0.8347820031553725, 'decoder_test_rmse_2-step': 0.8914549073388918, 'decoder_test_rmse_3-step': 1.0435443082025402, 'decoder_test_rmse_4-step': 1.1962145380911755, 'decoder_test_rmse_5-step': 1.3622533778442372, 'decoder_test_rmse_6-step': 1.5500915093244707, 'method': 'gnet', 'seed': 3, 'seconds_taken': 276.8726200609999, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:47:11,817,817 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 3, 2.0)
MainProcess| 2023-05-14 20:47:11,820,820 multiprocessing INFO Running EQ_5_B ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:47:11,869,869 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:48:00,860,860 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9846482827807281, 'encoder_val_rmse_orig': 0.952292742192668, 'encoder_test_rmse_all': 1.140539908284836, 'encoder_test_rmse_orig': 0.8340339079996345, 'encoder_test_rmse_last': 1.0842542290083836, 'decoder_val_rmse_all': 0.9846482827807281, 'decoder_val_rmse_orig': 0.952292742192668, 'decoder_test_rmse_2-step': 1.013300347645799, 'decoder_test_rmse_3-step': 1.1179553855431492, 'decoder_test_rmse_4-step': 1.2121672276624453, 'decoder_test_rmse_5-step': 1.2740016768523388, 'decoder_test_rmse_6-step': 1.3005220868093383, 'method': 'ct', 'seed': 3, 'seconds_taken': 49.04024179899716, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:48:00,860,860 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 20:48:00,863,863 multiprocessing INFO Running EQ_5_B rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:48:00,910,910 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:52:31,906,906 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7644426518404334, 'propensity_treatment_val_bce_orig': 0.7643601885385047, 'propensity_treatment_test_bce_all': 0.7598448065624209, 'propensity_treatment_test_bce_orig': 0.7586719870036656, 'propensity_history_val_bce_all': 0.7594384840397005, 'propensity_history_val_bce_orig': 0.7594521520501899, 'propensity_history_test_bce_all': 0.7575273577637952, 'propensity_history_test_bce_orig': 0.7567710285004142, 'encoder_val_rmse_all': 1.3242816906308272, 'encoder_val_rmse_orig': 1.2797680798554554, 'encoder_test_rmse_all': 1.3187161315933362, 'encoder_test_rmse_orig': 0.9519257278096814, 'encoder_test_rmse_last': 1.2006033018745583, 'decoder_val_rmse_all': 0.2761476607624884, 'decoder_val_rmse_orig': 0.27614766076248876, 'decoder_test_rmse_2-step': 1.0172046069882588, 'decoder_test_rmse_3-step': 1.0390756923440894, 'decoder_test_rmse_4-step': 1.1200132864982675, 'decoder_test_rmse_5-step': 1.217248052996917, 'decoder_test_rmse_6-step': 1.329468508934206, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 271.04302113800077, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:54:08,672,672 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 20:54:08,675,675 multiprocessing INFO Running EQ_5_C sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:54:08,725,725 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:54:22,195,195 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 13.520251089001249, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:54:22,196,196 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 3, 2.0)
MainProcess| 2023-05-14 20:54:22,198,198 multiprocessing INFO Running EQ_5_C crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:54:22,247,247 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:59:17,789,789 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5778384897951522, 'encoder_val_rmse_orig': 0.5624045508299667, 'encoder_test_rmse_all': 0.8399708084833035, 'encoder_test_rmse_orig': 0.6140686552817815, 'encoder_test_rmse_last': 0.8305625340933777, 'decoder_val_rmse_all': 0.32271538615764933, 'decoder_val_rmse_orig': 0.3227153861576492, 'decoder_test_rmse_2-step': 0.8463897661196915, 'decoder_test_rmse_3-step': 0.8424312363597518, 'decoder_test_rmse_4-step': 0.8717031253415204, 'decoder_test_rmse_5-step': 0.9025132729134713, 'decoder_test_rmse_6-step': 0.92617876742968, 'method': 'crn', 'seed': 3, 'seconds_taken': 295.59098112300126, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:59:17,790,790 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 3, 2.0)
MainProcess| 2023-05-14 20:59:17,792,792 multiprocessing INFO Running EQ_5_C msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:59:17,837,837 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 20:59:28,497,497 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 3, 'seconds_taken': 10.704653120999865, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 20:59:28,497,497 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 20:59:28,500,500 multiprocessing INFO Running EQ_5_C gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 20:59:28,546,546 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:04:07,499,499 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5317370284712504, 'encoder_val_rmse_orig': 0.5171672151292727, 'encoder_test_rmse_all': 0.8802361823250103, 'encoder_test_rmse_orig': 0.6514257443536773, 'encoder_test_rmse_last': 1.0176149271488197, 'decoder_val_rmse_all': 0.5317370284712504, 'decoder_val_rmse_orig': 0.5171672151292727, 'decoder_test_rmse_2-step': 0.8418302280568963, 'decoder_test_rmse_3-step': 0.8876700434331853, 'decoder_test_rmse_4-step': 0.9041128556557098, 'decoder_test_rmse_5-step': 0.8984530691861358, 'decoder_test_rmse_6-step': 0.8758730874266559, 'method': 'gnet', 'seed': 3, 'seconds_taken': 278.9982754820012, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:04:07,499,499 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 3, 2.0)
MainProcess| 2023-05-14 21:04:07,502,502 multiprocessing INFO Running EQ_5_C ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:04:07,551,551 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:04:56,660,660 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6878165212063538, 'encoder_val_rmse_orig': 0.6694431289113949, 'encoder_test_rmse_all': 1.1598169649344865, 'encoder_test_rmse_orig': 0.8426222473493268, 'encoder_test_rmse_last': 1.0246244675543426, 'decoder_val_rmse_all': 0.6878165212063538, 'decoder_val_rmse_orig': 0.6694431289113949, 'decoder_test_rmse_2-step': 1.041254922724981, 'decoder_test_rmse_3-step': 1.0800840824654945, 'decoder_test_rmse_4-step': 1.0980988554245583, 'decoder_test_rmse_5-step': 1.093709075080846, 'decoder_test_rmse_6-step': 1.0841351027085906, 'method': 'ct', 'seed': 3, 'seconds_taken': 49.15799645699735, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:04:56,660,660 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 21:04:56,663,663 multiprocessing INFO Running EQ_5_C rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:04:56,716,716 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:09:27,808,808 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7659907590972205, 'propensity_treatment_val_bce_orig': 0.7659709515994361, 'propensity_treatment_test_bce_all': 0.7546082146768446, 'propensity_treatment_test_bce_orig': 0.7574506043069947, 'propensity_history_val_bce_all': 0.7605505201234977, 'propensity_history_val_bce_orig': 0.7606204886406559, 'propensity_history_test_bce_all': 0.7508774709815476, 'propensity_history_test_bce_orig': 0.7540293061394189, 'encoder_val_rmse_all': 1.0985834019784024, 'encoder_val_rmse_orig': 1.0680140618766003, 'encoder_test_rmse_all': 1.101782712654731, 'encoder_test_rmse_orig': 0.802723287910863, 'encoder_test_rmse_last': 1.1511568487240968, 'decoder_val_rmse_all': 0.29590551836469886, 'decoder_val_rmse_orig': 0.29590551836469897, 'decoder_test_rmse_2-step': 1.0538748650516152, 'decoder_test_rmse_3-step': 1.0043299832716743, 'decoder_test_rmse_4-step': 0.9797066676740263, 'decoder_test_rmse_5-step': 0.9924251415714448, 'decoder_test_rmse_6-step': 1.0345076501949098, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 271.1451764539961, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:11:03,101,101 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 21:11:03,104,104 multiprocessing INFO Running EQ_5_D sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:11:03,155,155 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:11:16,511,511 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 13.406602855000529, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:11:16,511,511 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 3, 2.0)
MainProcess| 2023-05-14 21:11:16,514,514 multiprocessing INFO Running EQ_5_D crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:11:16,561,561 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:16:10,884,884 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6254187936930681, 'encoder_val_rmse_orig': 0.6149945681904897, 'encoder_test_rmse_all': 0.8088642165308526, 'encoder_test_rmse_orig': 0.5839783963493603, 'encoder_test_rmse_last': 0.7349430739296896, 'decoder_val_rmse_all': 0.3943387836072075, 'decoder_val_rmse_orig': 0.39433878360720803, 'decoder_test_rmse_2-step': 0.9193463633966503, 'decoder_test_rmse_3-step': 0.9704288646072025, 'decoder_test_rmse_4-step': 0.9914087259888044, 'decoder_test_rmse_5-step': 0.9986181760175491, 'decoder_test_rmse_6-step': 0.979243104436023, 'method': 'crn', 'seed': 3, 'seconds_taken': 294.369791360994, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:16:10,884,884 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 3, 2.0)
MainProcess| 2023-05-14 21:16:10,887,887 multiprocessing INFO Running EQ_5_D msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:16:10,932,932 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:16:21,403,403 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 3, 'seconds_taken': 10.515845876005187, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:16:21,403,403 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 21:16:21,405,405 multiprocessing INFO Running EQ_5_D gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:16:21,454,454 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:20:57,549,549 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.65377002931608, 'encoder_val_rmse_orig': 0.6430879491980885, 'encoder_test_rmse_all': 0.8473700680813594, 'encoder_test_rmse_orig': 0.6138158774965822, 'encoder_test_rmse_last': 0.8486935377400945, 'decoder_val_rmse_all': 0.65377002931608, 'decoder_val_rmse_orig': 0.6430879491980885, 'decoder_test_rmse_2-step': 1.1524405337921162, 'decoder_test_rmse_3-step': 1.3795053794507486, 'decoder_test_rmse_4-step': 1.487449163711012, 'decoder_test_rmse_5-step': 1.5884272399041306, 'decoder_test_rmse_6-step': 1.682104922280997, 'method': 'gnet', 'seed': 3, 'seconds_taken': 276.1438101149979, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:20:57,550,550 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 3, 2.0)
MainProcess| 2023-05-14 21:20:57,552,552 multiprocessing INFO Running EQ_5_D ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:20:57,596,596 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:21:47,037,37 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7793182514765964, 'encoder_val_rmse_orig': 0.7660738403463552, 'encoder_test_rmse_all': 1.123641207191002, 'encoder_test_rmse_orig': 0.8112286849345833, 'encoder_test_rmse_last': 1.004537489490415, 'decoder_val_rmse_all': 0.7793182514765964, 'decoder_val_rmse_orig': 0.7660738403463552, 'decoder_test_rmse_2-step': 1.088567213269953, 'decoder_test_rmse_3-step': 1.172604307800829, 'decoder_test_rmse_4-step': 1.2340536951441397, 'decoder_test_rmse_5-step': 1.2950929179006991, 'decoder_test_rmse_6-step': 1.3128106162964246, 'method': 'ct', 'seed': 3, 'seconds_taken': 49.48446250899724, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:21:47,037,37 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 21:21:47,040,40 multiprocessing INFO Running EQ_5_D rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:21:47,094,94 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:26:18,813,813 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7657734107463025, 'propensity_treatment_val_bce_orig': 0.765747764506284, 'propensity_treatment_test_bce_all': 0.7547119050302067, 'propensity_treatment_test_bce_orig': 0.7580028657628718, 'propensity_history_val_bce_all': 0.7620426183837137, 'propensity_history_val_bce_orig': 0.7620802185882081, 'propensity_history_test_bce_all': 0.7538249021797339, 'propensity_history_test_bce_orig': 0.7570050775813199, 'encoder_val_rmse_all': 1.082105941700057, 'encoder_val_rmse_orig': 1.0624217236140863, 'encoder_test_rmse_all': 1.2078714416504024, 'encoder_test_rmse_orig': 0.871092086713769, 'encoder_test_rmse_last': 1.114803914646293, 'decoder_val_rmse_all': 0.32134713202687654, 'decoder_val_rmse_orig': 0.32134713202687665, 'decoder_test_rmse_2-step': 1.2225800447706672, 'decoder_test_rmse_3-step': 1.2063777509685116, 'decoder_test_rmse_4-step': 1.159052408774209, 'decoder_test_rmse_5-step': 1.1214508296496124, 'decoder_test_rmse_6-step': 1.0720553965119417, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 271.7726100130021, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:27:46,262,262 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 21:27:46,265,265 multiprocessing INFO Running EQ_4_A sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:27:46,313,313 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:27:49,958,958 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 3.6933726130009745, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:27:49,958,958 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 3, 2.0)
MainProcess| 2023-05-14 21:27:49,961,961 multiprocessing INFO Running EQ_4_A wsindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:27:50,012,12 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:27:55,601,601 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13145355624479144, 'encoder_test_rmse_orig': 0.11118526670337171, 'encoder_test_rmse_last': 0.11118829981413808, 'decoder_test_rmse_2-step': 0.11110273515623732, 'decoder_test_rmse_3-step': 0.11074643990531455, 'decoder_test_rmse_4-step': 0.11004013750415514, 'decoder_test_rmse_5-step': 0.10895751180356429, 'decoder_test_rmse_6-step': 0.10750416528337688, 'global_equation_string': 'Treatment 0: x_dot = +-1.008387340300083*x0*u0 | Treatment 1: x_dot = +-1.0083886122341539*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 3, 'seconds_taken': 5.639790029003052, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:27:55,601,601 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 3, 2.0)
MainProcess| 2023-05-14 21:27:55,604,604 multiprocessing INFO Running EQ_4_A crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:27:55,655,655 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:32:56,259,259 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8378577333974591, 'encoder_val_rmse_orig': 0.837857733397459, 'encoder_test_rmse_all': 0.6563189145128013, 'encoder_test_rmse_orig': 0.8401360510626619, 'encoder_test_rmse_last': 0.9121426381354168, 'decoder_val_rmse_all': 0.3682602441848887, 'decoder_val_rmse_orig': 0.36826024418488845, 'decoder_test_rmse_2-step': 0.8724974228496823, 'decoder_test_rmse_3-step': 0.8553097947346309, 'decoder_test_rmse_4-step': 0.8881870874318137, 'decoder_test_rmse_5-step': 1.0009582909278816, 'decoder_test_rmse_6-step': 1.1478706867481303, 'method': 'crn', 'seed': 3, 'seconds_taken': 300.655227301002, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:32:56,259,259 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 3, 2.0)
MainProcess| 2023-05-14 21:32:56,263,263 multiprocessing INFO Running EQ_4_A msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:32:56,311,311 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:33:01,729,729 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 3, 'seconds_taken': 5.465509005996864, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:33:01,730,730 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 21:33:01,732,732 multiprocessing INFO Running EQ_4_A gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:33:01,780,780 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:37:31,352,352 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.41984994341955956, 'encoder_val_rmse_orig': 0.41984994341955956, 'encoder_test_rmse_all': 0.5091212399344697, 'encoder_test_rmse_orig': 0.42075179251213357, 'encoder_test_rmse_last': 0.4369130109393698, 'decoder_val_rmse_all': 0.41984994341955956, 'decoder_val_rmse_orig': 0.41984994341955956, 'decoder_test_rmse_2-step': 0.5786883553759549, 'decoder_test_rmse_3-step': 0.641538216380112, 'decoder_test_rmse_4-step': 0.6826856986120701, 'decoder_test_rmse_5-step': 0.7093631945496803, 'decoder_test_rmse_6-step': 0.7282368503392187, 'method': 'gnet', 'seed': 3, 'seconds_taken': 269.619125033998, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:37:31,352,352 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 3, 2.0)
MainProcess| 2023-05-14 21:37:31,355,355 multiprocessing INFO Running EQ_4_A ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:37:31,403,403 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:38:19,948,948 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.37587226624379566, 'encoder_val_rmse_orig': 0.3758722662437957, 'encoder_test_rmse_all': 0.5012063381863949, 'encoder_test_rmse_orig': 0.3881218425752338, 'encoder_test_rmse_last': 0.6809325325642472, 'decoder_val_rmse_all': 0.37587226624379566, 'decoder_val_rmse_orig': 0.3758722662437957, 'decoder_test_rmse_2-step': 0.7873012186841937, 'decoder_test_rmse_3-step': 0.95715025982269, 'decoder_test_rmse_4-step': 1.0918626718817595, 'decoder_test_rmse_5-step': 1.1937063887273696, 'decoder_test_rmse_6-step': 1.2558367173265927, 'method': 'ct', 'seed': 3, 'seconds_taken': 48.59326556199812, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:38:19,948,948 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 21:38:19,951,951 multiprocessing INFO Running EQ_4_A rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:38:20,005,5 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:43:00,633,633 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4946421294293161, 'propensity_treatment_val_bce_orig': 0.4946421294293161, 'propensity_treatment_test_bce_all': 0.5085177699706313, 'propensity_treatment_test_bce_orig': 0.51573639276586, 'propensity_history_val_bce_all': 0.4921424094095068, 'propensity_history_val_bce_orig': 0.4921424094095069, 'propensity_history_test_bce_all': 0.5049251963199869, 'propensity_history_test_bce_orig': 0.5133967875628609, 'encoder_val_rmse_all': 2.9278988243696937, 'encoder_val_rmse_orig': 2.927898824369694, 'encoder_test_rmse_all': 4.050389185890554, 'encoder_test_rmse_orig': 2.9322067356922394, 'encoder_test_rmse_last': 3.040613972630638, 'decoder_val_rmse_all': 0.31226182490345916, 'decoder_val_rmse_orig': 0.31226182490345916, 'decoder_test_rmse_2-step': 2.613653458276898, 'decoder_test_rmse_3-step': 2.336008529369993, 'decoder_test_rmse_4-step': 2.1196878912542756, 'decoder_test_rmse_5-step': 1.9392884267189343, 'decoder_test_rmse_6-step': 1.7979994754017508, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 280.68221043000085, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:44:28,433,433 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 21:44:28,436,436 multiprocessing INFO Running EQ_4_B sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:44:28,488,488 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:44:32,092,92 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 3.6551258149993373, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:44:32,092,92 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 3, 2.0)
MainProcess| 2023-05-14 21:44:32,094,94 multiprocessing INFO Running EQ_4_B wsindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:44:32,143,143 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:44:37,583,583 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13317508138908749, 'encoder_test_rmse_orig': 0.1130894181068386, 'encoder_test_rmse_last': 0.11317654427206647, 'decoder_test_rmse_2-step': 0.11300602512940325, 'decoder_test_rmse_3-step': 0.11272287433621687, 'decoder_test_rmse_4-step': 0.11207748257082813, 'decoder_test_rmse_5-step': 0.11082030319622571, 'decoder_test_rmse_6-step': 0.10939569204803827, 'global_equation_string': 'Treatment 0: x_dot = +-1.0083519314308191*x0*u0 | Treatment 1: x_dot = +-1.0084105038112807*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 3, 'seconds_taken': 5.48834586799785, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:44:37,583,583 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 3, 2.0)
MainProcess| 2023-05-14 21:44:37,586,586 multiprocessing INFO Running EQ_4_B crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:44:37,638,638 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:49:38,379,379 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8371106540435799, 'encoder_val_rmse_orig': 0.8371106540435796, 'encoder_test_rmse_all': 0.6556325358373734, 'encoder_test_rmse_orig': 0.8395389354180731, 'encoder_test_rmse_last': 0.9112864781372352, 'decoder_val_rmse_all': 0.36818969224960624, 'decoder_val_rmse_orig': 0.36818969224960646, 'decoder_test_rmse_2-step': 0.8741253917690718, 'decoder_test_rmse_3-step': 0.8561989337466481, 'decoder_test_rmse_4-step': 0.8875538756954934, 'decoder_test_rmse_5-step': 0.9988233331192624, 'decoder_test_rmse_6-step': 1.144534648436798, 'method': 'crn', 'seed': 3, 'seconds_taken': 300.7933746270064, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:49:38,380,380 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 3, 2.0)
MainProcess| 2023-05-14 21:49:38,382,382 multiprocessing INFO Running EQ_4_B msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:49:38,430,430 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:49:43,825,825 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 3, 'seconds_taken': 5.442480520003301, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:49:43,825,825 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 21:49:43,828,828 multiprocessing INFO Running EQ_4_B gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:49:43,870,870 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:54:04,884,884 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4253169316345116, 'encoder_val_rmse_orig': 0.4253169316345116, 'encoder_test_rmse_all': 0.5115690520947949, 'encoder_test_rmse_orig': 0.42610310956798897, 'encoder_test_rmse_last': 0.4417495826591366, 'decoder_val_rmse_all': 0.4253169316345116, 'decoder_val_rmse_orig': 0.4253169316345116, 'decoder_test_rmse_2-step': 0.5829685626646036, 'decoder_test_rmse_3-step': 0.6461717764428863, 'decoder_test_rmse_4-step': 0.6877485413329856, 'decoder_test_rmse_5-step': 0.7149783153816855, 'decoder_test_rmse_6-step': 0.7350066382315326, 'method': 'gnet', 'seed': 3, 'seconds_taken': 261.05601926099916, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:54:04,885,885 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 3, 2.0)
MainProcess| 2023-05-14 21:54:04,887,887 multiprocessing INFO Running EQ_4_B ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:54:04,937,937 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:54:53,272,272 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.37618927652162526, 'encoder_val_rmse_orig': 0.37618927652162526, 'encoder_test_rmse_all': 0.5012819184312212, 'encoder_test_rmse_orig': 0.38842004631040983, 'encoder_test_rmse_last': 0.6814179493130466, 'decoder_val_rmse_all': 0.37618927652162526, 'decoder_val_rmse_orig': 0.37618927652162526, 'decoder_test_rmse_2-step': 0.7881299182856392, 'decoder_test_rmse_3-step': 0.9586765392407479, 'decoder_test_rmse_4-step': 1.0945456659511206, 'decoder_test_rmse_5-step': 1.1972909227251916, 'decoder_test_rmse_6-step': 1.260066815532727, 'method': 'ct', 'seed': 3, 'seconds_taken': 48.384589952998795, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 21:54:53,272,272 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 21:54:53,275,275 multiprocessing INFO Running EQ_4_B rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 21:54:53,330,330 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 21:59:29,341,341 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4946421294293161, 'propensity_treatment_val_bce_orig': 0.4946421294293161, 'propensity_treatment_test_bce_all': 0.5085177699706313, 'propensity_treatment_test_bce_orig': 0.51573639276586, 'propensity_history_val_bce_all': 0.4920749941720801, 'propensity_history_val_bce_orig': 0.49207499417208006, 'propensity_history_test_bce_all': 0.5047991880362822, 'propensity_history_test_bce_orig': 0.5133310751358593, 'encoder_val_rmse_all': 2.909737562255671, 'encoder_val_rmse_orig': 2.9097375622556707, 'encoder_test_rmse_all': 4.021707262591281, 'encoder_test_rmse_orig': 2.913735182222134, 'encoder_test_rmse_last': 3.018405051386926, 'decoder_val_rmse_all': 0.25387226013140995, 'decoder_val_rmse_orig': 0.25387226013140984, 'decoder_test_rmse_2-step': 2.5845781031716593, 'decoder_test_rmse_3-step': 2.3659752536980125, 'decoder_test_rmse_4-step': 2.191021686193586, 'decoder_test_rmse_5-step': 2.0325073948483228, 'decoder_test_rmse_6-step': 1.8940161635227857, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 276.06525387600414, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:00:57,707,707 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 22:00:57,712,712 multiprocessing INFO Running EQ_4_C sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:00:57,763,763 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:01:01,234,234 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 3.5220175389986252, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:01:01,234,234 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 3, 2.0)
MainProcess| 2023-05-14 22:01:01,237,237 multiprocessing INFO Running EQ_4_C wsindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:01:01,287,287 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:01:06,875,875 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.15167137661151572, 'encoder_test_rmse_orig': 0.1237021221714442, 'encoder_test_rmse_last': 0.12373478298283325, 'decoder_test_rmse_2-step': 0.1234454227364829, 'decoder_test_rmse_3-step': 0.12279424326360083, 'decoder_test_rmse_4-step': 0.12156122025925441, 'decoder_test_rmse_5-step': 0.11946968729600646, 'decoder_test_rmse_6-step': 0.11706033306678959, 'global_equation_string': 'Treatment 0: x_dot = +-0.04588823551324136*x0+-1.0185425441133646*x0*u0 | Treatment 1: x_dot = +-0.14555609007935943*x0+-1.0231343030407176*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 3, 'seconds_taken': 5.637091450000298, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:01:06,875,875 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 3, 2.0)
MainProcess| 2023-05-14 22:01:06,877,877 multiprocessing INFO Running EQ_4_C crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:01:06,930,930 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:06:07,837,837 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.714940883850989, 'encoder_val_rmse_orig': 0.714940883850989, 'encoder_test_rmse_all': 0.5809379672507797, 'encoder_test_rmse_orig': 0.7160597122678893, 'encoder_test_rmse_last': 0.7351731943294884, 'decoder_val_rmse_all': 0.29310964473117757, 'decoder_val_rmse_orig': 0.2931096447311776, 'decoder_test_rmse_2-step': 0.4034599369149787, 'decoder_test_rmse_3-step': 0.4626661361951902, 'decoder_test_rmse_4-step': 0.5649138533742017, 'decoder_test_rmse_5-step': 0.6845586709934679, 'decoder_test_rmse_6-step': 0.7989944424875167, 'method': 'crn', 'seed': 3, 'seconds_taken': 300.9589375930009, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:06:07,837,837 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 3, 2.0)
MainProcess| 2023-05-14 22:06:07,839,839 multiprocessing INFO Running EQ_4_C msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:06:07,884,884 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:06:13,381,381 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 3, 'seconds_taken': 5.540993184004037, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:06:13,381,381 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 22:06:13,384,384 multiprocessing INFO Running EQ_4_C gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:06:13,430,430 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:10:43,049,49 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3563375835359836, 'encoder_val_rmse_orig': 0.3563375835359836, 'encoder_test_rmse_all': 0.45976039449905115, 'encoder_test_rmse_orig': 0.3568993379859306, 'encoder_test_rmse_last': 0.37041409870008385, 'decoder_val_rmse_all': 0.3563375835359836, 'decoder_val_rmse_orig': 0.3563375835359836, 'decoder_test_rmse_2-step': 0.48544080794258054, 'decoder_test_rmse_3-step': 0.527908090917372, 'decoder_test_rmse_4-step': 0.5564797188474491, 'decoder_test_rmse_5-step': 0.5759614038786144, 'decoder_test_rmse_6-step': 0.5902372968605407, 'method': 'gnet', 'seed': 3, 'seconds_taken': 269.6652610550009, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:10:43,049,49 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 3, 2.0)
MainProcess| 2023-05-14 22:10:43,052,52 multiprocessing INFO Running EQ_4_C ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:10:43,105,105 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:11:31,609,609 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3496668915788023, 'encoder_val_rmse_orig': 0.3496668915788023, 'encoder_test_rmse_all': 0.46538794562570734, 'encoder_test_rmse_orig': 0.35545605382382134, 'encoder_test_rmse_last': 0.5722023279568924, 'decoder_val_rmse_all': 0.3496668915788023, 'decoder_val_rmse_orig': 0.3496668915788023, 'decoder_test_rmse_2-step': 0.6685132010183276, 'decoder_test_rmse_3-step': 0.8050139770379047, 'decoder_test_rmse_4-step': 0.9135298566719672, 'decoder_test_rmse_5-step': 0.9984199514180442, 'decoder_test_rmse_6-step': 1.0510483664950656, 'method': 'ct', 'seed': 3, 'seconds_taken': 48.557214799002395, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:11:31,610,610 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 22:11:31,613,613 multiprocessing INFO Running EQ_4_C rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:11:31,666,666 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:16:11,370,370 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4946421294293161, 'propensity_treatment_val_bce_orig': 0.4946421294293161, 'propensity_treatment_test_bce_all': 0.5085177699706313, 'propensity_treatment_test_bce_orig': 0.51573639276586, 'propensity_history_val_bce_all': 0.49203731115591726, 'propensity_history_val_bce_orig': 0.49203731115591726, 'propensity_history_test_bce_all': 0.5047224187123573, 'propensity_history_test_bce_orig': 0.5132933883045251, 'encoder_val_rmse_all': 2.8187389882044562, 'encoder_val_rmse_orig': 2.818738988204456, 'encoder_test_rmse_all': 3.9058362123999704, 'encoder_test_rmse_orig': 2.822496946253789, 'encoder_test_rmse_last': 2.9234081175906823, 'decoder_val_rmse_all': 0.24119452548713471, 'decoder_val_rmse_orig': 0.24119452548713483, 'decoder_test_rmse_2-step': 2.477054754250953, 'decoder_test_rmse_3-step': 2.1845078942854426, 'decoder_test_rmse_4-step': 1.9499191327553327, 'decoder_test_rmse_5-step': 1.7462079899740506, 'decoder_test_rmse_6-step': 1.5747643267048785, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 279.75721122699906, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:17:42,154,154 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 3, 2.0)
MainProcess| 2023-05-14 22:17:42,157,157 multiprocessing INFO Running EQ_4_D sindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:17:42,206,206 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:17:45,664,664 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 3.506843527997262, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:17:45,664,664 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 3, 2.0)
MainProcess| 2023-05-14 22:17:45,667,667 multiprocessing INFO Running EQ_4_D wsindy 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:17:45,718,718 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:17:51,096,96 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.11610264506950312, 'encoder_test_rmse_orig': 0.09874473411604144, 'encoder_test_rmse_last': 0.0991973656584191, 'decoder_test_rmse_2-step': 0.0992822636190706, 'decoder_test_rmse_3-step': 0.09960274625523699, 'decoder_test_rmse_4-step': 0.09961282850226183, 'decoder_test_rmse_5-step': 0.09932971681360654, 'decoder_test_rmse_6-step': 0.09851606488769665, 'global_equation_string': 'Treatment 0: x_dot = +0.19771787514242883*x0+-1.0094680698189666*x0*u0 | Treatment 1: x_dot = +-0.09001454750135926*x0+-1.021537860174491*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 3, 'seconds_taken': 5.429357182998501, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:17:51,096,96 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 3, 2.0)
MainProcess| 2023-05-14 22:17:51,099,99 multiprocessing INFO Running EQ_4_D crn 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:17:51,150,150 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:22:51,290,290 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1627929447174035, 'encoder_val_rmse_orig': 1.1627929447174035, 'encoder_test_rmse_all': 0.9790255514167898, 'encoder_test_rmse_orig': 1.1897439597949933, 'encoder_test_rmse_last': 1.4504898839634786, 'decoder_val_rmse_all': 0.40732689696573593, 'decoder_val_rmse_orig': 0.4073268969657362, 'decoder_test_rmse_2-step': 2.11922803088889, 'decoder_test_rmse_3-step': 1.9975687349342044, 'decoder_test_rmse_4-step': 2.004409062406398, 'decoder_test_rmse_5-step': 2.055702170578304, 'decoder_test_rmse_6-step': 2.127636003013868, 'method': 'crn', 'seed': 3, 'seconds_taken': 300.1904211989968, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:22:51,290,290 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 3, 2.0)
MainProcess| 2023-05-14 22:22:51,293,293 multiprocessing INFO Running EQ_4_D msm 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:22:51,340,340 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:22:56,784,784 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 3, 'seconds_taken': 5.491614363003464, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:22:56,785,785 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 3, 2.0)
MainProcess| 2023-05-14 22:22:56,787,787 multiprocessing INFO Running EQ_4_D gnet 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:22:56,837,837 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:27:16,518,518 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5151675016872598, 'encoder_val_rmse_orig': 0.5151675016872597, 'encoder_test_rmse_all': 0.6355376355921148, 'encoder_test_rmse_orig': 0.5155862454217599, 'encoder_test_rmse_last': 0.5230166100657305, 'decoder_val_rmse_all': 0.5151675016872598, 'decoder_val_rmse_orig': 0.5151675016872597, 'decoder_test_rmse_2-step': 0.6505543041879611, 'decoder_test_rmse_3-step': 0.7408614600933814, 'decoder_test_rmse_4-step': 0.8081963564577792, 'decoder_test_rmse_5-step': 0.8613856006125106, 'decoder_test_rmse_6-step': 0.9031476651554491, 'method': 'gnet', 'seed': 3, 'seconds_taken': 259.73014736299956, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:27:16,518,518 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 3, 2.0)
MainProcess| 2023-05-14 22:27:16,521,521 multiprocessing INFO Running EQ_4_D ct 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:27:16,570,570 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:28:04,168,168 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.41300136725292513, 'encoder_val_rmse_orig': 0.41300136725292513, 'encoder_test_rmse_all': 0.5373003276722448, 'encoder_test_rmse_orig': 0.43891100341701833, 'encoder_test_rmse_last': 0.6490938481594326, 'decoder_val_rmse_all': 0.41300136725292513, 'decoder_val_rmse_orig': 0.41300136725292513, 'decoder_test_rmse_2-step': 0.7766910707761137, 'decoder_test_rmse_3-step': 0.8968432472252704, 'decoder_test_rmse_4-step': 0.9901758910041707, 'decoder_test_rmse_5-step': 1.0688017340940101, 'decoder_test_rmse_6-step': 1.1108835376066875, 'method': 'ct', 'seed': 3, 'seconds_taken': 47.64694179700018, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:28:04,168,168 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 3, 2.0)
MainProcess| 2023-05-14 22:28:04,171,171 multiprocessing INFO Running EQ_4_D rmsn 3 | domain_conf=2.0
MainProcess| 2023-05-14 22:28:04,224,224 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:32:40,903,903 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5023015516491259, 'propensity_treatment_val_bce_orig': 0.5023015516491259, 'propensity_treatment_test_bce_all': 0.5159225381996672, 'propensity_treatment_test_bce_orig': 0.5226084480199001, 'propensity_history_val_bce_all': 0.49979479219953893, 'propensity_history_val_bce_orig': 0.49979479219953893, 'propensity_history_test_bce_all': 0.5122917256157445, 'propensity_history_test_bce_orig': 0.5202575089937732, 'encoder_val_rmse_all': 2.699772230344506, 'encoder_val_rmse_orig': 2.699772230344506, 'encoder_test_rmse_all': 3.697272774715834, 'encoder_test_rmse_orig': 2.7086260377504536, 'encoder_test_rmse_last': 2.8186035596533605, 'decoder_val_rmse_all': 0.23511443767658802, 'decoder_val_rmse_orig': 0.23511443767658802, 'decoder_test_rmse_2-step': 2.3861246555267326, 'decoder_test_rmse_3-step': 2.205359619959654, 'decoder_test_rmse_4-step': 2.0859501094481323, 'decoder_test_rmse_5-step': 1.9897514591402914, 'decoder_test_rmse_6-step': 1.9142748416530049, 'method': 'rmsn', 'seed': 3, 'seconds_taken': 276.731259537999, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:34:04,029,29 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 4, 2.0)
MainProcess| 2023-05-14 22:34:04,031,31 multiprocessing INFO Running cancer_sim sindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:34:04,079,79 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:34:17,200,200 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 13.167869113996858, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:34:17,200,200 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 4, 2.0)
MainProcess| 2023-05-14 22:34:17,203,203 multiprocessing INFO Running cancer_sim crn 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:34:17,252,252 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:39:06,041,41 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0774932840558074, 'encoder_val_rmse_orig': 1.0329639665238874, 'encoder_test_rmse_all': 0.7937609912565049, 'encoder_test_rmse_orig': 0.6004984048755554, 'encoder_test_rmse_last': 0.7363989057161148, 'decoder_val_rmse_all': 0.3361460944091382, 'decoder_val_rmse_orig': 0.33614609440913823, 'decoder_test_rmse_2-step': 0.6973649126449785, 'decoder_test_rmse_3-step': 0.7407007589735072, 'decoder_test_rmse_4-step': 0.7998991771484334, 'decoder_test_rmse_5-step': 0.8565192493746351, 'decoder_test_rmse_6-step': 0.901095683306617, 'method': 'crn', 'seed': 4, 'seconds_taken': 288.8374922869989, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:39:06,041,41 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 4, 2.0)
MainProcess| 2023-05-14 22:39:06,044,44 multiprocessing INFO Running cancer_sim msm 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:39:06,089,89 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:39:17,469,469 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 4, 'seconds_taken': 11.424497334002808, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:39:17,469,469 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 4, 2.0)
MainProcess| 2023-05-14 22:39:17,474,474 multiprocessing INFO Running cancer_sim gnet 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:39:17,521,521 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:43:43,698,698 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.164690495877163, 'encoder_val_rmse_orig': 1.11548639263541, 'encoder_test_rmse_all': 0.762867063058465, 'encoder_test_rmse_orig': 0.5766312232517303, 'encoder_test_rmse_last': 0.718826141622184, 'decoder_val_rmse_all': 1.164690495877163, 'decoder_val_rmse_orig': 1.11548639263541, 'decoder_test_rmse_2-step': 0.8719141505296177, 'decoder_test_rmse_3-step': 1.0471178948747102, 'decoder_test_rmse_4-step': 1.097781609088046, 'decoder_test_rmse_5-step': 1.1523223002581093, 'decoder_test_rmse_6-step': 1.2061683554136955, 'method': 'gnet', 'seed': 4, 'seconds_taken': 266.22399385500466, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:43:43,698,698 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 4, 2.0)
MainProcess| 2023-05-14 22:43:43,701,701 multiprocessing INFO Running cancer_sim ct 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:43:43,751,751 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:44:33,395,395 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0292950592672787, 'encoder_val_rmse_orig': 0.9873421641046454, 'encoder_test_rmse_all': 0.9464980972313994, 'encoder_test_rmse_orig': 0.7104445618006948, 'encoder_test_rmse_last': 0.7907846526881847, 'decoder_val_rmse_all': 1.0292950592672787, 'decoder_val_rmse_orig': 0.9873421641046454, 'decoder_test_rmse_2-step': 0.8993198226785576, 'decoder_test_rmse_3-step': 0.9260022844649182, 'decoder_test_rmse_4-step': 0.9675778054920446, 'decoder_test_rmse_5-step': 1.0458124795614865, 'decoder_test_rmse_6-step': 1.088273246344641, 'method': 'ct', 'seed': 4, 'seconds_taken': 49.694244972997694, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:44:33,395,395 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 4, 2.0)
MainProcess| 2023-05-14 22:44:33,398,398 multiprocessing INFO Running cancer_sim rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:44:33,449,449 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:48:58,757,757 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.770528064031214, 'propensity_treatment_val_bce_orig': 0.7704648278459886, 'propensity_treatment_test_bce_all': 0.7620117726195401, 'propensity_treatment_test_bce_orig': 0.7642126616536938, 'propensity_history_val_bce_all': 0.7618661906479773, 'propensity_history_val_bce_orig': 0.7618725677143655, 'propensity_history_test_bce_all': 0.7567892700948678, 'propensity_history_test_bce_orig': 0.7584070954914974, 'encoder_val_rmse_all': 1.3301382972452196, 'encoder_val_rmse_orig': 1.27412355664307, 'encoder_test_rmse_all': 0.9227651507752029, 'encoder_test_rmse_orig': 0.6850802267183501, 'encoder_test_rmse_last': 0.8280224645735125, 'decoder_val_rmse_all': 0.3257615047436679, 'decoder_val_rmse_orig': 0.3257615047436678, 'decoder_test_rmse_2-step': 0.8405281519795239, 'decoder_test_rmse_3-step': 0.8872386409324983, 'decoder_test_rmse_4-step': 0.9490116094912718, 'decoder_test_rmse_5-step': 1.0342244575451855, 'decoder_test_rmse_6-step': 1.1331804225677744, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 265.3586450359944, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:51:13,483,483 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 4, 2.0)
MainProcess| 2023-05-14 22:51:13,485,485 multiprocessing INFO Running EQ_5_A sindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:51:13,530,530 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:51:27,974,974 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 14.48879213800683, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:51:27,975,975 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 4, 2.0)
MainProcess| 2023-05-14 22:51:27,977,977 multiprocessing INFO Running EQ_5_A crn 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:51:28,026,26 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:56:18,243,243 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8522956424894201, 'encoder_val_rmse_orig': 0.8244568858635414, 'encoder_test_rmse_all': 0.9337759431631067, 'encoder_test_rmse_orig': 0.6778740504301529, 'encoder_test_rmse_last': 0.7969244598761434, 'decoder_val_rmse_all': 0.3350918982779268, 'decoder_val_rmse_orig': 0.33509189827792707, 'decoder_test_rmse_2-step': 0.7940125273696144, 'decoder_test_rmse_3-step': 0.8581910005078361, 'decoder_test_rmse_4-step': 0.9269368158592929, 'decoder_test_rmse_5-step': 0.988335728126207, 'decoder_test_rmse_6-step': 1.0174955994899315, 'method': 'crn', 'seed': 4, 'seconds_taken': 290.2652545960009, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:56:18,243,243 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 4, 2.0)
MainProcess| 2023-05-14 22:56:18,246,246 multiprocessing INFO Running EQ_5_A msm 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:56:18,294,294 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 22:56:28,850,850 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 4, 'seconds_taken': 10.604422380994947, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 22:56:28,850,850 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 4, 2.0)
MainProcess| 2023-05-14 22:56:28,853,853 multiprocessing INFO Running EQ_5_A gnet 4 | domain_conf=2.0
MainProcess| 2023-05-14 22:56:28,901,901 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:01:06,271,271 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.939677162905996, 'encoder_val_rmse_orig': 0.9091983882465561, 'encoder_test_rmse_all': 1.0142339887923841, 'encoder_test_rmse_orig': 0.7356004752532284, 'encoder_test_rmse_last': 0.953576530526018, 'decoder_val_rmse_all': 0.939677162905996, 'decoder_val_rmse_orig': 0.9091983882465561, 'decoder_test_rmse_2-step': 1.142761841215204, 'decoder_test_rmse_3-step': 1.4186510058170372, 'decoder_test_rmse_4-step': 1.70052086370621, 'decoder_test_rmse_5-step': 1.9855819192432018, 'decoder_test_rmse_6-step': 2.288037632089599, 'method': 'gnet', 'seed': 4, 'seconds_taken': 277.4172968760031, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:01:06,271,271 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 4, 2.0)
MainProcess| 2023-05-14 23:01:06,274,274 multiprocessing INFO Running EQ_5_A ct 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:01:06,324,324 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:01:55,138,138 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9800473199291034, 'encoder_val_rmse_orig': 0.9479303994670141, 'encoder_test_rmse_all': 1.230534512350586, 'encoder_test_rmse_orig': 0.9021524566216907, 'encoder_test_rmse_last': 1.140911034423145, 'decoder_val_rmse_all': 0.9800473199291034, 'decoder_val_rmse_orig': 0.9479303994670141, 'decoder_test_rmse_2-step': 1.0973969077866537, 'decoder_test_rmse_3-step': 1.283754230942169, 'decoder_test_rmse_4-step': 1.4264503856402175, 'decoder_test_rmse_5-step': 1.495673111582583, 'decoder_test_rmse_6-step': 1.5363691750792448, 'method': 'ct', 'seed': 4, 'seconds_taken': 48.86440069499804, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:01:55,138,138 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 4, 2.0)
MainProcess| 2023-05-14 23:01:55,141,141 multiprocessing INFO Running EQ_5_A rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:01:55,197,197 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:06:24,686,686 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7702187682707483, 'propensity_treatment_val_bce_orig': 0.7701791033353144, 'propensity_treatment_test_bce_all': 0.7640794840058284, 'propensity_treatment_test_bce_orig': 0.7640884453516398, 'propensity_history_val_bce_all': 0.7597774207234187, 'propensity_history_val_bce_orig': 0.7597991678886048, 'propensity_history_test_bce_all': 0.7579954298141326, 'propensity_history_test_bce_orig': 0.7572620462149465, 'encoder_val_rmse_all': 1.4110121792539179, 'encoder_val_rmse_orig': 1.3633681638665216, 'encoder_test_rmse_all': 1.429670938077259, 'encoder_test_rmse_orig': 1.0302399595993164, 'encoder_test_rmse_last': 1.1956393462490509, 'decoder_val_rmse_all': 0.26041920903622356, 'decoder_val_rmse_orig': 0.2604192090362234, 'decoder_test_rmse_2-step': 1.0790815015445372, 'decoder_test_rmse_3-step': 1.0788577391475838, 'decoder_test_rmse_4-step': 1.1224680033663723, 'decoder_test_rmse_5-step': 1.1624504885239484, 'decoder_test_rmse_6-step': 1.1808118179485816, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 269.5444971850011, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:07:59,881,881 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 4, 2.0)
MainProcess| 2023-05-14 23:07:59,884,884 multiprocessing INFO Running EQ_5_B sindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:07:59,933,933 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:08:13,608,608 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 13.723381730997062, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:08:13,608,608 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 4, 2.0)
MainProcess| 2023-05-14 23:08:13,611,611 multiprocessing INFO Running EQ_5_B crn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:08:13,664,664 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:13:03,430,430 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8522680653101959, 'encoder_val_rmse_orig': 0.8244303333054691, 'encoder_test_rmse_all': 0.9337776964604808, 'encoder_test_rmse_orig': 0.6778757280123171, 'encoder_test_rmse_last': 0.7969356377393004, 'decoder_val_rmse_all': 0.3350853967256259, 'decoder_val_rmse_orig': 0.33508539672562565, 'decoder_test_rmse_2-step': 0.7940134308788321, 'decoder_test_rmse_3-step': 0.8581954382985306, 'decoder_test_rmse_4-step': 0.9269338207855572, 'decoder_test_rmse_5-step': 0.9883326035919867, 'decoder_test_rmse_6-step': 1.0174933227354082, 'method': 'crn', 'seed': 4, 'seconds_taken': 289.8187668680039, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:13:03,430,430 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 4, 2.0)
MainProcess| 2023-05-14 23:13:03,433,433 multiprocessing INFO Running EQ_5_B msm 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:13:03,480,480 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:13:13,967,967 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 4, 'seconds_taken': 10.534682688994508, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:13:13,968,968 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 4, 2.0)
MainProcess| 2023-05-14 23:13:13,970,970 multiprocessing INFO Running EQ_5_B gnet 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:13:14,018,18 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:17:53,116,116 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9396495975060273, 'encoder_val_rmse_orig': 0.9091716501967386, 'encoder_test_rmse_all': 1.0142359691446259, 'encoder_test_rmse_orig': 0.7356024889828345, 'encoder_test_rmse_last': 0.9535654591715733, 'decoder_val_rmse_all': 0.9396495975060273, 'decoder_val_rmse_orig': 0.9091716501967386, 'decoder_test_rmse_2-step': 1.142766905784051, 'decoder_test_rmse_3-step': 1.4186813171697474, 'decoder_test_rmse_4-step': 1.7005376974373283, 'decoder_test_rmse_5-step': 1.9855948838075357, 'decoder_test_rmse_6-step': 2.28804155882587, 'method': 'gnet', 'seed': 4, 'seconds_taken': 279.1449541780021, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:17:53,116,116 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 4, 2.0)
MainProcess| 2023-05-14 23:17:53,118,118 multiprocessing INFO Running EQ_5_B ct 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:17:53,168,168 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:18:41,812,812 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9852083307296138, 'encoder_val_rmse_orig': 0.9529498918862906, 'encoder_test_rmse_all': 1.248405086431653, 'encoder_test_rmse_orig': 0.914756545606225, 'encoder_test_rmse_last': 1.1539309002634917, 'decoder_val_rmse_all': 0.9852083307296138, 'decoder_val_rmse_orig': 0.9529498918862906, 'decoder_test_rmse_2-step': 1.1085023361396023, 'decoder_test_rmse_3-step': 1.307299386703761, 'decoder_test_rmse_4-step': 1.4662888730167962, 'decoder_test_rmse_5-step': 1.5547898464632524, 'decoder_test_rmse_6-step': 1.6146115748139491, 'method': 'ct', 'seed': 4, 'seconds_taken': 48.692950819000544, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:18:41,812,812 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 4, 2.0)
MainProcess| 2023-05-14 23:18:41,814,814 multiprocessing INFO Running EQ_5_B rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:18:41,869,869 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:23:09,433,433 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7702187682707483, 'propensity_treatment_val_bce_orig': 0.7701791033353144, 'propensity_treatment_test_bce_all': 0.7640794840058284, 'propensity_treatment_test_bce_orig': 0.7640884453516398, 'propensity_history_val_bce_all': 0.7604606996856431, 'propensity_history_val_bce_orig': 0.7604835788605839, 'propensity_history_test_bce_all': 0.7586202351661294, 'propensity_history_test_bce_orig': 0.7578937217895935, 'encoder_val_rmse_all': 1.4107990976313278, 'encoder_val_rmse_orig': 1.3631594169737227, 'encoder_test_rmse_all': 1.4291286539943122, 'encoder_test_rmse_orig': 1.029820492086648, 'encoder_test_rmse_last': 1.194614283530126, 'decoder_val_rmse_all': 0.26042522051907435, 'decoder_val_rmse_orig': 0.26042522051907446, 'decoder_test_rmse_2-step': 1.0772080373250723, 'decoder_test_rmse_3-step': 1.0757570234159413, 'decoder_test_rmse_4-step': 1.1182882181778684, 'decoder_test_rmse_5-step': 1.1566459762614918, 'decoder_test_rmse_6-step': 1.1732437041612365, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 267.6184815000015, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:24:47,058,58 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 4, 2.0)
MainProcess| 2023-05-14 23:24:47,061,61 multiprocessing INFO Running EQ_5_C sindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:24:47,104,104 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:25:00,893,893 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 13.832186842999363, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:25:00,893,893 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 4, 2.0)
MainProcess| 2023-05-14 23:25:00,896,896 multiprocessing INFO Running EQ_5_C crn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:25:00,946,946 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:29:54,624,624 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5835817486003674, 'encoder_val_rmse_orig': 0.5679998059216523, 'encoder_test_rmse_all': 0.8321144674380956, 'encoder_test_rmse_orig': 0.6083213769249087, 'encoder_test_rmse_last': 0.8310332204074348, 'decoder_val_rmse_all': 0.33353819333405876, 'decoder_val_rmse_orig': 0.3335381933340587, 'decoder_test_rmse_2-step': 0.8194169907739375, 'decoder_test_rmse_3-step': 0.8806349465866957, 'decoder_test_rmse_4-step': 0.9524607560835804, 'decoder_test_rmse_5-step': 1.0307196104580467, 'decoder_test_rmse_6-step': 1.1105011365494113, 'method': 'crn', 'seed': 4, 'seconds_taken': 293.7274362219978, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:29:54,624,624 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 4, 2.0)
MainProcess| 2023-05-14 23:29:54,628,628 multiprocessing INFO Running EQ_5_C msm 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:29:54,676,676 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:30:05,229,229 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 4, 'seconds_taken': 10.600388125996687, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:30:05,229,229 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 4, 2.0)
MainProcess| 2023-05-14 23:30:05,232,232 multiprocessing INFO Running EQ_5_C gnet 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:30:05,277,277 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:34:37,559,559 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5560652340065129, 'encoder_val_rmse_orig': 0.5410584900663445, 'encoder_test_rmse_all': 0.7803603974026967, 'encoder_test_rmse_orig': 0.5730603341470474, 'encoder_test_rmse_last': 0.9172128482426088, 'decoder_val_rmse_all': 0.5560652340065129, 'decoder_val_rmse_orig': 0.5410584900663445, 'decoder_test_rmse_2-step': 0.9186768659078227, 'decoder_test_rmse_3-step': 0.9905206885415555, 'decoder_test_rmse_4-step': 1.0141461805375882, 'decoder_test_rmse_5-step': 1.0169035357823482, 'decoder_test_rmse_6-step': 1.011377600931295, 'method': 'gnet', 'seed': 4, 'seconds_taken': 272.326974040996, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:34:37,559,559 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 4, 2.0)
MainProcess| 2023-05-14 23:34:37,562,562 multiprocessing INFO Running EQ_5_C ct 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:34:37,612,612 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:35:26,756,756 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7273955966534168, 'encoder_val_rmse_orig': 0.7080879223358449, 'encoder_test_rmse_all': 1.280675222162846, 'encoder_test_rmse_orig': 0.9274901072346315, 'encoder_test_rmse_last': 1.1751354087197967, 'decoder_val_rmse_all': 0.7273955966534168, 'decoder_val_rmse_orig': 0.7080879223358449, 'decoder_test_rmse_2-step': 1.2032784191110721, 'decoder_test_rmse_3-step': 1.1579728980896498, 'decoder_test_rmse_4-step': 1.1543798900471902, 'decoder_test_rmse_5-step': 1.1339159134080024, 'decoder_test_rmse_6-step': 1.0861438380383506, 'method': 'ct', 'seed': 4, 'seconds_taken': 49.19455098199978, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:35:26,757,757 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 4, 2.0)
MainProcess| 2023-05-14 23:35:26,759,759 multiprocessing INFO Running EQ_5_C rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:35:26,815,815 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:39:54,853,853 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7704946410628117, 'propensity_treatment_val_bce_orig': 0.7705102091313615, 'propensity_treatment_test_bce_all': 0.7576104042416126, 'propensity_treatment_test_bce_orig': 0.7614205445286542, 'propensity_history_val_bce_all': 0.7623436465637088, 'propensity_history_val_bce_orig': 0.7623979905986088, 'propensity_history_test_bce_all': 0.7524103076898879, 'propensity_history_test_bce_orig': 0.755471585019531, 'encoder_val_rmse_all': 1.2082298814444192, 'encoder_val_rmse_orig': 1.1746251998126034, 'encoder_test_rmse_all': 1.1859000341548624, 'encoder_test_rmse_orig': 0.8655566747784661, 'encoder_test_rmse_last': 1.151622341522516, 'decoder_val_rmse_all': 0.28819967192295953, 'decoder_val_rmse_orig': 0.2881996719229595, 'decoder_test_rmse_2-step': 0.962355070335544, 'decoder_test_rmse_3-step': 0.9331868371594924, 'decoder_test_rmse_4-step': 0.9001834056394955, 'decoder_test_rmse_5-step': 0.8712350014978468, 'decoder_test_rmse_6-step': 0.8406483382419169, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 268.0935206730064, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:41:30,216,216 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 4, 2.0)
MainProcess| 2023-05-14 23:41:30,219,219 multiprocessing INFO Running EQ_5_D sindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:41:30,272,272 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:41:43,924,924 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 13.704860072000884, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:41:43,924,924 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 4, 2.0)
MainProcess| 2023-05-14 23:41:43,927,927 multiprocessing INFO Running EQ_5_D crn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:41:43,978,978 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:46:36,284,284 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6383461696270755, 'encoder_val_rmse_orig': 0.627797835543497, 'encoder_test_rmse_all': 0.8539874260618017, 'encoder_test_rmse_orig': 0.6163963858983268, 'encoder_test_rmse_last': 0.7557274976489191, 'decoder_val_rmse_all': 0.37975845416767706, 'decoder_val_rmse_orig': 0.37975845416767684, 'decoder_test_rmse_2-step': 0.952211754543895, 'decoder_test_rmse_3-step': 1.0107220934362207, 'decoder_test_rmse_4-step': 1.0468401057368095, 'decoder_test_rmse_5-step': 1.0751462083709096, 'decoder_test_rmse_6-step': 1.0876054550217875, 'method': 'crn', 'seed': 4, 'seconds_taken': 292.3571264339989, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:46:36,284,284 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 4, 2.0)
MainProcess| 2023-05-14 23:46:36,288,288 multiprocessing INFO Running EQ_5_D msm 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:46:36,335,335 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:46:46,623,623 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 4, 'seconds_taken': 10.334288589998323, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:46:46,623,623 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 4, 2.0)
MainProcess| 2023-05-14 23:46:46,626,626 multiprocessing INFO Running EQ_5_D gnet 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:46:46,670,670 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:51:17,522,522 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.67769785593083, 'encoder_val_rmse_orig': 0.667631489768198, 'encoder_test_rmse_all': 0.7170911490203797, 'encoder_test_rmse_orig': 0.5194021095617786, 'encoder_test_rmse_last': 0.7006739677111883, 'decoder_val_rmse_all': 0.67769785593083, 'decoder_val_rmse_orig': 0.667631489768198, 'decoder_test_rmse_2-step': 1.0286408610672018, 'decoder_test_rmse_3-step': 1.2280140997213602, 'decoder_test_rmse_4-step': 1.2836382982640564, 'decoder_test_rmse_5-step': 1.2930355365816035, 'decoder_test_rmse_6-step': 1.2602807359107422, 'method': 'gnet', 'seed': 4, 'seconds_taken': 270.8957785090024, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:51:17,522,522 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 4, 2.0)
MainProcess| 2023-05-14 23:51:17,525,525 multiprocessing INFO Running EQ_5_D ct 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:51:17,574,574 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:52:06,086,86 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8558106633863716, 'encoder_val_rmse_orig': 0.841420919148578, 'encoder_test_rmse_all': 1.2599574158794857, 'encoder_test_rmse_orig': 0.9091041816506504, 'encoder_test_rmse_last': 1.117219515119123, 'decoder_val_rmse_all': 0.8558106633863716, 'decoder_val_rmse_orig': 0.841420919148578, 'decoder_test_rmse_2-step': 1.3425893556898134, 'decoder_test_rmse_3-step': 1.3558043852266006, 'decoder_test_rmse_4-step': 1.2801869745988943, 'decoder_test_rmse_5-step': 1.2612870086563908, 'decoder_test_rmse_6-step': 1.216312607836934, 'method': 'ct', 'seed': 4, 'seconds_taken': 48.560596522002015, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:52:06,086,86 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 4, 2.0)
MainProcess| 2023-05-14 23:52:06,089,89 multiprocessing INFO Running EQ_5_D rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:52:06,141,141 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:56:34,444,444 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7708761709056019, 'propensity_treatment_val_bce_orig': 0.7708785469341088, 'propensity_treatment_test_bce_all': 0.7581841442647316, 'propensity_treatment_test_bce_orig': 0.7625024697010797, 'propensity_history_val_bce_all': 0.7615185804364546, 'propensity_history_val_bce_orig': 0.7615515324899416, 'propensity_history_test_bce_all': 0.7534860109773128, 'propensity_history_test_bce_orig': 0.7566036267055098, 'encoder_val_rmse_all': 1.2010310000337296, 'encoder_val_rmse_orig': 1.178984742388506, 'encoder_test_rmse_all': 1.2462799122484058, 'encoder_test_rmse_orig': 0.8971802668575983, 'encoder_test_rmse_last': 1.1021486656010688, 'decoder_val_rmse_all': 0.3378834430313571, 'decoder_val_rmse_orig': 0.3378834430313571, 'decoder_test_rmse_2-step': 1.2154472513847578, 'decoder_test_rmse_3-step': 1.1782764678163093, 'decoder_test_rmse_4-step': 1.1397508997454542, 'decoder_test_rmse_5-step': 1.1204430813508657, 'decoder_test_rmse_6-step': 1.0950961623031046, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 268.3547416049987, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:58:01,980,980 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 4, 2.0)
MainProcess| 2023-05-14 23:58:01,982,982 multiprocessing INFO Running EQ_4_A sindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:58:02,032,32 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:58:05,532,532 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 3.5493989840033464, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:58:05,532,532 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 4, 2.0)
MainProcess| 2023-05-14 23:58:05,535,535 multiprocessing INFO Running EQ_4_A wsindy 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:58:05,585,585 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-14 23:58:11,122,122 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13164076259620813, 'encoder_test_rmse_orig': 0.11134350941288478, 'encoder_test_rmse_last': 0.11134675756528901, 'decoder_test_rmse_2-step': 0.11126106373279133, 'decoder_test_rmse_3-step': 0.11090444884143753, 'decoder_test_rmse_4-step': 0.11019730186692049, 'decoder_test_rmse_5-step': 0.10911326754083943, 'decoder_test_rmse_6-step': 0.10765795715772442, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084002453417036*x0*u0 | Treatment 1: x_dot = +-1.0084000879007493*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 4, 'seconds_taken': 5.586687700997572, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-14 23:58:11,122,122 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 4, 2.0)
MainProcess| 2023-05-14 23:58:11,125,125 multiprocessing INFO Running EQ_4_A crn 4 | domain_conf=2.0
MainProcess| 2023-05-14 23:58:11,169,169 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:03:11,591,591 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2693104350185271, 'encoder_val_rmse_orig': 1.2693104350185274, 'encoder_test_rmse_all': 0.92982508722028, 'encoder_test_rmse_orig': 1.2697264943247637, 'encoder_test_rmse_last': 1.301750295762887, 'decoder_val_rmse_all': 0.41827119923327605, 'decoder_val_rmse_orig': 0.4182711992332762, 'decoder_test_rmse_2-step': 1.0615185113286512, 'decoder_test_rmse_3-step': 1.0312939782440118, 'decoder_test_rmse_4-step': 0.9981289020095409, 'decoder_test_rmse_5-step': 0.9543010532016755, 'decoder_test_rmse_6-step': 0.9134718610881195, 'method': 'crn', 'seed': 4, 'seconds_taken': 300.46584389000054, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:03:11,591,591 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 4, 2.0)
MainProcess| 2023-05-15 00:03:11,594,594 multiprocessing INFO Running EQ_4_A msm 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:03:11,641,641 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:03:17,090,90 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 4, 'seconds_taken': 5.495898193999892, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:03:17,090,90 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 4, 2.0)
MainProcess| 2023-05-15 00:03:17,093,93 multiprocessing INFO Running EQ_4_A gnet 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:03:17,139,139 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:07:31,455,455 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.35570381924479205, 'encoder_val_rmse_orig': 0.355703819244792, 'encoder_test_rmse_all': 0.344702268968547, 'encoder_test_rmse_orig': 0.3580545803248604, 'encoder_test_rmse_last': 0.3809682018829688, 'decoder_val_rmse_all': 0.35570381924479205, 'decoder_val_rmse_orig': 0.355703819244792, 'decoder_test_rmse_2-step': 0.484297769820284, 'decoder_test_rmse_3-step': 0.5378392407067255, 'decoder_test_rmse_4-step': 0.5834279549804297, 'decoder_test_rmse_5-step': 0.6186910353724255, 'decoder_test_rmse_6-step': 0.64631613474557, 'method': 'gnet', 'seed': 4, 'seconds_taken': 254.3622278000039, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:07:31,455,455 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 4, 2.0)
MainProcess| 2023-05-15 00:07:31,458,458 multiprocessing INFO Running EQ_4_A ct 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:07:31,507,507 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:08:19,736,736 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.2910569170409119, 'encoder_val_rmse_orig': 0.2910569170409119, 'encoder_test_rmse_all': 0.35567218448659205, 'encoder_test_rmse_orig': 0.2942084511168729, 'encoder_test_rmse_last': 0.38008172039372057, 'decoder_val_rmse_all': 0.2910569170409119, 'decoder_val_rmse_orig': 0.2910569170409119, 'decoder_test_rmse_2-step': 0.39793845712782433, 'decoder_test_rmse_3-step': 0.6350819078493569, 'decoder_test_rmse_4-step': 0.7070097627947785, 'decoder_test_rmse_5-step': 0.7336936507918832, 'decoder_test_rmse_6-step': 0.7875522141035938, 'method': 'ct', 'seed': 4, 'seconds_taken': 48.27726341900416, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:08:19,736,736 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 4, 2.0)
MainProcess| 2023-05-15 00:08:19,738,738 multiprocessing INFO Running EQ_4_A rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:08:19,793,793 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:12:58,425,425 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4945114783614369, 'propensity_treatment_val_bce_orig': 0.49451147836143694, 'propensity_treatment_test_bce_all': 0.5082264995288714, 'propensity_treatment_test_bce_orig': 0.5156155466317083, 'propensity_history_val_bce_all': 0.49208854393433715, 'propensity_history_val_bce_orig': 0.49208854393433715, 'propensity_history_test_bce_all': 0.5048231061622921, 'propensity_history_test_bce_orig': 0.513344791760839, 'encoder_val_rmse_all': 2.6680613031775904, 'encoder_val_rmse_orig': 2.66806130317759, 'encoder_test_rmse_all': 3.729953175680265, 'encoder_test_rmse_orig': 2.6733880772401277, 'encoder_test_rmse_last': 2.864538922611758, 'decoder_val_rmse_all': 0.30835925933305997, 'decoder_val_rmse_orig': 0.30835925933305997, 'decoder_test_rmse_2-step': 2.2333178449595454, 'decoder_test_rmse_3-step': 2.0605163212134974, 'decoder_test_rmse_4-step': 1.9230177561620239, 'decoder_test_rmse_5-step': 1.8035027532836194, 'decoder_test_rmse_6-step': 1.7077539505918928, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 278.68624979499873, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:14:24,356,356 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 4, 2.0)
MainProcess| 2023-05-15 00:14:24,359,359 multiprocessing INFO Running EQ_4_B sindy 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:14:24,410,410 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:14:27,834,834 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 3.4745697999969707, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:14:27,834,834 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 4, 2.0)
MainProcess| 2023-05-15 00:14:27,837,837 multiprocessing INFO Running EQ_4_B wsindy 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:14:27,887,887 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:14:33,276,276 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13424372406320348, 'encoder_test_rmse_orig': 0.11399005850220664, 'encoder_test_rmse_last': 0.11408459459909548, 'decoder_test_rmse_2-step': 0.1139131844757314, 'decoder_test_rmse_3-step': 0.11363343530462354, 'decoder_test_rmse_4-step': 0.11298787871153813, 'decoder_test_rmse_5-step': 0.1117263275605656, 'decoder_test_rmse_6-step': 0.11029380131178591, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084513973583646*x0*u0 | Treatment 1: x_dot = +-1.0084621505219564*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 4, 'seconds_taken': 5.439343849997385, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:14:33,276,276 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 4, 2.0)
MainProcess| 2023-05-15 00:14:33,279,279 multiprocessing INFO Running EQ_4_B crn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:14:33,329,329 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:19:34,835,835 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.294226077243177, 'encoder_val_rmse_orig': 1.2942260772431768, 'encoder_test_rmse_all': 0.9461510695110635, 'encoder_test_rmse_orig': 1.294928212378086, 'encoder_test_rmse_last': 1.3288038470683852, 'decoder_val_rmse_all': 0.4260439781154676, 'decoder_val_rmse_orig': 0.42604397811546735, 'decoder_test_rmse_2-step': 1.0705671383143012, 'decoder_test_rmse_3-step': 1.0573374512824312, 'decoder_test_rmse_4-step': 1.026897849419678, 'decoder_test_rmse_5-step': 0.9812387138388948, 'decoder_test_rmse_6-step': 0.938403269624878, 'method': 'crn', 'seed': 4, 'seconds_taken': 301.55560484899615, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:19:34,835,835 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 4, 2.0)
MainProcess| 2023-05-15 00:19:34,838,838 multiprocessing INFO Running EQ_4_B msm 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:19:34,883,883 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:19:40,320,320 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 4, 'seconds_taken': 5.481787718003034, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:19:40,320,320 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 4, 2.0)
MainProcess| 2023-05-15 00:19:40,323,323 multiprocessing INFO Running EQ_4_B gnet 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:19:40,373,373 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:23:55,476,476 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3568549799085472, 'encoder_val_rmse_orig': 0.3568549799085472, 'encoder_test_rmse_all': 0.3456269772349893, 'encoder_test_rmse_orig': 0.3592026156934557, 'encoder_test_rmse_last': 0.38187737672900895, 'decoder_val_rmse_all': 0.3568549799085472, 'decoder_val_rmse_orig': 0.3568549799085472, 'decoder_test_rmse_2-step': 0.48540935645796796, 'decoder_test_rmse_3-step': 0.5390016991199212, 'decoder_test_rmse_4-step': 0.5845977584440166, 'decoder_test_rmse_5-step': 0.619692927053271, 'decoder_test_rmse_6-step': 0.6474764357211404, 'method': 'gnet', 'seed': 4, 'seconds_taken': 255.1529979879997, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:23:55,476,476 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 4, 2.0)
MainProcess| 2023-05-15 00:23:55,479,479 multiprocessing INFO Running EQ_4_B ct 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:23:55,530,530 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:24:45,211,211 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.29133905090766304, 'encoder_val_rmse_orig': 0.29133905090766304, 'encoder_test_rmse_all': 0.35500684398895366, 'encoder_test_rmse_orig': 0.2942289180702908, 'encoder_test_rmse_last': 0.3794635996567779, 'decoder_val_rmse_all': 0.29133905090766304, 'decoder_val_rmse_orig': 0.29133905090766304, 'decoder_test_rmse_2-step': 0.3977589315921042, 'decoder_test_rmse_3-step': 0.6347060856668458, 'decoder_test_rmse_4-step': 0.7071309390825583, 'decoder_test_rmse_5-step': 0.7337741021091037, 'decoder_test_rmse_6-step': 0.7879411911965623, 'method': 'ct', 'seed': 4, 'seconds_taken': 49.732283625999116, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:24:45,211,211 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 4, 2.0)
MainProcess| 2023-05-15 00:24:45,214,214 multiprocessing INFO Running EQ_4_B rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:24:45,269,269 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:29:25,279,279 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4945114783614369, 'propensity_treatment_val_bce_orig': 0.49451147836143694, 'propensity_treatment_test_bce_all': 0.5082264995288714, 'propensity_treatment_test_bce_orig': 0.5156155466317083, 'propensity_history_val_bce_all': 0.4920149636672715, 'propensity_history_val_bce_orig': 0.49201496366727154, 'propensity_history_test_bce_all': 0.5046928909109474, 'propensity_history_test_bce_orig': 0.5132732007645052, 'encoder_val_rmse_all': 2.6456736010691015, 'encoder_val_rmse_orig': 2.645673601069101, 'encoder_test_rmse_all': 3.6991905300428787, 'encoder_test_rmse_orig': 2.6508601221058607, 'encoder_test_rmse_last': 2.84011068255399, 'decoder_val_rmse_all': 0.30142019594298924, 'decoder_val_rmse_orig': 0.30142019594298936, 'decoder_test_rmse_2-step': 2.2461265866431455, 'decoder_test_rmse_3-step': 2.0678871325946546, 'decoder_test_rmse_4-step': 1.9311008446889595, 'decoder_test_rmse_5-step': 1.8178187213067334, 'decoder_test_rmse_6-step': 1.7316739376200616, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 280.0643789659953, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:30:52,840,840 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 4, 2.0)
MainProcess| 2023-05-15 00:30:52,843,843 multiprocessing INFO Running EQ_4_C sindy 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:30:52,892,892 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:30:56,584,584 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 3.7405411069994443, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:30:56,584,584 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 4, 2.0)
MainProcess| 2023-05-15 00:30:56,587,587 multiprocessing INFO Running EQ_4_C wsindy 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:30:56,637,637 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:31:02,274,274 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.14783892747359578, 'encoder_test_rmse_orig': 0.12053850492728052, 'encoder_test_rmse_last': 0.12052428960657628, 'decoder_test_rmse_2-step': 0.12024258322260394, 'decoder_test_rmse_3-step': 0.11957402377167879, 'decoder_test_rmse_4-step': 0.11834623610205075, 'decoder_test_rmse_5-step': 0.11628111760129457, 'decoder_test_rmse_6-step': 0.11391730645205844, 'global_equation_string': 'Treatment 0: x_dot = +-0.045561415245346897*x0+-1.018667625335545*x0*u0 | Treatment 1: x_dot = +-0.1461396198723221*x0+-1.0217735521863822*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 4, 'seconds_taken': 5.686651358002564, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:31:02,274,274 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 4, 2.0)
MainProcess| 2023-05-15 00:31:02,277,277 multiprocessing INFO Running EQ_4_C crn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:31:02,329,329 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:36:05,212,212 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.4765492513702823, 'encoder_val_rmse_orig': 1.476549251370282, 'encoder_test_rmse_all': 1.1188603051773764, 'encoder_test_rmse_orig': 1.476662333003943, 'encoder_test_rmse_last': 1.4812436895050247, 'decoder_val_rmse_all': 0.3331774971757196, 'decoder_val_rmse_orig': 0.3331774971757194, 'decoder_test_rmse_2-step': 1.3285624604604525, 'decoder_test_rmse_3-step': 1.0938024065987795, 'decoder_test_rmse_4-step': 1.0128709797070008, 'decoder_test_rmse_5-step': 1.003204824280645, 'decoder_test_rmse_6-step': 1.0353073615100612, 'method': 'crn', 'seed': 4, 'seconds_taken': 302.9350791329998, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:36:05,212,212 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 4, 2.0)
MainProcess| 2023-05-15 00:36:05,215,215 multiprocessing INFO Running EQ_4_C msm 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:36:05,262,262 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:36:10,802,802 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 4, 'seconds_taken': 5.586894733001827, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:36:10,802,802 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 4, 2.0)
MainProcess| 2023-05-15 00:36:10,805,805 multiprocessing INFO Running EQ_4_C gnet 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:36:10,851,851 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:40:27,763,763 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.35875153422877887, 'encoder_val_rmse_orig': 0.35875153422877887, 'encoder_test_rmse_all': 0.3442023964953534, 'encoder_test_rmse_orig': 0.36057208499755394, 'encoder_test_rmse_last': 0.37761370294476515, 'decoder_val_rmse_all': 0.35875153422877887, 'decoder_val_rmse_orig': 0.35875153422877887, 'decoder_test_rmse_2-step': 0.46261022890328674, 'decoder_test_rmse_3-step': 0.4963194580001728, 'decoder_test_rmse_4-step': 0.5216307564210367, 'decoder_test_rmse_5-step': 0.5392805499604397, 'decoder_test_rmse_6-step': 0.5519525414371804, 'method': 'gnet', 'seed': 4, 'seconds_taken': 256.9584370329976, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:40:27,763,763 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 4, 2.0)
MainProcess| 2023-05-15 00:40:27,766,766 multiprocessing INFO Running EQ_4_C ct 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:40:27,820,820 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:41:16,211,211 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.31767507887005203, 'encoder_val_rmse_orig': 0.317675078870052, 'encoder_test_rmse_all': 0.39872441995469105, 'encoder_test_rmse_orig': 0.31795160538028183, 'encoder_test_rmse_last': 0.33192788710701643, 'decoder_val_rmse_all': 0.31767507887005203, 'decoder_val_rmse_orig': 0.317675078870052, 'decoder_test_rmse_2-step': 0.364726991051363, 'decoder_test_rmse_3-step': 0.5029058617644273, 'decoder_test_rmse_4-step': 0.5643908884546627, 'decoder_test_rmse_5-step': 0.6045923241251062, 'decoder_test_rmse_6-step': 0.6461005007447106, 'method': 'ct', 'seed': 4, 'seconds_taken': 48.44457559299917, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:41:16,211,211 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 4, 2.0)
MainProcess| 2023-05-15 00:41:16,214,214 multiprocessing INFO Running EQ_4_C rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:41:16,269,269 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:45:56,474,474 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4945114783614369, 'propensity_treatment_val_bce_orig': 0.49451147836143694, 'propensity_treatment_test_bce_all': 0.5082264995288714, 'propensity_treatment_test_bce_orig': 0.5156155466317083, 'propensity_history_val_bce_all': 0.4920650295483864, 'propensity_history_val_bce_orig': 0.4920650295483864, 'propensity_history_test_bce_all': 0.5047886920504819, 'propensity_history_test_bce_orig': 0.5133222505132319, 'encoder_val_rmse_all': 2.6733219331597438, 'encoder_val_rmse_orig': 2.6733219331597433, 'encoder_test_rmse_all': 3.7415055440363374, 'encoder_test_rmse_orig': 2.6797415804468794, 'encoder_test_rmse_last': 2.92487575085658, 'decoder_val_rmse_all': 0.2268313875144657, 'decoder_val_rmse_orig': 0.22683138751446558, 'decoder_test_rmse_2-step': 2.3619397550658245, 'decoder_test_rmse_3-step': 2.113183525765202, 'decoder_test_rmse_4-step': 1.911880103471504, 'decoder_test_rmse_5-step': 1.7424274948054672, 'decoder_test_rmse_6-step': 1.6022613133719312, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 280.2603082969945, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:47:26,782,782 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 4, 2.0)
MainProcess| 2023-05-15 00:47:26,784,784 multiprocessing INFO Running EQ_4_D sindy 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:47:26,832,832 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:47:30,450,450 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 3.6649905099984608, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:47:30,450,450 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 4, 2.0)
MainProcess| 2023-05-15 00:47:30,453,453 multiprocessing INFO Running EQ_4_D wsindy 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:47:30,504,504 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:47:36,116,116 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.12068957362214526, 'encoder_test_rmse_orig': 0.1025735582318135, 'encoder_test_rmse_last': 0.10303961209206067, 'decoder_test_rmse_2-step': 0.10312742478061779, 'decoder_test_rmse_3-step': 0.10346151462812579, 'decoder_test_rmse_4-step': 0.10347622776615117, 'decoder_test_rmse_5-step': 0.10318298347520852, 'decoder_test_rmse_6-step': 0.10234788394486018, 'global_equation_string': 'Treatment 0: x_dot = +0.1979167808186778*x0+-1.0099648978214828*x0*u0 | Treatment 1: x_dot = +-0.09097061335694492*x0+-1.0201217229015003*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 4, 'seconds_taken': 5.662843091995455, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:47:36,116,116 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 4, 2.0)
MainProcess| 2023-05-15 00:47:36,119,119 multiprocessing INFO Running EQ_4_D crn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:47:36,170,170 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:52:39,446,446 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.3191009043851083, 'encoder_val_rmse_orig': 1.3191009043851083, 'encoder_test_rmse_all': 1.0791628310399801, 'encoder_test_rmse_orig': 1.3457754901101866, 'encoder_test_rmse_last': 1.5982958149444706, 'decoder_val_rmse_all': 0.6089793472619333, 'decoder_val_rmse_orig': 0.6089793472619333, 'decoder_test_rmse_2-step': 1.5161589907218356, 'decoder_test_rmse_3-step': 1.48847873327039, 'decoder_test_rmse_4-step': 1.5168764310988305, 'decoder_test_rmse_5-step': 1.5197321206660122, 'decoder_test_rmse_6-step': 1.522795117893266, 'method': 'crn', 'seed': 4, 'seconds_taken': 303.32744343899685, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:52:39,446,446 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 4, 2.0)
MainProcess| 2023-05-15 00:52:39,449,449 multiprocessing INFO Running EQ_4_D msm 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:52:39,497,497 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:52:44,874,874 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 4, 'seconds_taken': 5.42480657100532, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:52:44,874,874 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 4, 2.0)
MainProcess| 2023-05-15 00:52:44,878,878 multiprocessing INFO Running EQ_4_D gnet 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:52:44,927,927 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:57:04,613,613 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.47608885173713084, 'encoder_val_rmse_orig': 0.47608885173713084, 'encoder_test_rmse_all': 0.5467151925866809, 'encoder_test_rmse_orig': 0.4759601422081184, 'encoder_test_rmse_last': 0.4784120814979397, 'decoder_val_rmse_all': 0.47608885173713084, 'decoder_val_rmse_orig': 0.47608885173713084, 'decoder_test_rmse_2-step': 0.6515804881196178, 'decoder_test_rmse_3-step': 0.7930541445453281, 'decoder_test_rmse_4-step': 0.9226072095399891, 'decoder_test_rmse_5-step': 1.0348021253888955, 'decoder_test_rmse_6-step': 1.1301392336497884, 'method': 'gnet', 'seed': 4, 'seconds_taken': 259.73524308599735, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:57:04,614,614 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 4, 2.0)
MainProcess| 2023-05-15 00:57:04,616,616 multiprocessing INFO Running EQ_4_D ct 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:57:04,666,666 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 00:57:53,229,229 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3460342171978157, 'encoder_val_rmse_orig': 0.3460342171978157, 'encoder_test_rmse_all': 0.42758170203603485, 'encoder_test_rmse_orig': 0.37630936794768793, 'encoder_test_rmse_last': 0.6695690691921756, 'decoder_val_rmse_all': 0.3460342171978157, 'decoder_val_rmse_orig': 0.3460342171978157, 'decoder_test_rmse_2-step': 0.6833982807479891, 'decoder_test_rmse_3-step': 0.6344942902519064, 'decoder_test_rmse_4-step': 0.683574726219725, 'decoder_test_rmse_5-step': 0.7295191667708048, 'decoder_test_rmse_6-step': 0.7690137267096715, 'method': 'ct', 'seed': 4, 'seconds_taken': 48.61265557099978, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 00:57:53,229,229 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 4, 2.0)
MainProcess| 2023-05-15 00:57:53,232,232 multiprocessing INFO Running EQ_4_D rmsn 4 | domain_conf=2.0
MainProcess| 2023-05-15 00:57:53,287,287 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:02:34,939,939 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5021813182911631, 'propensity_treatment_val_bce_orig': 0.502181318291163, 'propensity_treatment_test_bce_all': 0.5156146190994877, 'propensity_treatment_test_bce_orig': 0.5224934623271817, 'propensity_history_val_bce_all': 0.49984706179570343, 'propensity_history_val_bce_orig': 0.4998470617957034, 'propensity_history_test_bce_all': 0.5123999265521596, 'propensity_history_test_bce_orig': 0.5203095539825829, 'encoder_val_rmse_all': 2.5807035978762127, 'encoder_val_rmse_orig': 2.5807035978762127, 'encoder_test_rmse_all': 3.601869241312473, 'encoder_test_rmse_orig': 2.588522748751787, 'encoder_test_rmse_last': 2.788833829695278, 'decoder_val_rmse_all': 0.2877359138091878, 'decoder_val_rmse_orig': 0.2877359138091878, 'decoder_test_rmse_2-step': 2.236700188092526, 'decoder_test_rmse_3-step': 2.0467604186849933, 'decoder_test_rmse_4-step': 1.9087993052344148, 'decoder_test_rmse_5-step': 1.8000077362705262, 'decoder_test_rmse_6-step': 1.7167789579089612, 'method': 'rmsn', 'seed': 4, 'seconds_taken': 281.7067593059983, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:03:58,424,424 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 01:03:58,427,427 multiprocessing INFO Running cancer_sim sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:03:58,477,477 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:04:11,662,662 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 13.23483736700291, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:04:11,662,662 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 5, 2.0)
MainProcess| 2023-05-15 01:04:11,665,665 multiprocessing INFO Running cancer_sim crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:04:11,716,716 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:09:03,001,1 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0973988797478793, 'encoder_val_rmse_orig': 1.051841349816785, 'encoder_test_rmse_all': 0.7726494487130152, 'encoder_test_rmse_orig': 0.5825317936740569, 'encoder_test_rmse_last': 0.7324542485434313, 'decoder_val_rmse_all': 0.3367991342818102, 'decoder_val_rmse_orig': 0.3367991342818104, 'decoder_test_rmse_2-step': 0.6900135335876536, 'decoder_test_rmse_3-step': 0.7714657354288501, 'decoder_test_rmse_4-step': 0.86891312182773, 'decoder_test_rmse_5-step': 0.9613031618216324, 'decoder_test_rmse_6-step': 1.0482579681693842, 'method': 'crn', 'seed': 5, 'seconds_taken': 291.33598197899846, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:09:03,001,1 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 5, 2.0)
MainProcess| 2023-05-15 01:09:03,004,4 multiprocessing INFO Running cancer_sim msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:09:03,053,53 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:09:13,956,956 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 5, 'seconds_taken': 10.95225511299941, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:09:13,957,957 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 01:09:13,959,959 multiprocessing INFO Running cancer_sim gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:09:14,008,8 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:13:39,998,998 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.11174991082524, 'encoder_val_rmse_orig': 1.0655908346880791, 'encoder_test_rmse_all': 0.7935156208554124, 'encoder_test_rmse_orig': 0.6023530148807966, 'encoder_test_rmse_last': 0.7282021336610593, 'decoder_val_rmse_all': 1.11174991082524, 'decoder_val_rmse_orig': 1.0655908346880791, 'decoder_test_rmse_2-step': 0.9938928374644296, 'decoder_test_rmse_3-step': 1.228435020220799, 'decoder_test_rmse_4-step': 1.3554892118022188, 'decoder_test_rmse_5-step': 1.4626886315466254, 'decoder_test_rmse_6-step': 1.5480803296783867, 'method': 'gnet', 'seed': 5, 'seconds_taken': 266.0386116949958, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:13:39,998,998 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 5, 2.0)
MainProcess| 2023-05-15 01:13:40,001,1 multiprocessing INFO Running cancer_sim ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:13:40,050,50 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:14:30,292,292 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0246290399110032, 'encoder_val_rmse_orig': 0.9830695310114484, 'encoder_test_rmse_all': 0.9281043962523426, 'encoder_test_rmse_orig': 0.702152961911375, 'encoder_test_rmse_last': 0.8337179456282046, 'decoder_val_rmse_all': 1.0246290399110032, 'decoder_val_rmse_orig': 0.9830695310114484, 'decoder_test_rmse_2-step': 0.9170472293906871, 'decoder_test_rmse_3-step': 0.8858539078051227, 'decoder_test_rmse_4-step': 0.918006118040094, 'decoder_test_rmse_5-step': 0.980489481801496, 'decoder_test_rmse_6-step': 1.0075123416259757, 'method': 'ct', 'seed': 5, 'seconds_taken': 50.29078449499502, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:14:30,292,292 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 01:14:30,295,295 multiprocessing INFO Running cancer_sim rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:14:30,347,347 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:18:57,623,623 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7682969431115539, 'propensity_treatment_val_bce_orig': 0.768166909060382, 'propensity_treatment_test_bce_all': 0.7601502177069165, 'propensity_treatment_test_bce_orig': 0.761888210920485, 'propensity_history_val_bce_all': 0.7607626724302802, 'propensity_history_val_bce_orig': 0.7608190255406253, 'propensity_history_test_bce_all': 0.7564450436778903, 'propensity_history_test_bce_orig': 0.7579414069228054, 'encoder_val_rmse_all': 1.2939520511222662, 'encoder_val_rmse_orig': 1.2401465281534998, 'encoder_test_rmse_all': 0.949623956932739, 'encoder_test_rmse_orig': 0.7132340991675108, 'encoder_test_rmse_last': 0.8502977477797977, 'decoder_val_rmse_all': 0.32650563685213474, 'decoder_val_rmse_orig': 0.32650563685213496, 'decoder_test_rmse_2-step': 0.8032992005251691, 'decoder_test_rmse_3-step': 0.8897041979849317, 'decoder_test_rmse_4-step': 0.9612412397270753, 'decoder_test_rmse_5-step': 1.0322021734111073, 'decoder_test_rmse_6-step': 1.1033753737496532, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 267.3280828930001, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:21:13,839,839 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 01:21:13,845,845 multiprocessing INFO Running EQ_5_A sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:21:13,898,898 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:21:27,538,538 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 13.693114895002509, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:21:27,538,538 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 5, 2.0)
MainProcess| 2023-05-15 01:21:27,541,541 multiprocessing INFO Running EQ_5_A crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:21:27,594,594 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:26:17,821,821 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8491026142011915, 'encoder_val_rmse_orig': 0.8213751353264489, 'encoder_test_rmse_all': 0.947063250953277, 'encoder_test_rmse_orig': 0.6866824589624819, 'encoder_test_rmse_last': 0.806070952309795, 'decoder_val_rmse_all': 0.3327206029739026, 'decoder_val_rmse_orig': 0.3327206029739025, 'decoder_test_rmse_2-step': 0.8024961464605707, 'decoder_test_rmse_3-step': 0.9131338386318605, 'decoder_test_rmse_4-step': 1.0102097564799872, 'decoder_test_rmse_5-step': 1.0813256501525548, 'decoder_test_rmse_6-step': 1.1012562191041897, 'method': 'crn', 'seed': 5, 'seconds_taken': 290.2796421710009, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:26:17,821,821 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 5, 2.0)
MainProcess| 2023-05-15 01:26:17,824,824 multiprocessing INFO Running EQ_5_A msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:26:17,870,870 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:26:28,286,286 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 5, 'seconds_taken': 10.461693539997214, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:26:28,286,286 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 01:26:28,289,289 multiprocessing INFO Running EQ_5_A gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:26:28,336,336 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:31:06,912,912 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8153835932462574, 'encoder_val_rmse_orig': 0.7889345596350837, 'encoder_test_rmse_all': 0.861798769480533, 'encoder_test_rmse_orig': 0.6253440848770135, 'encoder_test_rmse_last': 0.8621684969653345, 'decoder_val_rmse_all': 0.8153835932462574, 'decoder_val_rmse_orig': 0.7889345596350837, 'decoder_test_rmse_2-step': 0.8649262953369701, 'decoder_test_rmse_3-step': 1.0069536114601194, 'decoder_test_rmse_4-step': 1.093949049822175, 'decoder_test_rmse_5-step': 1.1714723583496136, 'decoder_test_rmse_6-step': 1.2257943864812644, 'method': 'gnet', 'seed': 5, 'seconds_taken': 278.62348520799424, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:31:06,912,912 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 5, 2.0)
MainProcess| 2023-05-15 01:31:06,915,915 multiprocessing INFO Running EQ_5_A ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:31:06,964,964 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:31:55,557,557 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0211831633487567, 'encoder_val_rmse_orig': 0.9878413551822802, 'encoder_test_rmse_all': 1.228243205031935, 'encoder_test_rmse_orig': 0.9110003319145384, 'encoder_test_rmse_last': 1.1776396306662855, 'decoder_val_rmse_all': 1.0211831633487567, 'decoder_val_rmse_orig': 0.9878413551822802, 'decoder_test_rmse_2-step': 1.1208149923288209, 'decoder_test_rmse_3-step': 1.2527648751624307, 'decoder_test_rmse_4-step': 1.322402599923619, 'decoder_test_rmse_5-step': 1.368801601524308, 'decoder_test_rmse_6-step': 1.342954818490875, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.641204701998504, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:31:55,557,557 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 01:31:55,560,560 multiprocessing INFO Running EQ_5_A rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:31:55,613,613 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:36:23,867,867 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7665694287869851, 'propensity_treatment_val_bce_orig': 0.7664778769174558, 'propensity_treatment_test_bce_all': 0.761076660201048, 'propensity_treatment_test_bce_orig': 0.7605288248226566, 'propensity_history_val_bce_all': 0.7595692122657016, 'propensity_history_val_bce_orig': 0.759636641573355, 'propensity_history_test_bce_all': 0.7583134711967148, 'propensity_history_test_bce_orig': 0.7575905247327952, 'encoder_val_rmse_all': 1.3747289891494368, 'encoder_val_rmse_orig': 1.3289370506309204, 'encoder_test_rmse_all': 1.3338324509370472, 'encoder_test_rmse_orig': 0.9667852866560723, 'encoder_test_rmse_last': 1.1903547906572796, 'decoder_val_rmse_all': 0.27868918633273176, 'decoder_val_rmse_orig': 0.27868918633273154, 'decoder_test_rmse_2-step': 1.0369941059957968, 'decoder_test_rmse_3-step': 1.0897114631079305, 'decoder_test_rmse_4-step': 1.148774460939004, 'decoder_test_rmse_5-step': 1.2242444774841594, 'decoder_test_rmse_6-step': 1.323098477735829, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 268.3067207600034, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:37:58,670,670 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 01:37:58,673,673 multiprocessing INFO Running EQ_5_B sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:37:58,725,725 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:38:12,520,520 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 13.84625430199958, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:38:12,520,520 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 5, 2.0)
MainProcess| 2023-05-15 01:38:12,523,523 multiprocessing INFO Running EQ_5_B crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:38:12,574,574 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:43:04,777,777 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8490798992220916, 'encoder_val_rmse_orig': 0.8213532474673089, 'encoder_test_rmse_all': 0.947062610091972, 'encoder_test_rmse_orig': 0.6866826067788694, 'encoder_test_rmse_last': 0.8060815189619205, 'decoder_val_rmse_all': 0.3327128124324939, 'decoder_val_rmse_orig': 0.33271281243249423, 'decoder_test_rmse_2-step': 0.8024933664764944, 'decoder_test_rmse_3-step': 0.9131276080446332, 'decoder_test_rmse_4-step': 1.0101966742724722, 'decoder_test_rmse_5-step': 1.0813109635838078, 'decoder_test_rmse_6-step': 1.1012419309685793, 'method': 'crn', 'seed': 5, 'seconds_taken': 292.25459211900306, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:43:04,777,777 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 5, 2.0)
MainProcess| 2023-05-15 01:43:04,780,780 multiprocessing INFO Running EQ_5_B msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:43:04,828,828 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:43:15,573,573 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 5, 'seconds_taken': 10.792210473999148, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:43:15,573,573 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 01:43:15,575,575 multiprocessing INFO Running EQ_5_B gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:43:15,622,622 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:47:51,702,702 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8153353266279457, 'encoder_val_rmse_orig': 0.7888878221966122, 'encoder_test_rmse_all': 0.8617828735918212, 'encoder_test_rmse_orig': 0.6253314672252366, 'encoder_test_rmse_last': 0.8621494479498313, 'decoder_val_rmse_all': 0.8153353266279457, 'decoder_val_rmse_orig': 0.7888878221966122, 'decoder_test_rmse_2-step': 0.864903598256469, 'decoder_test_rmse_3-step': 1.0069363868814125, 'decoder_test_rmse_4-step': 1.0939129589655379, 'decoder_test_rmse_5-step': 1.1714097405470234, 'decoder_test_rmse_6-step': 1.225703124028707, 'method': 'gnet', 'seed': 5, 'seconds_taken': 276.1260450450063, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:47:51,702,702 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 5, 2.0)
MainProcess| 2023-05-15 01:47:51,705,705 multiprocessing INFO Running EQ_5_B ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:47:51,754,754 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:48:40,677,677 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0270145407895332, 'encoder_val_rmse_orig': 0.9934651271143466, 'encoder_test_rmse_all': 1.2343453300883283, 'encoder_test_rmse_orig': 0.9149085035830534, 'encoder_test_rmse_last': 1.1840939931819325, 'decoder_val_rmse_all': 1.0270145407895332, 'decoder_val_rmse_orig': 0.9934651271143466, 'decoder_test_rmse_2-step': 1.1226583142650284, 'decoder_test_rmse_3-step': 1.2562443725795827, 'decoder_test_rmse_4-step': 1.32787544405098, 'decoder_test_rmse_5-step': 1.372502977695273, 'decoder_test_rmse_6-step': 1.3435096511076265, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.97176026299712, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:48:40,677,677 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 01:48:40,679,679 multiprocessing INFO Running EQ_5_B rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:48:40,733,733 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:53:10,721,721 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7665694287869851, 'propensity_treatment_val_bce_orig': 0.7664778769174558, 'propensity_treatment_test_bce_all': 0.761076660201048, 'propensity_treatment_test_bce_orig': 0.7605288248226566, 'propensity_history_val_bce_all': 0.7595640663962289, 'propensity_history_val_bce_orig': 0.7596344165989098, 'propensity_history_test_bce_all': 0.7584460148447384, 'propensity_history_test_bce_orig': 0.757666601804081, 'encoder_val_rmse_all': 1.3685440564017675, 'encoder_val_rmse_orig': 1.3229743352518915, 'encoder_test_rmse_all': 1.3219887374324455, 'encoder_test_rmse_orig': 0.9583882628616706, 'encoder_test_rmse_last': 1.1819870226320621, 'decoder_val_rmse_all': 0.28132791899344856, 'decoder_val_rmse_orig': 0.28132791899344867, 'decoder_test_rmse_2-step': 1.024975704897982, 'decoder_test_rmse_3-step': 1.085597059114221, 'decoder_test_rmse_4-step': 1.1601452325425188, 'decoder_test_rmse_5-step': 1.2490232764273244, 'decoder_test_rmse_6-step': 1.3625704945923178, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 270.0415639849962, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:54:47,002,2 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 01:54:47,005,5 multiprocessing INFO Running EQ_5_C sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:54:47,052,52 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:55:00,873,873 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 13.867844614003843, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:55:00,873,873 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 5, 2.0)
MainProcess| 2023-05-15 01:55:00,876,876 multiprocessing INFO Running EQ_5_C crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:55:00,928,928 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 01:59:53,608,608 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5844343964689788, 'encoder_val_rmse_orig': 0.568899519007104, 'encoder_test_rmse_all': 0.8406604462703144, 'encoder_test_rmse_orig': 0.6151588399537551, 'encoder_test_rmse_last': 0.8189773289682589, 'decoder_val_rmse_all': 0.3496098781882348, 'decoder_val_rmse_orig': 0.34960987818823447, 'decoder_test_rmse_2-step': 0.8024539802355979, 'decoder_test_rmse_3-step': 0.8397646546208223, 'decoder_test_rmse_4-step': 0.9138990217980938, 'decoder_test_rmse_5-step': 0.9952115838516924, 'decoder_test_rmse_6-step': 1.073299242479964, 'method': 'crn', 'seed': 5, 'seconds_taken': 292.73250487800397, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 01:59:53,608,608 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 5, 2.0)
MainProcess| 2023-05-15 01:59:53,611,611 multiprocessing INFO Running EQ_5_C msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 01:59:53,657,657 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:00:04,284,284 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 5, 'seconds_taken': 10.6729887689944, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:00:04,284,284 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 02:00:04,287,287 multiprocessing INFO Running EQ_5_C gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:00:04,332,332 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:04:44,776,776 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5771777286990054, 'encoder_val_rmse_orig': 0.56181375760262, 'encoder_test_rmse_all': 0.8250356124742462, 'encoder_test_rmse_orig': 0.6104628502187426, 'encoder_test_rmse_last': 0.960973615787699, 'decoder_val_rmse_all': 0.5771777286990054, 'decoder_val_rmse_orig': 0.56181375760262, 'decoder_test_rmse_2-step': 0.8377836240171334, 'decoder_test_rmse_3-step': 0.8986838692018557, 'decoder_test_rmse_4-step': 0.9269078964729189, 'decoder_test_rmse_5-step': 0.9403186578629361, 'decoder_test_rmse_6-step': 0.9406688481447243, 'method': 'gnet', 'seed': 5, 'seconds_taken': 280.4887816860064, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:04:44,776,776 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 5, 2.0)
MainProcess| 2023-05-15 02:04:44,779,779 multiprocessing INFO Running EQ_5_C ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:04:44,829,829 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:05:33,547,547 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7441136841852327, 'encoder_val_rmse_orig': 0.7243640658331283, 'encoder_test_rmse_all': 1.2106452045182525, 'encoder_test_rmse_orig': 0.8769318990948245, 'encoder_test_rmse_last': 1.1250324359660642, 'decoder_val_rmse_all': 0.7441136841852327, 'decoder_val_rmse_orig': 0.7243640658331283, 'decoder_test_rmse_2-step': 1.0097774993087743, 'decoder_test_rmse_3-step': 1.0528969433296012, 'decoder_test_rmse_4-step': 1.0508062759263441, 'decoder_test_rmse_5-step': 1.0471482535713157, 'decoder_test_rmse_6-step': 1.0199461013118576, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.76795900000434, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:05:33,547,547 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 02:05:33,550,550 multiprocessing INFO Running EQ_5_C rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:05:33,605,605 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:10:03,771,771 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7680158502503134, 'propensity_treatment_val_bce_orig': 0.7679845442847393, 'propensity_treatment_test_bce_all': 0.7554551977739327, 'propensity_treatment_test_bce_orig': 0.7588082163276074, 'propensity_history_val_bce_all': 0.7621289443009709, 'propensity_history_val_bce_orig': 0.762238027043111, 'propensity_history_test_bce_all': 0.7529097825547574, 'propensity_history_test_bce_orig': 0.7560581635306312, 'encoder_val_rmse_all': 1.1173809418094685, 'encoder_val_rmse_orig': 1.0867436849767125, 'encoder_test_rmse_all': 1.0876240920076308, 'encoder_test_rmse_orig': 0.7987348239380826, 'encoder_test_rmse_last': 1.120764966616359, 'decoder_val_rmse_all': 0.36722098180350315, 'decoder_val_rmse_orig': 0.367220981803503, 'decoder_test_rmse_2-step': 1.0838947693838128, 'decoder_test_rmse_3-step': 1.2238988194265308, 'decoder_test_rmse_4-step': 1.2983724872056988, 'decoder_test_rmse_5-step': 1.3524010526145598, 'decoder_test_rmse_6-step': 1.3949821510717209, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 270.22065080599714, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:11:38,662,662 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 02:11:38,665,665 multiprocessing INFO Running EQ_5_D sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:11:38,714,714 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:11:52,605,605 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 13.940317994994984, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:11:52,605,605 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 5, 2.0)
MainProcess| 2023-05-15 02:11:52,608,608 multiprocessing INFO Running EQ_5_D crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:11:52,660,660 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:16:47,155,155 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6232104470079559, 'encoder_val_rmse_orig': 0.6128756434945339, 'encoder_test_rmse_all': 0.8681258004094102, 'encoder_test_rmse_orig': 0.6261896295795688, 'encoder_test_rmse_last': 0.7671211296331465, 'decoder_val_rmse_all': 0.40885424095884837, 'decoder_val_rmse_orig': 0.40885424095884887, 'decoder_test_rmse_2-step': 0.939726354296116, 'decoder_test_rmse_3-step': 1.0492298320478883, 'decoder_test_rmse_4-step': 1.0995879619935043, 'decoder_test_rmse_5-step': 1.1327664730080167, 'decoder_test_rmse_6-step': 1.1420378896646404, 'method': 'crn', 'seed': 5, 'seconds_taken': 294.5468845409996, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:16:47,155,155 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 5, 2.0)
MainProcess| 2023-05-15 02:16:47,158,158 multiprocessing INFO Running EQ_5_D msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:16:47,206,206 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:16:57,452,452 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 5, 'seconds_taken': 10.293530049995752, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:16:57,452,452 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 02:16:57,455,455 multiprocessing INFO Running EQ_5_D gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:16:57,500,500 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:21:33,259,259 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6647018525794076, 'encoder_val_rmse_orig': 0.6552678581938235, 'encoder_test_rmse_all': 0.8102428559226845, 'encoder_test_rmse_orig': 0.5920252922055247, 'encoder_test_rmse_last': 0.7512108936285505, 'decoder_val_rmse_all': 0.6647018525794076, 'decoder_val_rmse_orig': 0.6552678581938235, 'decoder_test_rmse_2-step': 1.0439782930268158, 'decoder_test_rmse_3-step': 1.2321974498295851, 'decoder_test_rmse_4-step': 1.273295372894032, 'decoder_test_rmse_5-step': 1.3162584591101782, 'decoder_test_rmse_6-step': 1.3187997142726293, 'method': 'gnet', 'seed': 5, 'seconds_taken': 275.80358145300124, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:21:33,259,259 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 5, 2.0)
MainProcess| 2023-05-15 02:21:33,262,262 multiprocessing INFO Running EQ_5_D ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:21:33,310,310 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:22:22,130,130 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8778679304616014, 'encoder_val_rmse_orig': 0.8633372226484612, 'encoder_test_rmse_all': 1.196296997940903, 'encoder_test_rmse_orig': 0.8667025255344876, 'encoder_test_rmse_last': 1.1114931361892948, 'decoder_val_rmse_all': 0.8778679304616014, 'decoder_val_rmse_orig': 0.8633372226484612, 'decoder_test_rmse_2-step': 1.286395660320124, 'decoder_test_rmse_3-step': 1.2464816108456096, 'decoder_test_rmse_4-step': 1.2236717631945448, 'decoder_test_rmse_5-step': 1.1866187220191398, 'decoder_test_rmse_6-step': 1.1276470742348645, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.86856186600198, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:22:22,130,130 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 02:22:22,133,133 multiprocessing INFO Running EQ_5_D rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:22:22,187,187 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:26:54,621,621 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7686196355011674, 'propensity_treatment_val_bce_orig': 0.7685953920388838, 'propensity_treatment_test_bce_all': 0.7560346103253096, 'propensity_treatment_test_bce_orig': 0.759990980405923, 'propensity_history_val_bce_all': 0.7616801076641339, 'propensity_history_val_bce_orig': 0.7617199621342184, 'propensity_history_test_bce_all': 0.7542524295569556, 'propensity_history_test_bce_orig': 0.7570860332387792, 'encoder_val_rmse_all': 1.1570093663592331, 'encoder_val_rmse_orig': 1.1362985249630952, 'encoder_test_rmse_all': 1.2400492050049685, 'encoder_test_rmse_orig': 0.9005982168498772, 'encoder_test_rmse_last': 1.1181641816763603, 'decoder_val_rmse_all': 0.32476512314617334, 'decoder_val_rmse_orig': 0.32476512314617345, 'decoder_test_rmse_2-step': 1.198689086210213, 'decoder_test_rmse_3-step': 1.228816185454842, 'decoder_test_rmse_4-step': 1.2214054732785786, 'decoder_test_rmse_5-step': 1.2172586506061371, 'decoder_test_rmse_6-step': 1.2144413639741443, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 272.48718814499443, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:28:21,364,364 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 02:28:21,366,366 multiprocessing INFO Running EQ_4_A sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:28:21,419,419 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:28:25,009,9 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 3.642412109998986, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:28:25,009,9 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 5, 2.0)
MainProcess| 2023-05-15 02:28:25,012,12 multiprocessing INFO Running EQ_4_A wsindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:28:25,061,61 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:28:30,551,551 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1314741939727778, 'encoder_test_rmse_orig': 0.11120380537679496, 'encoder_test_rmse_last': 0.11121343754917218, 'decoder_test_rmse_2-step': 0.11112771661161441, 'decoder_test_rmse_3-step': 0.11077745441017803, 'decoder_test_rmse_4-step': 0.1100764393758691, 'decoder_test_rmse_5-step': 0.10899829009914586, 'decoder_test_rmse_6-step': 0.10754861438295653, 'global_equation_string': 'Treatment 0: x_dot = +-1.008416909074356*x0*u0 | Treatment 1: x_dot = +-1.0083730398759634*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 5, 'seconds_taken': 5.538760730996728, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:28:30,551,551 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 5, 2.0)
MainProcess| 2023-05-15 02:28:30,554,554 multiprocessing INFO Running EQ_4_A crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:28:30,603,603 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:33:31,031,31 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6604280181324648, 'encoder_val_rmse_orig': 0.6604280181324648, 'encoder_test_rmse_all': 0.5013717239600022, 'encoder_test_rmse_orig': 0.6616033640289558, 'encoder_test_rmse_last': 0.7188758920042564, 'decoder_val_rmse_all': 0.3320894378747319, 'decoder_val_rmse_orig': 0.33208943787473166, 'decoder_test_rmse_2-step': 1.0500607740194117, 'decoder_test_rmse_3-step': 1.0256093109435334, 'decoder_test_rmse_4-step': 1.064570319078386, 'decoder_test_rmse_5-step': 1.1274897609177, 'decoder_test_rmse_6-step': 1.1982689567962699, 'method': 'crn', 'seed': 5, 'seconds_taken': 300.47702662699885, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:33:31,031,31 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 5, 2.0)
MainProcess| 2023-05-15 02:33:31,034,34 multiprocessing INFO Running EQ_4_A msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:33:31,082,82 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:33:36,536,536 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 5, 'seconds_taken': 5.502112925001711, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:33:36,537,537 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 02:33:36,540,540 multiprocessing INFO Running EQ_4_A gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:33:36,592,592 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:37:50,603,603 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3151356839986652, 'encoder_val_rmse_orig': 0.3151356839986652, 'encoder_test_rmse_all': 0.4008111194289508, 'encoder_test_rmse_orig': 0.31695917482878483, 'encoder_test_rmse_last': 0.34007891740098856, 'decoder_val_rmse_all': 0.3151356839986652, 'decoder_val_rmse_orig': 0.3151356839986652, 'decoder_test_rmse_2-step': 0.5122259398310822, 'decoder_test_rmse_3-step': 0.5933564280884635, 'decoder_test_rmse_4-step': 0.6608324239088332, 'decoder_test_rmse_5-step': 0.714842634564619, 'decoder_test_rmse_6-step': 0.7578266910956437, 'method': 'gnet', 'seed': 5, 'seconds_taken': 254.06266378799774, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:37:50,603,603 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 5, 2.0)
MainProcess| 2023-05-15 02:37:50,606,606 multiprocessing INFO Running EQ_4_A ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:37:50,655,655 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:38:38,732,732 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.2959565754295736, 'encoder_val_rmse_orig': 0.2959565754295736, 'encoder_test_rmse_all': 0.35805725237224273, 'encoder_test_rmse_orig': 0.30489387986143013, 'encoder_test_rmse_last': 0.48839547501041164, 'decoder_val_rmse_all': 0.2959565754295736, 'decoder_val_rmse_orig': 0.2959565754295736, 'decoder_test_rmse_2-step': 0.5076620845133708, 'decoder_test_rmse_3-step': 0.5151036256652839, 'decoder_test_rmse_4-step': 0.5415211828492075, 'decoder_test_rmse_5-step': 0.5548362726237083, 'decoder_test_rmse_6-step': 0.5761560969417586, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.12608707700565, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:38:38,732,732 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 02:38:38,735,735 multiprocessing INFO Running EQ_4_A rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:38:38,790,790 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:43:17,767,767 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49455014438952427, 'propensity_treatment_val_bce_orig': 0.49455014438952416, 'propensity_treatment_test_bce_all': 0.5082737524416824, 'propensity_treatment_test_bce_orig': 0.5156464264995263, 'propensity_history_val_bce_all': 0.4920979586546704, 'propensity_history_val_bce_orig': 0.49209795865467043, 'propensity_history_test_bce_all': 0.5048492485661122, 'propensity_history_test_bce_orig': 0.5133540395362803, 'encoder_val_rmse_all': 2.8147863820448467, 'encoder_val_rmse_orig': 2.814786382044847, 'encoder_test_rmse_all': 3.880567333659566, 'encoder_test_rmse_orig': 2.821053072503864, 'encoder_test_rmse_last': 2.918480769314634, 'decoder_val_rmse_all': 0.4455207319253168, 'decoder_val_rmse_orig': 0.4455207319253164, 'decoder_test_rmse_2-step': 2.527626161014216, 'decoder_test_rmse_3-step': 2.2492451839837986, 'decoder_test_rmse_4-step': 2.05841000952255, 'decoder_test_rmse_5-step': 1.9383412385552141, 'decoder_test_rmse_6-step': 1.882235776345257, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 279.03167823599506, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:44:44,761,761 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 02:44:44,764,764 multiprocessing INFO Running EQ_4_B sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:44:44,813,813 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:44:48,384,384 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 3.619869304995518, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:44:48,384,384 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 5, 2.0)
MainProcess| 2023-05-15 02:44:48,388,388 multiprocessing INFO Running EQ_4_B wsindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:44:48,438,438 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:44:53,954,954 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1331504570942793, 'encoder_test_rmse_orig': 0.11306896833071993, 'encoder_test_rmse_last': 0.11315790636269711, 'decoder_test_rmse_2-step': 0.11298725851528887, 'decoder_test_rmse_3-step': 0.11270564407799355, 'decoder_test_rmse_4-step': 0.11206171166681084, 'decoder_test_rmse_5-step': 0.11080588986924353, 'decoder_test_rmse_6-step': 0.10938256073090538, 'global_equation_string': 'Treatment 0: x_dot = +-1.008357419503822*x0*u0 | Treatment 1: x_dot = +-1.0084046977238785*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 5, 'seconds_taken': 5.565193834998354, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:44:53,954,954 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 5, 2.0)
MainProcess| 2023-05-15 02:44:53,957,957 multiprocessing INFO Running EQ_4_B crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:44:54,006,6 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:49:56,295,295 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6606357891548366, 'encoder_val_rmse_orig': 0.6606357891548366, 'encoder_test_rmse_all': 0.5018952600995448, 'encoder_test_rmse_orig': 0.6619664755881753, 'encoder_test_rmse_last': 0.719014468265489, 'decoder_val_rmse_all': 0.3330382442850453, 'decoder_val_rmse_orig': 0.33303824428504536, 'decoder_test_rmse_2-step': 1.049808477175139, 'decoder_test_rmse_3-step': 1.0255261100731263, 'decoder_test_rmse_4-step': 1.064710671632567, 'decoder_test_rmse_5-step': 1.1276191317616548, 'decoder_test_rmse_6-step': 1.1984875156039232, 'method': 'crn', 'seed': 5, 'seconds_taken': 302.3386254290017, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:49:56,295,295 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 5, 2.0)
MainProcess| 2023-05-15 02:49:56,298,298 multiprocessing INFO Running EQ_4_B msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:49:56,346,346 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:50:01,735,735 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 5, 'seconds_taken': 5.436800078998203, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:50:01,735,735 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 02:50:01,738,738 multiprocessing INFO Running EQ_4_B gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:50:01,786,786 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:54:26,277,277 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3159712909186447, 'encoder_val_rmse_orig': 0.3159712909186446, 'encoder_test_rmse_all': 0.40147293932192757, 'encoder_test_rmse_orig': 0.31782933869504154, 'encoder_test_rmse_last': 0.34091819023436787, 'decoder_val_rmse_all': 0.3159712909186447, 'decoder_val_rmse_orig': 0.3159712909186446, 'decoder_test_rmse_2-step': 0.5130389358546625, 'decoder_test_rmse_3-step': 0.5942332322812001, 'decoder_test_rmse_4-step': 0.6616408411899413, 'decoder_test_rmse_5-step': 0.7157803848001482, 'decoder_test_rmse_6-step': 0.7587462762137317, 'method': 'gnet', 'seed': 5, 'seconds_taken': 264.53898409500107, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:54:26,277,277 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 5, 2.0)
MainProcess| 2023-05-15 02:54:26,280,280 multiprocessing INFO Running EQ_4_B ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:54:26,331,331 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:55:15,292,292 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.29652671639218114, 'encoder_val_rmse_orig': 0.29652671639218114, 'encoder_test_rmse_all': 0.3582979942014236, 'encoder_test_rmse_orig': 0.3051934314124154, 'encoder_test_rmse_last': 0.48766981788133684, 'decoder_val_rmse_all': 0.29652671639218114, 'decoder_val_rmse_orig': 0.29652671639218114, 'decoder_test_rmse_2-step': 0.508486242544928, 'decoder_test_rmse_3-step': 0.5161802149603371, 'decoder_test_rmse_4-step': 0.5417299905088175, 'decoder_test_rmse_5-step': 0.5547327174560298, 'decoder_test_rmse_6-step': 0.5751056492418899, 'method': 'ct', 'seed': 5, 'seconds_taken': 49.01139775499905, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 02:55:15,292,292 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 02:55:15,295,295 multiprocessing INFO Running EQ_4_B rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 02:55:15,347,347 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 02:59:56,033,33 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49455014438952427, 'propensity_treatment_val_bce_orig': 0.49455014438952416, 'propensity_treatment_test_bce_all': 0.5082737524416824, 'propensity_treatment_test_bce_orig': 0.5156464264995263, 'propensity_history_val_bce_all': 0.49204609139490935, 'propensity_history_val_bce_orig': 0.4920460913949093, 'propensity_history_test_bce_all': 0.5047509142399508, 'propensity_history_test_bce_orig': 0.5133034412603537, 'encoder_val_rmse_all': 2.7833975964702957, 'encoder_val_rmse_orig': 2.7833975964702957, 'encoder_test_rmse_all': 3.8344128307015946, 'encoder_test_rmse_orig': 2.789819286949723, 'encoder_test_rmse_last': 2.8856565379996946, 'decoder_val_rmse_all': 0.4685412828224474, 'decoder_val_rmse_orig': 0.46854128282244734, 'decoder_test_rmse_2-step': 2.540961365857068, 'decoder_test_rmse_3-step': 2.250995869338368, 'decoder_test_rmse_4-step': 2.059104982760844, 'decoder_test_rmse_5-step': 1.948029475568518, 'decoder_test_rmse_6-step': 1.9083261757483136, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 280.73839487299847, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:01:25,159,159 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 03:01:25,163,163 multiprocessing INFO Running EQ_4_C sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:01:25,213,213 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:01:28,692,692 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 3.5293061239935923, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:01:28,692,692 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 5, 2.0)
MainProcess| 2023-05-15 03:01:28,695,695 multiprocessing INFO Running EQ_4_C wsindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:01:28,745,745 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:01:34,277,277 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.14592486441875702, 'encoder_test_rmse_orig': 0.11891013846676991, 'encoder_test_rmse_last': 0.11885126098103604, 'decoder_test_rmse_2-step': 0.11857438038269805, 'decoder_test_rmse_3-step': 0.11787968081826146, 'decoder_test_rmse_4-step': 0.11664147581690387, 'decoder_test_rmse_5-step': 0.11457853628722521, 'decoder_test_rmse_6-step': 0.11222691833258712, 'global_equation_string': 'Treatment 0: x_dot = +-0.044980393254489*x0+-1.0194835367544661*x0*u0 | Treatment 1: x_dot = +-0.14571436495873732*x0+-1.0225953462612933*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 5, 'seconds_taken': 5.582028689997969, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:01:34,278,278 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 5, 2.0)
MainProcess| 2023-05-15 03:01:34,280,280 multiprocessing INFO Running EQ_4_C crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:01:34,333,333 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:06:35,203,203 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.43008880564129814, 'encoder_val_rmse_orig': 0.43008880564129814, 'encoder_test_rmse_all': 0.3588837607871487, 'encoder_test_rmse_orig': 0.4316734133966722, 'encoder_test_rmse_last': 0.46359692859137736, 'decoder_val_rmse_all': 0.27988332883899225, 'decoder_val_rmse_orig': 0.27988332883899214, 'decoder_test_rmse_2-step': 0.7339737048044891, 'decoder_test_rmse_3-step': 0.6945148188815102, 'decoder_test_rmse_4-step': 0.7450819480468885, 'decoder_test_rmse_5-step': 0.813692329799489, 'decoder_test_rmse_6-step': 0.8825950956628692, 'method': 'crn', 'seed': 5, 'seconds_taken': 300.9229081750018, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:06:35,204,204 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 5, 2.0)
MainProcess| 2023-05-15 03:06:35,206,206 multiprocessing INFO Running EQ_4_C msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:06:35,255,255 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:06:40,694,694 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 5, 'seconds_taken': 5.487165562000882, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:06:40,694,694 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 03:06:40,697,697 multiprocessing INFO Running EQ_4_C gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:06:40,746,746 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:10:58,974,974 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.26858135670942596, 'encoder_val_rmse_orig': 0.2685813567094259, 'encoder_test_rmse_all': 0.35727876477865195, 'encoder_test_rmse_orig': 0.27055355139658094, 'encoder_test_rmse_last': 0.2930058476343572, 'decoder_val_rmse_all': 0.26858135670942596, 'decoder_val_rmse_orig': 0.2685813567094259, 'decoder_test_rmse_2-step': 0.4575675585880289, 'decoder_test_rmse_3-step': 0.5291476582515745, 'decoder_test_rmse_4-step': 0.5820625150225506, 'decoder_test_rmse_5-step': 0.6214564116678071, 'decoder_test_rmse_6-step': 0.6489865715225823, 'method': 'gnet', 'seed': 5, 'seconds_taken': 258.2768525700012, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:10:58,974,974 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 5, 2.0)
MainProcess| 2023-05-15 03:10:58,977,977 multiprocessing INFO Running EQ_4_C ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:10:59,024,24 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:11:47,335,335 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.29134689996271224, 'encoder_val_rmse_orig': 0.29134689996271224, 'encoder_test_rmse_all': 0.35930098778340774, 'encoder_test_rmse_orig': 0.2924300425643543, 'encoder_test_rmse_last': 0.3506402028456961, 'decoder_val_rmse_all': 0.29134689996271224, 'decoder_val_rmse_orig': 0.29134689996271224, 'decoder_test_rmse_2-step': 0.3769386309977433, 'decoder_test_rmse_3-step': 0.4552087464024664, 'decoder_test_rmse_4-step': 0.45158890816592656, 'decoder_test_rmse_5-step': 0.4613243367741143, 'decoder_test_rmse_6-step': 0.48429647675174897, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.358346816996345, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:11:47,335,335 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 03:11:47,338,338 multiprocessing INFO Running EQ_4_C rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:11:47,392,392 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:16:25,167,167 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49455014438952427, 'propensity_treatment_val_bce_orig': 0.49455014438952416, 'propensity_treatment_test_bce_all': 0.5082737524416824, 'propensity_treatment_test_bce_orig': 0.5156464264995263, 'propensity_history_val_bce_all': 0.4920566711385371, 'propensity_history_val_bce_orig': 0.49205667113853724, 'propensity_history_test_bce_all': 0.5047738218120599, 'propensity_history_test_bce_orig': 0.5133142982846708, 'encoder_val_rmse_all': 2.5823185079585484, 'encoder_val_rmse_orig': 2.582318507958549, 'encoder_test_rmse_all': 3.562602973560308, 'encoder_test_rmse_orig': 2.5881516173355896, 'encoder_test_rmse_last': 2.6980410642261297, 'decoder_val_rmse_all': 0.367851830550413, 'decoder_val_rmse_orig': 0.36785183055041304, 'decoder_test_rmse_2-step': 2.2616404099736624, 'decoder_test_rmse_3-step': 1.9685002143057857, 'decoder_test_rmse_4-step': 1.760174068268058, 'decoder_test_rmse_5-step': 1.617466625855892, 'decoder_test_rmse_6-step': 1.5313597403509178, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 277.82855515799747, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:17:56,943,943 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 5, 2.0)
MainProcess| 2023-05-15 03:17:56,945,945 multiprocessing INFO Running EQ_4_D sindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:17:56,995,995 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:18:00,461,461 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 3.5157589919981547, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:18:00,462,462 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 5, 2.0)
MainProcess| 2023-05-15 03:18:00,464,464 multiprocessing INFO Running EQ_4_D wsindy 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:18:00,515,515 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:18:05,981,981 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.12023953091552701, 'encoder_test_rmse_orig': 0.10202762554591496, 'encoder_test_rmse_last': 0.10247625318061764, 'decoder_test_rmse_2-step': 0.1025628000253158, 'decoder_test_rmse_3-step': 0.10288934724641181, 'decoder_test_rmse_4-step': 0.1029014070789321, 'decoder_test_rmse_5-step': 0.10260993551129363, 'decoder_test_rmse_6-step': 0.1017788214321385, 'global_equation_string': 'Treatment 0: x_dot = +0.19795123062644931*x0+-1.0099490705212215*x0*u0 | Treatment 1: x_dot = +-0.09060495156494752*x0+-1.02088659824383*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 5, 'seconds_taken': 5.516351559999748, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:18:05,981,981 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 5, 2.0)
MainProcess| 2023-05-15 03:18:05,984,984 multiprocessing INFO Running EQ_4_D crn 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:18:06,035,35 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:23:07,796,796 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.498350815643545, 'encoder_val_rmse_orig': 1.498350815643545, 'encoder_test_rmse_all': 1.2414823147306722, 'encoder_test_rmse_orig': 1.5112689040164367, 'encoder_test_rmse_last': 1.6471733373436783, 'decoder_val_rmse_all': 0.385670359448743, 'decoder_val_rmse_orig': 0.3856703594487428, 'decoder_test_rmse_2-step': 2.2498468313026905, 'decoder_test_rmse_3-step': 2.140166693353934, 'decoder_test_rmse_4-step': 2.0954092033818643, 'decoder_test_rmse_5-step': 2.0812223490153565, 'decoder_test_rmse_6-step': 2.0856953616028266, 'method': 'crn', 'seed': 5, 'seconds_taken': 301.812567408997, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:23:07,797,797 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 5, 2.0)
MainProcess| 2023-05-15 03:23:07,799,799 multiprocessing INFO Running EQ_4_D msm 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:23:07,847,847 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:23:13,314,314 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 5, 'seconds_taken': 5.514770077999856, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:23:13,314,314 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 5, 2.0)
MainProcess| 2023-05-15 03:23:13,317,317 multiprocessing INFO Running EQ_4_D gnet 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:23:13,366,366 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:27:37,857,857 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.43058579526565255, 'encoder_val_rmse_orig': 0.43058579526565266, 'encoder_test_rmse_all': 0.44250322754119953, 'encoder_test_rmse_orig': 0.4303190941693899, 'encoder_test_rmse_last': 0.4368398329800651, 'decoder_val_rmse_all': 0.43058579526565255, 'decoder_val_rmse_orig': 0.43058579526565266, 'decoder_test_rmse_2-step': 0.5740042544929708, 'decoder_test_rmse_3-step': 0.6681197023659227, 'decoder_test_rmse_4-step': 0.7422976650777204, 'decoder_test_rmse_5-step': 0.8081849628898808, 'decoder_test_rmse_6-step': 0.8656443387644028, 'method': 'gnet', 'seed': 5, 'seconds_taken': 264.5392003590023, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:27:37,857,857 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 5, 2.0)
MainProcess| 2023-05-15 03:27:37,859,859 multiprocessing INFO Running EQ_4_D ct 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:27:37,912,912 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:28:26,769,769 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.33275524996391437, 'encoder_val_rmse_orig': 0.3327552499639144, 'encoder_test_rmse_all': 0.3986275731726715, 'encoder_test_rmse_orig': 0.343357689082544, 'encoder_test_rmse_last': 0.466206770525614, 'decoder_val_rmse_all': 0.33275524996391437, 'decoder_val_rmse_orig': 0.3327552499639144, 'decoder_test_rmse_2-step': 0.4946011878572785, 'decoder_test_rmse_3-step': 0.7846155255501187, 'decoder_test_rmse_4-step': 0.7979150846890604, 'decoder_test_rmse_5-step': 0.7950287449238718, 'decoder_test_rmse_6-step': 0.8049968334630752, 'method': 'ct', 'seed': 5, 'seconds_taken': 48.90984200799721, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:28:26,770,770 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 5, 2.0)
MainProcess| 2023-05-15 03:28:26,772,772 multiprocessing INFO Running EQ_4_D rmsn 5 | domain_conf=2.0
MainProcess| 2023-05-15 03:28:26,827,827 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:33:09,307,307 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5020663612373805, 'propensity_treatment_val_bce_orig': 0.5020663612373805, 'propensity_treatment_test_bce_all': 0.5154150265829038, 'propensity_treatment_test_bce_orig': 0.5223764157001339, 'propensity_history_val_bce_all': 0.4997883408251455, 'propensity_history_val_bce_orig': 0.4997883408251455, 'propensity_history_test_bce_all': 0.5122910047812482, 'propensity_history_test_bce_orig': 0.520252684610017, 'encoder_val_rmse_all': 2.350339987841176, 'encoder_val_rmse_orig': 2.350339987841176, 'encoder_test_rmse_all': 3.175275586599921, 'encoder_test_rmse_orig': 2.3685778462864984, 'encoder_test_rmse_last': 2.564473829658157, 'decoder_val_rmse_all': 0.3602472207755298, 'decoder_val_rmse_orig': 0.3602472207755298, 'decoder_test_rmse_2-step': 2.241124625746331, 'decoder_test_rmse_3-step': 2.0310814161655317, 'decoder_test_rmse_4-step': 1.922441236185613, 'decoder_test_rmse_5-step': 1.8558978802848574, 'decoder_test_rmse_6-step': 1.8203053409310381, 'method': 'rmsn', 'seed': 5, 'seconds_taken': 282.53396264099865, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:34:32,997,997 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 03:34:33,000,0 multiprocessing INFO Running cancer_sim sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:34:33,050,50 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:34:46,981,981 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 13.981243184003688, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:34:46,982,982 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 6, 2.0)
MainProcess| 2023-05-15 03:34:46,984,984 multiprocessing INFO Running cancer_sim crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:34:47,029,29 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:39:36,343,343 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1070523727691028, 'encoder_val_rmse_orig': 1.0609619181340595, 'encoder_test_rmse_all': 0.7600403893606932, 'encoder_test_rmse_orig': 0.5732601999526682, 'encoder_test_rmse_last': 0.7259860281947222, 'decoder_val_rmse_all': 0.33992650179601724, 'decoder_val_rmse_orig': 0.33992650179601724, 'decoder_test_rmse_2-step': 0.6781588399108908, 'decoder_test_rmse_3-step': 0.7488089392292838, 'decoder_test_rmse_4-step': 0.8335952756255434, 'decoder_test_rmse_5-step': 0.9134504184601958, 'decoder_test_rmse_6-step': 0.9848010621354871, 'method': 'crn', 'seed': 6, 'seconds_taken': 289.3584949720025, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:39:36,343,343 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 6, 2.0)
MainProcess| 2023-05-15 03:39:36,346,346 multiprocessing INFO Running cancer_sim msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:39:36,389,389 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:39:47,328,328 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 6, 'seconds_taken': 10.981548366995412, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:39:47,328,328 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 03:39:47,331,331 multiprocessing INFO Running cancer_sim gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:39:47,375,375 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:44:21,268,268 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2203821557251378, 'encoder_val_rmse_orig': 1.1686708269313528, 'encoder_test_rmse_all': 0.739074677422077, 'encoder_test_rmse_orig': 0.554695027470026, 'encoder_test_rmse_last': 0.6858379718373856, 'decoder_val_rmse_all': 1.2203821557251378, 'decoder_val_rmse_orig': 1.1686708269313528, 'decoder_test_rmse_2-step': 0.7661916817835667, 'decoder_test_rmse_3-step': 0.9327703190405977, 'decoder_test_rmse_4-step': 0.993041379396905, 'decoder_test_rmse_5-step': 1.0423323961477862, 'decoder_test_rmse_6-step': 1.0818049739843532, 'method': 'gnet', 'seed': 6, 'seconds_taken': 273.9372575399975, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:44:21,268,268 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 6, 2.0)
MainProcess| 2023-05-15 03:44:21,271,271 multiprocessing INFO Running cancer_sim ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:44:21,320,320 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:45:11,698,698 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9924691019690355, 'encoder_val_rmse_orig': 0.9520716815863581, 'encoder_test_rmse_all': 0.8923193022547593, 'encoder_test_rmse_orig': 0.6774324899409345, 'encoder_test_rmse_last': 0.8001785116392898, 'decoder_val_rmse_all': 0.9924691019690355, 'decoder_val_rmse_orig': 0.9520716815863581, 'decoder_test_rmse_2-step': 0.9491645606534556, 'decoder_test_rmse_3-step': 0.9737880167840511, 'decoder_test_rmse_4-step': 1.0556533969808939, 'decoder_test_rmse_5-step': 1.1533603754398234, 'decoder_test_rmse_6-step': 1.2141940073387496, 'method': 'ct', 'seed': 6, 'seconds_taken': 50.42653269400034, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:45:11,698,698 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 03:45:11,701,701 multiprocessing INFO Running cancer_sim rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:45:11,754,754 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:49:41,221,221 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7684796695270117, 'propensity_treatment_val_bce_orig': 0.7684152845921465, 'propensity_treatment_test_bce_all': 0.760611981609863, 'propensity_treatment_test_bce_orig': 0.7623827064669899, 'propensity_history_val_bce_all': 0.7611680554309906, 'propensity_history_val_bce_orig': 0.7612510458918417, 'propensity_history_test_bce_all': 0.7562550263034832, 'propensity_history_test_bce_orig': 0.7582268663919294, 'encoder_val_rmse_all': 1.2952305956963206, 'encoder_val_rmse_orig': 1.241157212608218, 'encoder_test_rmse_all': 0.9817990938604604, 'encoder_test_rmse_orig': 0.7337178698288205, 'encoder_test_rmse_last': 0.8801907546144504, 'decoder_val_rmse_all': 0.3935865879852444, 'decoder_val_rmse_orig': 0.3935865879852449, 'decoder_test_rmse_2-step': 0.9088747416836573, 'decoder_test_rmse_3-step': 1.0079942768683894, 'decoder_test_rmse_4-step': 1.2145139128366582, 'decoder_test_rmse_5-step': 1.4040077430013975, 'decoder_test_rmse_6-step': 1.5590182765896072, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 269.52015990200016, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:51:56,212,212 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 03:51:56,215,215 multiprocessing INFO Running EQ_5_A sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:51:56,261,261 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:52:10,152,152 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 13.936725321000267, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:52:10,152,152 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 6, 2.0)
MainProcess| 2023-05-15 03:52:10,154,154 multiprocessing INFO Running EQ_5_A crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:52:10,202,202 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:57:02,822,822 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.837980101577294, 'encoder_val_rmse_orig': 0.8106351595202137, 'encoder_test_rmse_all': 0.9048957662645513, 'encoder_test_rmse_orig': 0.6570244916470919, 'encoder_test_rmse_last': 0.7890022454214065, 'decoder_val_rmse_all': 0.3301089166897668, 'decoder_val_rmse_orig': 0.3301089166897666, 'decoder_test_rmse_2-step': 0.7725918006230532, 'decoder_test_rmse_3-step': 0.8498722435249684, 'decoder_test_rmse_4-step': 0.9314868421424691, 'decoder_test_rmse_5-step': 1.001115369458137, 'decoder_test_rmse_6-step': 1.0327161271500254, 'method': 'crn', 'seed': 6, 'seconds_taken': 292.6677838800024, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:57:02,823,823 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 6, 2.0)
MainProcess| 2023-05-15 03:57:02,825,825 multiprocessing INFO Running EQ_5_A msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:57:02,873,873 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 03:57:13,462,462 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 6, 'seconds_taken': 10.636255010998866, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 03:57:13,462,462 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 03:57:13,465,465 multiprocessing INFO Running EQ_5_A gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 03:57:13,513,513 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:01:48,956,956 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8294614326117525, 'encoder_val_rmse_orig': 0.8021441536163928, 'encoder_test_rmse_all': 0.8311403015065351, 'encoder_test_rmse_orig': 0.6006786663486263, 'encoder_test_rmse_last': 0.8386668205005584, 'decoder_val_rmse_all': 0.8294614326117525, 'decoder_val_rmse_orig': 0.8021441536163928, 'decoder_test_rmse_2-step': 0.8935107001334137, 'decoder_test_rmse_3-step': 1.022277138270681, 'decoder_test_rmse_4-step': 1.1324905327227364, 'decoder_test_rmse_5-step': 1.1958093041312807, 'decoder_test_rmse_6-step': 1.250642516850065, 'method': 'gnet', 'seed': 6, 'seconds_taken': 275.49101549899933, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:01:48,956,956 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 6, 2.0)
MainProcess| 2023-05-15 04:01:48,959,959 multiprocessing INFO Running EQ_5_A ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:01:49,004,4 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:02:38,274,274 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0102861445192397, 'encoder_val_rmse_orig': 0.977045742585071, 'encoder_test_rmse_all': 1.1190297770253967, 'encoder_test_rmse_orig': 0.8292113067950959, 'encoder_test_rmse_last': 1.0998761740863978, 'decoder_val_rmse_all': 1.0102861445192397, 'decoder_val_rmse_orig': 0.977045742585071, 'decoder_test_rmse_2-step': 1.025960102987597, 'decoder_test_rmse_3-step': 1.1449839062479132, 'decoder_test_rmse_4-step': 1.2426782295719085, 'decoder_test_rmse_5-step': 1.3090653007053608, 'decoder_test_rmse_6-step': 1.301166177120167, 'method': 'ct', 'seed': 6, 'seconds_taken': 49.314967407997756, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:02:38,274,274 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 04:02:38,277,277 multiprocessing INFO Running EQ_5_A rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:02:38,329,329 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:07:08,356,356 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7669340592200959, 'propensity_treatment_val_bce_orig': 0.7668900331802775, 'propensity_treatment_test_bce_all': 0.7616160282269103, 'propensity_treatment_test_bce_orig': 0.7611535224869601, 'propensity_history_val_bce_all': 0.7627995425958254, 'propensity_history_val_bce_orig': 0.7628334446374366, 'propensity_history_test_bce_all': 0.7604033887085218, 'propensity_history_test_bce_orig': 0.7599551705666008, 'encoder_val_rmse_all': 1.3907245947453861, 'encoder_val_rmse_orig': 1.343763173435041, 'encoder_test_rmse_all': 1.4151661886582074, 'encoder_test_rmse_orig': 1.0199666143282338, 'encoder_test_rmse_last': 1.2382716103383646, 'decoder_val_rmse_all': 0.2614562394042612, 'decoder_val_rmse_orig': 0.26145623940426105, 'decoder_test_rmse_2-step': 1.0916347049526725, 'decoder_test_rmse_3-step': 1.0827051196582627, 'decoder_test_rmse_4-step': 1.1190257687186291, 'decoder_test_rmse_5-step': 1.1627629454511583, 'decoder_test_rmse_6-step': 1.180584947099937, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 270.07878661299765, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:08:44,416,416 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 04:08:44,419,419 multiprocessing INFO Running EQ_5_B sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:08:44,466,466 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:08:57,105,105 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 12.685219601997233, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:08:57,105,105 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 6, 2.0)
MainProcess| 2023-05-15 04:08:57,108,108 multiprocessing INFO Running EQ_5_B crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:08:57,157,157 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:13:49,662,662 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8379405793683231, 'encoder_val_rmse_orig': 0.8105970837363606, 'encoder_test_rmse_all': 0.9048547743525374, 'encoder_test_rmse_orig': 0.6569954494774793, 'encoder_test_rmse_last': 0.7889993362194003, 'decoder_val_rmse_all': 0.33010318165083125, 'decoder_val_rmse_orig': 0.3301031816508314, 'decoder_test_rmse_2-step': 0.7725721156101374, 'decoder_test_rmse_3-step': 0.8498635272556195, 'decoder_test_rmse_4-step': 0.9314763347260377, 'decoder_test_rmse_5-step': 1.001104838730556, 'decoder_test_rmse_6-step': 1.0327074968614733, 'method': 'crn', 'seed': 6, 'seconds_taken': 292.55470498499926, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:13:49,663,663 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 6, 2.0)
MainProcess| 2023-05-15 04:13:49,665,665 multiprocessing INFO Running EQ_5_B msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:13:49,713,713 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:14:00,196,196 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 6, 'seconds_taken': 10.530580900995119, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:14:00,196,196 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 04:14:00,199,199 multiprocessing INFO Running EQ_5_B gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:14:00,244,244 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:18:39,984,984 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8294387477995478, 'encoder_val_rmse_orig': 0.8021223300220062, 'encoder_test_rmse_all': 0.8311448975120728, 'encoder_test_rmse_orig': 0.6006826211463666, 'encoder_test_rmse_last': 0.8386721340937703, 'decoder_val_rmse_all': 0.8294387477995478, 'decoder_val_rmse_orig': 0.8021223300220062, 'decoder_test_rmse_2-step': 0.8935516826390658, 'decoder_test_rmse_3-step': 1.02234359585668, 'decoder_test_rmse_4-step': 1.1325552535241417, 'decoder_test_rmse_5-step': 1.195908236030056, 'decoder_test_rmse_6-step': 1.2507479934510382, 'method': 'gnet', 'seed': 6, 'seconds_taken': 279.78473541600397, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:18:39,984,984 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 6, 2.0)
MainProcess| 2023-05-15 04:18:39,987,987 multiprocessing INFO Running EQ_5_B ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:18:40,037,37 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:19:29,243,243 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9959278244991543, 'encoder_val_rmse_orig': 0.9632518058457434, 'encoder_test_rmse_all': 1.1598184371807818, 'encoder_test_rmse_orig': 0.8571767837200114, 'encoder_test_rmse_last': 1.1221171804426877, 'decoder_val_rmse_all': 0.9959278244991543, 'decoder_val_rmse_orig': 0.9632518058457434, 'decoder_test_rmse_2-step': 1.0599793668792086, 'decoder_test_rmse_3-step': 1.1696911272196757, 'decoder_test_rmse_4-step': 1.2663696115142606, 'decoder_test_rmse_5-step': 1.3242215159451245, 'decoder_test_rmse_6-step': 1.306873222614709, 'method': 'ct', 'seed': 6, 'seconds_taken': 49.25637089500378, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:19:29,243,243 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 04:19:29,247,247 multiprocessing INFO Running EQ_5_B rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:19:29,301,301 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:23:59,678,678 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7669340592200959, 'propensity_treatment_val_bce_orig': 0.7668900331802775, 'propensity_treatment_test_bce_all': 0.7616160282269103, 'propensity_treatment_test_bce_orig': 0.7611535224869601, 'propensity_history_val_bce_all': 0.7621100559838798, 'propensity_history_val_bce_orig': 0.7621415382340891, 'propensity_history_test_bce_all': 0.75980564096312, 'propensity_history_test_bce_orig': 0.7593001999391179, 'encoder_val_rmse_all': 1.393231053606006, 'encoder_val_rmse_orig': 1.3461715158695018, 'encoder_test_rmse_all': 1.4170151596605811, 'encoder_test_rmse_orig': 1.0211412717496917, 'encoder_test_rmse_last': 1.2361974287674238, 'decoder_val_rmse_all': 0.261153168300124, 'decoder_val_rmse_orig': 0.26115316830012414, 'decoder_test_rmse_2-step': 1.0891134722450113, 'decoder_test_rmse_3-step': 1.0789561493140263, 'decoder_test_rmse_4-step': 1.1090997167604568, 'decoder_test_rmse_5-step': 1.1450648072609697, 'decoder_test_rmse_6-step': 1.1552605706461903, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 270.43013893999887, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:25:37,416,416 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 04:25:37,418,418 multiprocessing INFO Running EQ_5_C sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:25:37,467,467 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:25:50,178,178 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 12.759871107002255, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:25:50,179,179 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 6, 2.0)
MainProcess| 2023-05-15 04:25:50,181,181 multiprocessing INFO Running EQ_5_C crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:25:50,234,234 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:30:46,646,646 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5784300615000613, 'encoder_val_rmse_orig': 0.5630721478455757, 'encoder_test_rmse_all': 0.8165991676794514, 'encoder_test_rmse_orig': 0.5970594721037331, 'encoder_test_rmse_last': 0.8072216247981788, 'decoder_val_rmse_all': 0.3339820384295966, 'decoder_val_rmse_orig': 0.3339820384295964, 'decoder_test_rmse_2-step': 0.8092894395514487, 'decoder_test_rmse_3-step': 0.8723795953887772, 'decoder_test_rmse_4-step': 0.9727048257938998, 'decoder_test_rmse_5-step': 1.0826048428588342, 'decoder_test_rmse_6-step': 1.1909504775956088, 'method': 'crn', 'seed': 6, 'seconds_taken': 296.4642475369983, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:30:46,646,646 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 6, 2.0)
MainProcess| 2023-05-15 04:30:46,649,649 multiprocessing INFO Running EQ_5_C msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:30:46,695,695 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:30:57,226,226 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 6, 'seconds_taken': 10.57708127600199, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:30:57,226,226 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 04:30:57,229,229 multiprocessing INFO Running EQ_5_C gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:30:57,276,276 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:35:37,385,385 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6148159599882167, 'encoder_val_rmse_orig': 0.5981686398619287, 'encoder_test_rmse_all': 0.8707558754708097, 'encoder_test_rmse_orig': 0.6422530284937729, 'encoder_test_rmse_last': 0.9669423132306985, 'decoder_val_rmse_all': 0.6148159599882167, 'decoder_val_rmse_orig': 0.5981686398619287, 'decoder_test_rmse_2-step': 0.9755690053435083, 'decoder_test_rmse_3-step': 1.0255705401982027, 'decoder_test_rmse_4-step': 1.0534063592805711, 'decoder_test_rmse_5-step': 1.0715162666782034, 'decoder_test_rmse_6-step': 1.0683397974335733, 'method': 'gnet', 'seed': 6, 'seconds_taken': 280.1556540859965, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:35:37,385,385 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 6, 2.0)
MainProcess| 2023-05-15 04:35:37,388,388 multiprocessing INFO Running EQ_5_C ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:35:37,436,436 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:36:26,761,761 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7104365126488046, 'encoder_val_rmse_orig': 0.6915154522878038, 'encoder_test_rmse_all': 1.2104995240740102, 'encoder_test_rmse_orig': 0.8780443802261543, 'encoder_test_rmse_last': 1.078237448130467, 'decoder_val_rmse_all': 0.7104365126488046, 'decoder_val_rmse_orig': 0.6915154522878038, 'decoder_test_rmse_2-step': 1.0020213022336517, 'decoder_test_rmse_3-step': 1.0747156329975096, 'decoder_test_rmse_4-step': 1.016619986925864, 'decoder_test_rmse_5-step': 0.9818274526208037, 'decoder_test_rmse_6-step': 0.9309178828564756, 'method': 'ct', 'seed': 6, 'seconds_taken': 49.37299205599993, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:36:26,761,761 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 04:36:26,764,764 multiprocessing INFO Running EQ_5_C rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:36:26,818,818 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:41:00,882,882 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7680316815139706, 'propensity_treatment_val_bce_orig': 0.7680432491641375, 'propensity_treatment_test_bce_all': 0.7560265749265114, 'propensity_treatment_test_bce_orig': 0.7594247699354797, 'propensity_history_val_bce_all': 0.7608351446882375, 'propensity_history_val_bce_orig': 0.7609222418164295, 'propensity_history_test_bce_all': 0.7514481396710121, 'propensity_history_test_bce_orig': 0.7546149479851573, 'encoder_val_rmse_all': 1.1473247414076921, 'encoder_val_rmse_orig': 1.115290674473723, 'encoder_test_rmse_all': 1.1937432693288506, 'encoder_test_rmse_orig': 0.8684846182452336, 'encoder_test_rmse_last': 1.1801671633618518, 'decoder_val_rmse_all': 0.32965309318982144, 'decoder_val_rmse_orig': 0.32965309318982133, 'decoder_test_rmse_2-step': 1.1424187827566912, 'decoder_test_rmse_3-step': 1.2652331105264114, 'decoder_test_rmse_4-step': 1.3498049453512098, 'decoder_test_rmse_5-step': 1.404775743133478, 'decoder_test_rmse_6-step': 1.449240442292551, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 274.11847771299654, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:42:35,695,695 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 04:42:35,698,698 multiprocessing INFO Running EQ_5_D sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:42:35,750,750 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:42:49,676,676 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 13.9774625880018, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:42:49,676,676 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 6, 2.0)
MainProcess| 2023-05-15 04:42:49,679,679 multiprocessing INFO Running EQ_5_D crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:42:49,729,729 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:47:42,824,824 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6261869121772595, 'encoder_val_rmse_orig': 0.6157161292640719, 'encoder_test_rmse_all': 0.8038421062818926, 'encoder_test_rmse_orig': 0.5806294676082999, 'encoder_test_rmse_last': 0.7225325591901613, 'decoder_val_rmse_all': 0.39116997759933775, 'decoder_val_rmse_orig': 0.3911699775993382, 'decoder_test_rmse_2-step': 0.914515675887446, 'decoder_test_rmse_3-step': 1.0114184466505094, 'decoder_test_rmse_4-step': 1.0656853690497952, 'decoder_test_rmse_5-step': 1.1025404474194693, 'decoder_test_rmse_6-step': 1.1151322668826453, 'method': 'crn', 'seed': 6, 'seconds_taken': 293.1447596729995, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:47:42,824,824 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 6, 2.0)
MainProcess| 2023-05-15 04:47:42,829,829 multiprocessing INFO Running EQ_5_D msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:47:42,875,875 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:47:53,551,551 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 6, 'seconds_taken': 10.722406601002149, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:47:53,552,552 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 04:47:53,554,554 multiprocessing INFO Running EQ_5_D gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:47:53,602,602 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:52:32,015,15 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.675753379519436, 'encoder_val_rmse_orig': 0.6645655148900783, 'encoder_test_rmse_all': 0.8052050567758106, 'encoder_test_rmse_orig': 0.5830220531037151, 'encoder_test_rmse_last': 0.7792838693475539, 'decoder_val_rmse_all': 0.675753379519436, 'decoder_val_rmse_orig': 0.6645655148900783, 'decoder_test_rmse_2-step': 0.9664535001958626, 'decoder_test_rmse_3-step': 1.0642823604522336, 'decoder_test_rmse_4-step': 1.0806969201503593, 'decoder_test_rmse_5-step': 1.074936143280515, 'decoder_test_rmse_6-step': 1.051456923794453, 'method': 'gnet', 'seed': 6, 'seconds_taken': 278.4601903710063, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:52:32,015,15 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 6, 2.0)
MainProcess| 2023-05-15 04:52:32,018,18 multiprocessing INFO Running EQ_5_D ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:52:32,068,68 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:53:21,269,269 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8024715829781031, 'encoder_val_rmse_orig': 0.7888612913378206, 'encoder_test_rmse_all': 1.1853516124605965, 'encoder_test_rmse_orig': 0.8615725679295227, 'encoder_test_rmse_last': 1.0497612057677126, 'decoder_val_rmse_all': 0.8024715829781031, 'decoder_val_rmse_orig': 0.7888612913378206, 'decoder_test_rmse_2-step': 1.1812923932133785, 'decoder_test_rmse_3-step': 1.1252790135093356, 'decoder_test_rmse_4-step': 1.1884922640830125, 'decoder_test_rmse_5-step': 1.202322083527982, 'decoder_test_rmse_6-step': 1.2220256092378374, 'method': 'ct', 'seed': 6, 'seconds_taken': 49.25115551499766, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:53:21,269,269 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 04:53:21,272,272 multiprocessing INFO Running EQ_5_D rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:53:21,319,319 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:57:52,550,550 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.768772916504462, 'propensity_treatment_val_bce_orig': 0.7687678932554719, 'propensity_treatment_test_bce_all': 0.7567994226009813, 'propensity_treatment_test_bce_orig': 0.7606644499082532, 'propensity_history_val_bce_all': 0.7618548155712875, 'propensity_history_val_bce_orig': 0.7619117451599795, 'propensity_history_test_bce_all': 0.7538267420035848, 'propensity_history_test_bce_orig': 0.7571505103923205, 'encoder_val_rmse_all': 1.1366423993918775, 'encoder_val_rmse_orig': 1.1159149515147524, 'encoder_test_rmse_all': 1.2460998612282774, 'encoder_test_rmse_orig': 0.8982812457056973, 'encoder_test_rmse_last': 1.1298085498403374, 'decoder_val_rmse_all': 0.341147842474947, 'decoder_val_rmse_orig': 0.3411478424749468, 'decoder_test_rmse_2-step': 1.2205407954784042, 'decoder_test_rmse_3-step': 1.1934964537011146, 'decoder_test_rmse_4-step': 1.1743940627362777, 'decoder_test_rmse_5-step': 1.1776835119113043, 'decoder_test_rmse_6-step': 1.1724089758515477, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 271.278293014002, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:59:19,114,114 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 04:59:19,117,117 multiprocessing INFO Running EQ_4_A sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:59:19,167,167 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:59:22,739,739 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 3.6216798050008947, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:59:22,739,739 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 6, 2.0)
MainProcess| 2023-05-15 04:59:22,742,742 multiprocessing INFO Running EQ_4_A wsindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:59:22,793,793 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 04:59:28,397,397 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13174070078100358, 'encoder_test_rmse_orig': 0.11142741953058767, 'encoder_test_rmse_last': 0.11142734356713806, 'decoder_test_rmse_2-step': 0.11134165413508008, 'decoder_test_rmse_3-step': 0.11098169894894006, 'decoder_test_rmse_4-step': 0.11027129389541708, 'decoder_test_rmse_5-step': 0.10918409320082006, 'decoder_test_rmse_6-step': 0.10772570963731164, 'global_equation_string': 'Treatment 0: x_dot = +-1.0083925542760648*x0*u0 | Treatment 1: x_dot = +-1.0084149036787953*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 6, 'seconds_taken': 5.654872494000301, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 04:59:28,397,397 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 6, 2.0)
MainProcess| 2023-05-15 04:59:28,400,400 multiprocessing INFO Running EQ_4_A crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 04:59:28,451,451 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:04:32,252,252 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2111833120447661, 'encoder_val_rmse_orig': 1.211183312044766, 'encoder_test_rmse_all': 0.9008918544202074, 'encoder_test_rmse_orig': 1.2136698162404782, 'encoder_test_rmse_last': 1.2711840570924442, 'decoder_val_rmse_all': 0.35518879404567194, 'decoder_val_rmse_orig': 0.35518879404567216, 'decoder_test_rmse_2-step': 0.7532865560785469, 'decoder_test_rmse_3-step': 0.7556286325780898, 'decoder_test_rmse_4-step': 0.7883538372497775, 'decoder_test_rmse_5-step': 0.8682403461781402, 'decoder_test_rmse_6-step': 0.9694447762621383, 'method': 'crn', 'seed': 6, 'seconds_taken': 303.85172172299644, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:04:32,252,252 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 6, 2.0)
MainProcess| 2023-05-15 05:04:32,255,255 multiprocessing INFO Running EQ_4_A msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:04:32,302,302 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:04:37,675,675 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 6, 'seconds_taken': 5.419962278996536, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:04:37,675,675 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 05:04:37,678,678 multiprocessing INFO Running EQ_4_A gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:04:37,720,720 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:09:02,924,924 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6245437388320847, 'encoder_val_rmse_orig': 0.6245437388320847, 'encoder_test_rmse_all': 0.7765535936834171, 'encoder_test_rmse_orig': 0.6242093073536626, 'encoder_test_rmse_last': 0.6115319381260256, 'decoder_val_rmse_all': 0.6245437388320847, 'decoder_val_rmse_orig': 0.6245437388320847, 'decoder_test_rmse_2-step': 0.81780870577439, 'decoder_test_rmse_3-step': 0.9400662204120374, 'decoder_test_rmse_4-step': 1.027409368014155, 'decoder_test_rmse_5-step': 1.09572585651143, 'decoder_test_rmse_6-step': 1.1402907134812053, 'method': 'gnet', 'seed': 6, 'seconds_taken': 265.24579604099563, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:09:02,924,924 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 6, 2.0)
MainProcess| 2023-05-15 05:09:02,927,927 multiprocessing INFO Running EQ_4_A ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:09:02,977,977 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:09:50,890,890 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3166317098716903, 'encoder_val_rmse_orig': 0.3166317098716903, 'encoder_test_rmse_all': 0.39670605821944493, 'encoder_test_rmse_orig': 0.32994736482201326, 'encoder_test_rmse_last': 0.5373685604059049, 'decoder_val_rmse_all': 0.3166317098716903, 'decoder_val_rmse_orig': 0.3166317098716903, 'decoder_test_rmse_2-step': 0.5739172855524526, 'decoder_test_rmse_3-step': 0.7691893330929352, 'decoder_test_rmse_4-step': 0.917103269164749, 'decoder_test_rmse_5-step': 1.0747636751567333, 'decoder_test_rmse_6-step': 1.1647982772075052, 'method': 'ct', 'seed': 6, 'seconds_taken': 47.96265603900247, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:09:50,890,890 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 05:09:50,893,893 multiprocessing INFO Running EQ_4_A rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:09:50,947,947 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:14:29,638,638 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4943708916437828, 'propensity_treatment_val_bce_orig': 0.49437089164378284, 'propensity_treatment_test_bce_all': 0.5081999574126833, 'propensity_treatment_test_bce_orig': 0.5154953800964301, 'propensity_history_val_bce_all': 0.491970016718921, 'propensity_history_val_bce_orig': 0.49197001671892104, 'propensity_history_test_bce_all': 0.5045960353222271, 'propensity_history_test_bce_orig': 0.5132280237256265, 'encoder_val_rmse_all': 2.4157079078229207, 'encoder_val_rmse_orig': 2.4157079078229207, 'encoder_test_rmse_all': 3.348635585773543, 'encoder_test_rmse_orig': 2.4217540579104444, 'encoder_test_rmse_last': 2.5593882021979297, 'decoder_val_rmse_all': 0.3187590015381261, 'decoder_val_rmse_orig': 0.31875900153812603, 'decoder_test_rmse_2-step': 2.2321273026388173, 'decoder_test_rmse_3-step': 2.1165229660050358, 'decoder_test_rmse_4-step': 2.0422813199180743, 'decoder_test_rmse_5-step': 1.9787191416019934, 'decoder_test_rmse_6-step': 1.9290323406323096, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 278.7447069769987, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:15:57,593,593 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 05:15:57,596,596 multiprocessing INFO Running EQ_4_B sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:15:57,647,647 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:16:01,156,156 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 3.559276042993588, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:16:01,156,156 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 6, 2.0)
MainProcess| 2023-05-15 05:16:01,158,158 multiprocessing INFO Running EQ_4_B wsindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:16:01,208,208 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:16:06,790,790 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1340441437732115, 'encoder_test_rmse_orig': 0.11382367089616062, 'encoder_test_rmse_last': 0.11392849495148989, 'decoder_test_rmse_2-step': 0.11375635796637396, 'decoder_test_rmse_3-step': 0.1134854862527131, 'decoder_test_rmse_4-step': 0.11284855840759322, 'decoder_test_rmse_5-step': 0.11159526425390662, 'decoder_test_rmse_6-step': 0.110170737100975, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084794668858683*x0*u0 | Treatment 1: x_dot = +-1.0084246154900263*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 6, 'seconds_taken': 5.631149977001769, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:16:06,790,790 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 6, 2.0)
MainProcess| 2023-05-15 05:16:06,793,793 multiprocessing INFO Running EQ_4_B crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:16:06,837,837 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:21:07,045,45 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2158379494915599, 'encoder_val_rmse_orig': 1.2158379494915599, 'encoder_test_rmse_all': 0.9044954134980496, 'encoder_test_rmse_orig': 1.2185912076119965, 'encoder_test_rmse_last': 1.2764596122649057, 'decoder_val_rmse_all': 0.35612278496277516, 'decoder_val_rmse_orig': 0.3561227849627751, 'decoder_test_rmse_2-step': 0.7909415365639256, 'decoder_test_rmse_3-step': 0.8374860988333056, 'decoder_test_rmse_4-step': 0.7887440468061381, 'decoder_test_rmse_5-step': 0.8352408118724971, 'decoder_test_rmse_6-step': 0.9271492882106838, 'method': 'crn', 'seed': 6, 'seconds_taken': 300.25189687799866, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:21:07,045,45 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 6, 2.0)
MainProcess| 2023-05-15 05:21:07,048,48 multiprocessing INFO Running EQ_4_B msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:21:07,096,96 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:21:12,457,457 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 6, 'seconds_taken': 5.409568061993923, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:21:12,458,458 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 05:21:12,460,460 multiprocessing INFO Running EQ_4_B gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:21:12,503,503 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:25:39,346,346 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6246244389124215, 'encoder_val_rmse_orig': 0.6246244389124214, 'encoder_test_rmse_all': 0.7765802354984731, 'encoder_test_rmse_orig': 0.6241954746526316, 'encoder_test_rmse_last': 0.6112972593551852, 'decoder_val_rmse_all': 0.6246244389124215, 'decoder_val_rmse_orig': 0.6246244389124214, 'decoder_test_rmse_2-step': 0.8177598629355387, 'decoder_test_rmse_3-step': 0.9398794460939476, 'decoder_test_rmse_4-step': 1.0271093560816138, 'decoder_test_rmse_5-step': 1.095155309633618, 'decoder_test_rmse_6-step': 1.139563415032598, 'method': 'gnet', 'seed': 6, 'seconds_taken': 266.8851553429995, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:25:39,346,346 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 6, 2.0)
MainProcess| 2023-05-15 05:25:39,349,349 multiprocessing INFO Running EQ_4_B ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:25:39,392,392 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:26:27,757,757 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.31724471142081234, 'encoder_val_rmse_orig': 0.31724471142081234, 'encoder_test_rmse_all': 0.3967078769460295, 'encoder_test_rmse_orig': 0.3303163791597428, 'encoder_test_rmse_last': 0.5367053484447415, 'decoder_val_rmse_all': 0.31724471142081234, 'decoder_val_rmse_orig': 0.31724471142081234, 'decoder_test_rmse_2-step': 0.5729938663688365, 'decoder_test_rmse_3-step': 0.7677748541137969, 'decoder_test_rmse_4-step': 0.9155486634729872, 'decoder_test_rmse_5-step': 1.0734200361881645, 'decoder_test_rmse_6-step': 1.1640133045254606, 'method': 'ct', 'seed': 6, 'seconds_taken': 48.40763270599564, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:26:27,757,757 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 05:26:27,760,760 multiprocessing INFO Running EQ_4_B rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:26:27,814,814 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:31:05,567,567 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4943708916437828, 'propensity_treatment_val_bce_orig': 0.49437089164378284, 'propensity_treatment_test_bce_all': 0.5081999574126833, 'propensity_treatment_test_bce_orig': 0.5154953800964301, 'propensity_history_val_bce_all': 0.4919762912493641, 'propensity_history_val_bce_orig': 0.49197629124936415, 'propensity_history_test_bce_all': 0.5046076936917117, 'propensity_history_test_bce_orig': 0.5132341948099746, 'encoder_val_rmse_all': 2.4276973917486058, 'encoder_val_rmse_orig': 2.4276973917486067, 'encoder_test_rmse_all': 3.36290931729596, 'encoder_test_rmse_orig': 2.433963575430453, 'encoder_test_rmse_last': 2.5716397892115626, 'decoder_val_rmse_all': 0.3180760245306118, 'decoder_val_rmse_orig': 0.3180760245306119, 'decoder_test_rmse_2-step': 2.220283693293524, 'decoder_test_rmse_3-step': 2.1262073227061475, 'decoder_test_rmse_4-step': 2.0844671155818477, 'decoder_test_rmse_5-step': 2.05642139569307, 'decoder_test_rmse_6-step': 2.0412089334289387, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 277.8069136010017, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:32:34,466,466 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 05:32:34,469,469 multiprocessing INFO Running EQ_4_C sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:32:34,520,520 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:32:37,954,954 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 3.4850636459959787, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:32:37,954,954 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 6, 2.0)
MainProcess| 2023-05-15 05:32:37,957,957 multiprocessing INFO Running EQ_4_C wsindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:32:38,007,7 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:32:43,469,469 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1528534896132235, 'encoder_test_rmse_orig': 0.12466016707014668, 'encoder_test_rmse_last': 0.12469931076983398, 'decoder_test_rmse_2-step': 0.12440895780434796, 'decoder_test_rmse_3-step': 0.1237594928408408, 'decoder_test_rmse_4-step': 0.12252308645688625, 'decoder_test_rmse_5-step': 0.1204206183792402, 'decoder_test_rmse_6-step': 0.11799682778273185, 'global_equation_string': 'Treatment 0: x_dot = +-0.04545615804270604*x0+-1.0194679813000693*x0*u0 | Treatment 1: x_dot = +-0.14659930073956096*x0+-1.02117319199572*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 6, 'seconds_taken': 5.511614076000114, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:32:43,469,469 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 6, 2.0)
MainProcess| 2023-05-15 05:32:43,472,472 multiprocessing INFO Running EQ_4_C crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:32:43,522,522 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:37:44,762,762 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1496611951972815, 'encoder_val_rmse_orig': 1.1496611951972817, 'encoder_test_rmse_all': 0.8729995428462302, 'encoder_test_rmse_orig': 1.1499088890792606, 'encoder_test_rmse_last': 1.1553671599870858, 'decoder_val_rmse_all': 0.30703723622059464, 'decoder_val_rmse_orig': 0.30703723622059464, 'decoder_test_rmse_2-step': 0.43130899848754556, 'decoder_test_rmse_3-step': 0.44550746404914954, 'decoder_test_rmse_4-step': 0.5409922690186028, 'decoder_test_rmse_5-step': 0.664836027484302, 'decoder_test_rmse_6-step': 0.7854045821624751, 'method': 'crn', 'seed': 6, 'seconds_taken': 301.2905581209998, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:37:44,762,762 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 6, 2.0)
MainProcess| 2023-05-15 05:37:44,765,765 multiprocessing INFO Running EQ_4_C msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:37:44,810,810 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:37:50,302,302 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 6, 'seconds_taken': 5.536236976004147, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:37:50,302,302 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 05:37:50,305,305 multiprocessing INFO Running EQ_4_C gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:37:50,346,346 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:42:13,548,548 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5868293304128906, 'encoder_val_rmse_orig': 0.5868293304128906, 'encoder_test_rmse_all': 0.6709881802687224, 'encoder_test_rmse_orig': 0.5866081703871364, 'encoder_test_rmse_last': 0.5826625330645837, 'decoder_val_rmse_all': 0.5868293304128906, 'decoder_val_rmse_orig': 0.5868293304128906, 'decoder_test_rmse_2-step': 0.74481513352892, 'decoder_test_rmse_3-step': 0.8349619593944513, 'decoder_test_rmse_4-step': 0.8929489213335915, 'decoder_test_rmse_5-step': 0.9344391968517783, 'decoder_test_rmse_6-step': 0.9554643718720326, 'method': 'gnet', 'seed': 6, 'seconds_taken': 263.24332026699994, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:42:13,548,548 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 6, 2.0)
MainProcess| 2023-05-15 05:42:13,551,551 multiprocessing INFO Running EQ_4_C ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:42:13,600,600 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:43:03,993,993 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.2870307139648102, 'encoder_val_rmse_orig': 0.2870307139648102, 'encoder_test_rmse_all': 0.35976058933690114, 'encoder_test_rmse_orig': 0.288080616672176, 'encoder_test_rmse_last': 0.3518607076910864, 'decoder_val_rmse_all': 0.2870307139648102, 'decoder_val_rmse_orig': 0.2870307139648102, 'decoder_test_rmse_2-step': 0.3769858236451391, 'decoder_test_rmse_3-step': 0.5381870511925347, 'decoder_test_rmse_4-step': 0.6870970472516407, 'decoder_test_rmse_5-step': 0.8327403667154509, 'decoder_test_rmse_6-step': 0.8972110033613182, 'method': 'ct', 'seed': 6, 'seconds_taken': 50.44168999300018, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:43:03,993,993 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 05:43:03,997,997 multiprocessing INFO Running EQ_4_C rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:43:04,054,54 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:47:48,531,531 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4943708916437828, 'propensity_treatment_val_bce_orig': 0.49437089164378284, 'propensity_treatment_test_bce_all': 0.5081999574126833, 'propensity_treatment_test_bce_orig': 0.5154953800964301, 'propensity_history_val_bce_all': 0.4919837658284074, 'propensity_history_val_bce_orig': 0.4919837658284074, 'propensity_history_test_bce_all': 0.5046231351439225, 'propensity_history_test_bce_orig': 0.5132418486721484, 'encoder_val_rmse_all': 2.379851144927256, 'encoder_val_rmse_orig': 2.379851144927256, 'encoder_test_rmse_all': 3.3099169392471497, 'encoder_test_rmse_orig': 2.3857603833563683, 'encoder_test_rmse_last': 2.5401472532730294, 'decoder_val_rmse_all': 0.29258919792474153, 'decoder_val_rmse_orig': 0.2925891979247417, 'decoder_test_rmse_2-step': 2.1660589588795083, 'decoder_test_rmse_3-step': 1.9838275406448347, 'decoder_test_rmse_4-step': 1.8576158500677717, 'decoder_test_rmse_5-step': 1.754731289368118, 'decoder_test_rmse_6-step': 1.6763774393446291, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 284.5331392529988, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:49:18,579,579 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 6, 2.0)
MainProcess| 2023-05-15 05:49:18,582,582 multiprocessing INFO Running EQ_4_D sindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:49:18,632,632 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:49:22,348,348 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 6, 'seconds_taken': 3.7661883530017803, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:49:22,349,349 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 6, 2.0)
MainProcess| 2023-05-15 05:49:22,351,351 multiprocessing INFO Running EQ_4_D wsindy 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:49:22,401,401 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:49:28,134,134 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.11998393003132445, 'encoder_test_rmse_orig': 0.1019943343668171, 'encoder_test_rmse_last': 0.10245894190363528, 'decoder_test_rmse_2-step': 0.10254631632025935, 'decoder_test_rmse_3-step': 0.10287860104433162, 'decoder_test_rmse_4-step': 0.10289261959868885, 'decoder_test_rmse_5-step': 0.10260085272209783, 'decoder_test_rmse_6-step': 0.10176905323707079, 'global_equation_string': 'Treatment 0: x_dot = +0.1978515152210172*x0+-1.0098225082064365*x0*u0 | Treatment 1: x_dot = +-0.09085704810017028*x0+-1.0202694888512527*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 6, 'seconds_taken': 5.782567948001088, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:49:28,134,134 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 6, 2.0)
MainProcess| 2023-05-15 05:49:28,137,137 multiprocessing INFO Running EQ_4_D crn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:49:28,190,190 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:54:30,478,478 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1805372844547424, 'encoder_val_rmse_orig': 1.1805372844547424, 'encoder_test_rmse_all': 0.9855328882679595, 'encoder_test_rmse_orig': 1.2092294645777433, 'encoder_test_rmse_last': 1.4821371097212952, 'decoder_val_rmse_all': 0.4235909480762161, 'decoder_val_rmse_orig': 0.42359094807621595, 'decoder_test_rmse_2-step': 2.1581284984446745, 'decoder_test_rmse_3-step': 2.0862745936062894, 'decoder_test_rmse_4-step': 2.0712927379846637, 'decoder_test_rmse_5-step': 2.0934630432139736, 'decoder_test_rmse_6-step': 2.1357644329114587, 'method': 'crn', 'seed': 6, 'seconds_taken': 302.3405291980016, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:54:30,478,478 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 6, 2.0)
MainProcess| 2023-05-15 05:54:30,482,482 multiprocessing INFO Running EQ_4_D msm 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:54:30,530,530 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:54:35,996,996 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 6, 'seconds_taken': 5.514015843997186, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:54:35,996,996 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 6, 2.0)
MainProcess| 2023-05-15 05:54:35,999,999 multiprocessing INFO Running EQ_4_D gnet 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:54:36,046,46 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:58:58,082,82 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5675021756426545, 'encoder_val_rmse_orig': 0.5675021756426544, 'encoder_test_rmse_all': 0.5918867287013634, 'encoder_test_rmse_orig': 0.5681085350170929, 'encoder_test_rmse_last': 0.5748403485072349, 'decoder_val_rmse_all': 0.5675021756426545, 'decoder_val_rmse_orig': 0.5675021756426544, 'decoder_test_rmse_2-step': 0.6403426345607841, 'decoder_test_rmse_3-step': 0.6941291701090964, 'decoder_test_rmse_4-step': 0.7412340714794107, 'decoder_test_rmse_5-step': 0.7851653767700411, 'decoder_test_rmse_6-step': 0.8220366355989037, 'method': 'gnet', 'seed': 6, 'seconds_taken': 262.0823506930028, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:58:58,082,82 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 6, 2.0)
MainProcess| 2023-05-15 05:58:58,085,85 multiprocessing INFO Running EQ_4_D ct 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:58:58,137,137 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 05:59:46,650,650 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3653757212199415, 'encoder_val_rmse_orig': 0.3653757212199415, 'encoder_test_rmse_all': 0.44811296797845, 'encoder_test_rmse_orig': 0.3937649269071827, 'encoder_test_rmse_last': 0.6030488708846619, 'decoder_val_rmse_all': 0.3653757212199415, 'decoder_val_rmse_orig': 0.3653757212199415, 'decoder_test_rmse_2-step': 0.624134003856039, 'decoder_test_rmse_3-step': 0.7297766894394639, 'decoder_test_rmse_4-step': 0.8525595407618235, 'decoder_test_rmse_5-step': 1.015177601752802, 'decoder_test_rmse_6-step': 1.112949887419881, 'method': 'ct', 'seed': 6, 'seconds_taken': 48.5650636270002, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 05:59:46,650,650 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 6, 2.0)
MainProcess| 2023-05-15 05:59:46,653,653 multiprocessing INFO Running EQ_4_D rmsn 6 | domain_conf=2.0
MainProcess| 2023-05-15 05:59:46,706,706 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 6, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:04:24,901,901 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5019833408371877, 'propensity_treatment_val_bce_orig': 0.5019833408371877, 'propensity_treatment_test_bce_all': 0.5154899602535754, 'propensity_treatment_test_bce_orig': 0.5223173547046318, 'propensity_history_val_bce_all': 0.4996592945062508, 'propensity_history_val_bce_orig': 0.4996592945062508, 'propensity_history_test_bce_all': 0.5120446971876305, 'propensity_history_test_bce_orig': 0.5201265230219217, 'encoder_val_rmse_all': 2.526390506412102, 'encoder_val_rmse_orig': 2.526390506412102, 'encoder_test_rmse_all': 3.497678417780661, 'encoder_test_rmse_orig': 2.542628048489984, 'encoder_test_rmse_last': 2.7590248792028977, 'decoder_val_rmse_all': 0.33653780556809004, 'decoder_val_rmse_orig': 0.33653780556809004, 'decoder_test_rmse_2-step': 2.377606783519155, 'decoder_test_rmse_3-step': 2.244797784706242, 'decoder_test_rmse_4-step': 2.1964574884573342, 'decoder_test_rmse_5-step': 2.1767763632437314, 'decoder_test_rmse_6-step': 2.1783522344976487, 'method': 'rmsn', 'seed': 6, 'seconds_taken': 278.2482032750122, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:05:49,381,381 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 06:05:49,384,384 multiprocessing INFO Running cancer_sim sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:05:49,436,436 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:06:02,933,933 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 13.548368026007665, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:06:02,933,933 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 7, 2.0)
MainProcess| 2023-05-15 06:06:02,936,936 multiprocessing INFO Running cancer_sim crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:06:02,987,987 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:10:53,739,739 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0738931103541072, 'encoder_val_rmse_orig': 1.0285870680747216, 'encoder_test_rmse_all': 0.7480375543742925, 'encoder_test_rmse_orig': 0.5624195105493134, 'encoder_test_rmse_last': 0.7041106495828257, 'decoder_val_rmse_all': 0.339896395194204, 'decoder_val_rmse_orig': 0.33989639519420367, 'decoder_test_rmse_2-step': 0.6905251000616959, 'decoder_test_rmse_3-step': 0.7411049205215686, 'decoder_test_rmse_4-step': 0.805528260667469, 'decoder_test_rmse_5-step': 0.8635683306119867, 'decoder_test_rmse_6-step': 0.9088465965487121, 'method': 'crn', 'seed': 7, 'seconds_taken': 290.80295478100015, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:10:53,739,739 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 7, 2.0)
MainProcess| 2023-05-15 06:10:53,742,742 multiprocessing INFO Running cancer_sim msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:10:53,790,790 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:11:04,225,225 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 7, 'seconds_taken': 10.48344244400505, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:11:04,226,226 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 06:11:04,228,228 multiprocessing INFO Running cancer_sim gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:11:04,270,270 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:15:33,020,20 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1587406277324857, 'encoder_val_rmse_orig': 1.1105458192358983, 'encoder_test_rmse_all': 0.7614245619645705, 'encoder_test_rmse_orig': 0.5837160064349369, 'encoder_test_rmse_last': 0.692509773127572, 'decoder_val_rmse_all': 1.1587406277324857, 'decoder_val_rmse_orig': 1.1105458192358983, 'decoder_test_rmse_2-step': 0.7991833711022708, 'decoder_test_rmse_3-step': 0.9313286568047113, 'decoder_test_rmse_4-step': 1.0051575435016, 'decoder_test_rmse_5-step': 1.0567641982461604, 'decoder_test_rmse_6-step': 1.091581873691674, 'method': 'gnet', 'seed': 7, 'seconds_taken': 268.79112902699853, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:15:33,020,20 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 7, 2.0)
MainProcess| 2023-05-15 06:15:33,023,23 multiprocessing INFO Running cancer_sim ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:15:33,073,73 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:16:23,503,503 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1064601944560994, 'encoder_val_rmse_orig': 1.06067733163112, 'encoder_test_rmse_all': 0.846543228605646, 'encoder_test_rmse_orig': 0.6373729767428983, 'encoder_test_rmse_last': 0.7443258242237858, 'decoder_val_rmse_all': 1.1064601944560994, 'decoder_val_rmse_orig': 1.06067733163112, 'decoder_test_rmse_2-step': 0.7680005373176607, 'decoder_test_rmse_3-step': 0.8726193591403487, 'decoder_test_rmse_4-step': 0.9700871809377206, 'decoder_test_rmse_5-step': 1.0502272200787475, 'decoder_test_rmse_6-step': 1.105121281321732, 'method': 'ct', 'seed': 7, 'seconds_taken': 50.48011190899706, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:16:23,503,503 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 06:16:23,506,506 multiprocessing INFO Running cancer_sim rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:16:23,561,561 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:20:50,641,641 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.768052651117041, 'propensity_treatment_val_bce_orig': 0.7679400655348606, 'propensity_treatment_test_bce_all': 0.7595762004855836, 'propensity_treatment_test_bce_orig': 0.7615754963023492, 'propensity_history_val_bce_all': 0.7607099386096022, 'propensity_history_val_bce_orig': 0.760666952004081, 'propensity_history_test_bce_all': 0.7552593770165111, 'propensity_history_test_bce_orig': 0.7568574770277138, 'encoder_val_rmse_all': 1.317293803200278, 'encoder_val_rmse_orig': 1.261956587489432, 'encoder_test_rmse_all': 0.9439427765365641, 'encoder_test_rmse_orig': 0.7045549062092913, 'encoder_test_rmse_last': 0.8509461792414618, 'decoder_val_rmse_all': 0.29519181808553874, 'decoder_val_rmse_orig': 0.29519181808553896, 'decoder_test_rmse_2-step': 0.86633751133409, 'decoder_test_rmse_3-step': 0.8987082641419883, 'decoder_test_rmse_4-step': 0.8980605677795404, 'decoder_test_rmse_5-step': 0.9082322945546638, 'decoder_test_rmse_6-step': 0.9212964281500751, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 267.1347961660067, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:23:06,216,216 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 06:23:06,219,219 multiprocessing INFO Running EQ_5_A sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:23:06,269,269 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:23:20,293,293 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 14.073870378997526, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:23:20,293,293 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 7, 2.0)
MainProcess| 2023-05-15 06:23:20,296,296 multiprocessing INFO Running EQ_5_A crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:23:20,348,348 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:28:09,657,657 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8583171741123395, 'encoder_val_rmse_orig': 0.8302428810276716, 'encoder_test_rmse_all': 0.9227383828648427, 'encoder_test_rmse_orig': 0.6700746622459449, 'encoder_test_rmse_last': 0.7954396894418823, 'decoder_val_rmse_all': 0.3356648703340353, 'decoder_val_rmse_orig': 0.3356648703340353, 'decoder_test_rmse_2-step': 0.7826392217632168, 'decoder_test_rmse_3-step': 0.8645993568235982, 'decoder_test_rmse_4-step': 0.952746331255841, 'decoder_test_rmse_5-step': 1.0239116581276946, 'decoder_test_rmse_6-step': 1.0515983401046256, 'method': 'crn', 'seed': 7, 'seconds_taken': 289.3608353409945, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:28:09,657,657 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 7, 2.0)
MainProcess| 2023-05-15 06:28:09,660,660 multiprocessing INFO Running EQ_5_A msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:28:09,708,708 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:28:19,990,990 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 7, 'seconds_taken': 10.329346976999659, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:28:19,990,990 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 06:28:19,993,993 multiprocessing INFO Running EQ_5_A gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:28:20,039,39 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:33:00,625,625 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.866415588330702, 'encoder_val_rmse_orig': 0.8378234266240421, 'encoder_test_rmse_all': 0.8781094781432611, 'encoder_test_rmse_orig': 0.6340781668568214, 'encoder_test_rmse_last': 0.844039749856424, 'decoder_val_rmse_all': 0.866415588330702, 'decoder_val_rmse_orig': 0.8378234266240421, 'decoder_test_rmse_2-step': 0.8993587433219321, 'decoder_test_rmse_3-step': 1.003863618738962, 'decoder_test_rmse_4-step': 1.0812794701169557, 'decoder_test_rmse_5-step': 1.1217891235636097, 'decoder_test_rmse_6-step': 1.197586025898549, 'method': 'gnet', 'seed': 7, 'seconds_taken': 280.6317541419994, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:33:00,625,625 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 7, 2.0)
MainProcess| 2023-05-15 06:33:00,627,627 multiprocessing INFO Running EQ_5_A ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:33:00,677,677 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:33:49,457,457 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9709324732230333, 'encoder_val_rmse_orig': 0.939028652788969, 'encoder_test_rmse_all': 1.0574304550450224, 'encoder_test_rmse_orig': 0.7747727688750439, 'encoder_test_rmse_last': 1.0454793050228535, 'decoder_val_rmse_all': 0.9709324732230333, 'decoder_val_rmse_orig': 0.939028652788969, 'decoder_test_rmse_2-step': 0.9670816508384819, 'decoder_test_rmse_3-step': 1.0695291911043199, 'decoder_test_rmse_4-step': 1.1505671024188082, 'decoder_test_rmse_5-step': 1.2295582117060522, 'decoder_test_rmse_6-step': 1.2484126200601378, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.82975832199736, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:33:49,457,457 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 06:33:49,461,461 multiprocessing INFO Running EQ_5_A rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:33:49,516,516 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:38:18,188,188 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7669744645766351, 'propensity_treatment_val_bce_orig': 0.7668941000641004, 'propensity_treatment_test_bce_all': 0.7612594241916573, 'propensity_treatment_test_bce_orig': 0.7608742651111287, 'propensity_history_val_bce_all': 0.761337504796555, 'propensity_history_val_bce_orig': 0.7614041844273097, 'propensity_history_test_bce_all': 0.7598193690153687, 'propensity_history_test_bce_orig': 0.7592593015907415, 'encoder_val_rmse_all': 1.3411220825508754, 'encoder_val_rmse_orig': 1.296032372348406, 'encoder_test_rmse_all': 1.3698445698547543, 'encoder_test_rmse_orig': 0.9905942950394444, 'encoder_test_rmse_last': 1.2298782703222533, 'decoder_val_rmse_all': 0.27118445332329766, 'decoder_val_rmse_orig': 0.27118445332329744, 'decoder_test_rmse_2-step': 1.0565207296587145, 'decoder_test_rmse_3-step': 1.0383087062385774, 'decoder_test_rmse_4-step': 1.0473734050779062, 'decoder_test_rmse_5-step': 1.0619736924788905, 'decoder_test_rmse_6-step': 1.0727386406753647, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 268.72663835500134, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:39:53,077,77 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 06:39:53,079,79 multiprocessing INFO Running EQ_5_B sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:39:53,126,126 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:40:07,171,171 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 14.091712484005257, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:40:07,172,172 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 7, 2.0)
MainProcess| 2023-05-15 06:40:07,174,174 multiprocessing INFO Running EQ_5_B crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:40:07,227,227 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:44:57,306,306 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8582882039936177, 'encoder_val_rmse_orig': 0.8302150082563414, 'encoder_test_rmse_all': 0.9227382600777286, 'encoder_test_rmse_orig': 0.6700749805610826, 'encoder_test_rmse_last': 0.7954481468142087, 'decoder_val_rmse_all': 0.33565345281154674, 'decoder_val_rmse_orig': 0.3356534528115469, 'decoder_test_rmse_2-step': 0.7826351791654375, 'decoder_test_rmse_3-step': 0.8645961194705065, 'decoder_test_rmse_4-step': 0.9527374518249991, 'decoder_test_rmse_5-step': 1.0239010237217638, 'decoder_test_rmse_6-step': 1.0515894098919496, 'method': 'crn', 'seed': 7, 'seconds_taken': 290.13157634700474, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:44:57,306,306 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 7, 2.0)
MainProcess| 2023-05-15 06:44:57,311,311 multiprocessing INFO Running EQ_5_B msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:44:57,359,359 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:45:08,107,107 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 7, 'seconds_taken': 10.796062301989878, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:45:08,107,107 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 06:45:08,110,110 multiprocessing INFO Running EQ_5_B gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:45:08,156,156 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:49:49,165,165 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.866388716379944, 'encoder_val_rmse_orig': 0.837797665381957, 'encoder_test_rmse_all': 0.8781145829297874, 'encoder_test_rmse_orig': 0.6340831970185976, 'encoder_test_rmse_last': 0.844040480204, 'decoder_val_rmse_all': 0.866388716379944, 'decoder_val_rmse_orig': 0.837797665381957, 'decoder_test_rmse_2-step': 0.899357724769937, 'decoder_test_rmse_3-step': 1.0038880180207346, 'decoder_test_rmse_4-step': 1.0812814850836783, 'decoder_test_rmse_5-step': 1.1217962907412866, 'decoder_test_rmse_6-step': 1.197598050656259, 'method': 'gnet', 'seed': 7, 'seconds_taken': 281.0547404460085, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:49:49,165,165 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 7, 2.0)
MainProcess| 2023-05-15 06:49:49,168,168 multiprocessing INFO Running EQ_5_B ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:49:49,217,217 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:50:37,857,857 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9842919209276635, 'encoder_val_rmse_orig': 0.9518655630828133, 'encoder_test_rmse_all': 1.0296770842679235, 'encoder_test_rmse_orig': 0.7543431428708064, 'encoder_test_rmse_last': 1.051713195667121, 'decoder_val_rmse_all': 0.9842919209276635, 'decoder_val_rmse_orig': 0.9518655630828133, 'decoder_test_rmse_2-step': 0.9588918011260777, 'decoder_test_rmse_3-step': 1.0577339128267682, 'decoder_test_rmse_4-step': 1.0925511943974953, 'decoder_test_rmse_5-step': 1.146995359496373, 'decoder_test_rmse_6-step': 1.1504107681192246, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.6892087150045, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:50:37,857,857 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 06:50:37,860,860 multiprocessing INFO Running EQ_5_B rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:50:37,914,914 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:55:07,207,207 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7669744645766351, 'propensity_treatment_val_bce_orig': 0.7668941000641004, 'propensity_treatment_test_bce_all': 0.7612594241916573, 'propensity_treatment_test_bce_orig': 0.7608742651111287, 'propensity_history_val_bce_all': 0.7613928725779306, 'propensity_history_val_bce_orig': 0.7614545977162687, 'propensity_history_test_bce_all': 0.7596662292685975, 'propensity_history_test_bce_orig': 0.7591533021275158, 'encoder_val_rmse_all': 1.339078283458003, 'encoder_val_rmse_orig': 1.2940522366188332, 'encoder_test_rmse_all': 1.36685563706378, 'encoder_test_rmse_orig': 0.9882936613650483, 'encoder_test_rmse_last': 1.2291308420756353, 'decoder_val_rmse_all': 0.27391733044405353, 'decoder_val_rmse_orig': 0.2739173304440537, 'decoder_test_rmse_2-step': 1.061492635423923, 'decoder_test_rmse_3-step': 1.0426651393539939, 'decoder_test_rmse_4-step': 1.0534749379373323, 'decoder_test_rmse_5-step': 1.0737885688016422, 'decoder_test_rmse_6-step': 1.0909293595227947, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 269.3462474830012, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:56:44,003,3 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 06:56:44,005,5 multiprocessing INFO Running EQ_5_C sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:56:44,056,56 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 06:56:58,254,254 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 14.248627941997256, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 06:56:58,254,254 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 7, 2.0)
MainProcess| 2023-05-15 06:56:58,257,257 multiprocessing INFO Running EQ_5_C crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 06:56:58,306,306 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:01:51,998,998 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5835113137830638, 'encoder_val_rmse_orig': 0.5679909367535703, 'encoder_test_rmse_all': 0.8317141790497793, 'encoder_test_rmse_orig': 0.6076368586180688, 'encoder_test_rmse_last': 0.819823881107925, 'decoder_val_rmse_all': 0.3409172549366703, 'decoder_val_rmse_orig': 0.3409172549366704, 'decoder_test_rmse_2-step': 0.7729504882566713, 'decoder_test_rmse_3-step': 0.8113528173187174, 'decoder_test_rmse_4-step': 0.8663412210935079, 'decoder_test_rmse_5-step': 0.9255094121529793, 'decoder_test_rmse_6-step': 0.978533084198472, 'method': 'crn', 'seed': 7, 'seconds_taken': 293.7403022869985, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:01:51,998,998 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 7, 2.0)
MainProcess| 2023-05-15 07:01:52,001,1 multiprocessing INFO Running EQ_5_C msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:01:52,048,48 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:02:02,794,794 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 7, 'seconds_taken': 10.79252214099688, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:02:02,794,794 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 07:02:02,796,796 multiprocessing INFO Running EQ_5_C gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:02:02,845,845 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:06:41,625,625 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5548096415372844, 'encoder_val_rmse_orig': 0.5396188226236266, 'encoder_test_rmse_all': 0.7737364145697926, 'encoder_test_rmse_orig': 0.5716557204680571, 'encoder_test_rmse_last': 0.917230660497475, 'decoder_val_rmse_all': 0.5548096415372844, 'decoder_val_rmse_orig': 0.5396188226236266, 'decoder_test_rmse_2-step': 0.883190960970672, 'decoder_test_rmse_3-step': 0.943795742085444, 'decoder_test_rmse_4-step': 0.9994115500668201, 'decoder_test_rmse_5-step': 1.0328701571816548, 'decoder_test_rmse_6-step': 1.0251136042503317, 'method': 'gnet', 'seed': 7, 'seconds_taken': 278.82864345100825, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:06:41,625,625 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 7, 2.0)
MainProcess| 2023-05-15 07:06:41,628,628 multiprocessing INFO Running EQ_5_C ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:06:41,678,678 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:07:30,549,549 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.728258665589244, 'encoder_val_rmse_orig': 0.7087628408260325, 'encoder_test_rmse_all': 1.0272796382513443, 'encoder_test_rmse_orig': 0.7452161114906246, 'encoder_test_rmse_last': 1.003568067917693, 'decoder_val_rmse_all': 0.728258665589244, 'decoder_val_rmse_orig': 0.7087628408260325, 'decoder_test_rmse_2-step': 1.0026080763547107, 'decoder_test_rmse_3-step': 1.063966056641282, 'decoder_test_rmse_4-step': 1.210853694411181, 'decoder_test_rmse_5-step': 1.263137488675065, 'decoder_test_rmse_6-step': 1.4048589796648507, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.92097428700072, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:07:30,549,549 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 07:07:30,552,552 multiprocessing INFO Running EQ_5_C rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:07:30,606,606 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:12:04,926,926 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7684115126860264, 'propensity_treatment_val_bce_orig': 0.7683948300003347, 'propensity_treatment_test_bce_all': 0.7558359404277444, 'propensity_treatment_test_bce_orig': 0.7593101467940255, 'propensity_history_val_bce_all': 0.7618223614890263, 'propensity_history_val_bce_orig': 0.7618570502536128, 'propensity_history_test_bce_all': 0.7515668701994604, 'propensity_history_test_bce_orig': 0.7546571853366064, 'encoder_val_rmse_all': 1.2133805853424224, 'encoder_val_rmse_orig': 1.1793088080605978, 'encoder_test_rmse_all': 1.2082672552357476, 'encoder_test_rmse_orig': 0.8771218006836664, 'encoder_test_rmse_last': 1.1648272538822673, 'decoder_val_rmse_all': 0.30831439614915657, 'decoder_val_rmse_orig': 0.3083143961491565, 'decoder_test_rmse_2-step': 1.0382910694464387, 'decoder_test_rmse_3-step': 1.0346385320221925, 'decoder_test_rmse_4-step': 1.020836812318013, 'decoder_test_rmse_5-step': 1.0004452024454478, 'decoder_test_rmse_6-step': 0.9825335744549104, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 274.37362816800305, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:13:39,429,429 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 07:13:39,432,432 multiprocessing INFO Running EQ_5_D sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:13:39,482,482 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:13:52,251,251 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 12.819040179994772, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:13:52,252,252 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 7, 2.0)
MainProcess| 2023-05-15 07:13:52,254,254 multiprocessing INFO Running EQ_5_D crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:13:52,306,306 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:18:47,913,913 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6033691203682158, 'encoder_val_rmse_orig': 0.5932968047875304, 'encoder_test_rmse_all': 0.8066605726519059, 'encoder_test_rmse_orig': 0.5816995055574965, 'encoder_test_rmse_last': 0.7033289124442184, 'decoder_val_rmse_all': 0.4050907726139946, 'decoder_val_rmse_orig': 0.4050907726139948, 'decoder_test_rmse_2-step': 0.8689231489539042, 'decoder_test_rmse_3-step': 0.9632676169801013, 'decoder_test_rmse_4-step': 1.0099995873608223, 'decoder_test_rmse_5-step': 1.036528959793105, 'decoder_test_rmse_6-step': 1.0322345230237406, 'method': 'crn', 'seed': 7, 'seconds_taken': 295.65844843800005, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:18:47,913,913 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 7, 2.0)
MainProcess| 2023-05-15 07:18:47,916,916 multiprocessing INFO Running EQ_5_D msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:18:47,965,965 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:18:59,057,57 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 7, 'seconds_taken': 11.140476673986996, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:18:59,057,57 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 07:18:59,060,60 multiprocessing INFO Running EQ_5_D gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:18:59,106,106 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:23:36,399,399 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6515462543322286, 'encoder_val_rmse_orig': 0.6419969498981833, 'encoder_test_rmse_all': 0.7983104362948933, 'encoder_test_rmse_orig': 0.5905554162743696, 'encoder_test_rmse_last': 0.7573273086044661, 'decoder_val_rmse_all': 0.6515462543322286, 'decoder_val_rmse_orig': 0.6419969498981833, 'decoder_test_rmse_2-step': 0.9897818732119346, 'decoder_test_rmse_3-step': 1.1443047732859521, 'decoder_test_rmse_4-step': 1.170147793943067, 'decoder_test_rmse_5-step': 1.1759776894883724, 'decoder_test_rmse_6-step': 1.1645209071675384, 'method': 'gnet', 'seed': 7, 'seconds_taken': 277.3386503720103, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:23:36,399,399 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 7, 2.0)
MainProcess| 2023-05-15 07:23:36,402,402 multiprocessing INFO Running EQ_5_D ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:23:36,454,454 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:24:25,701,701 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8530572671195484, 'encoder_val_rmse_orig': 0.8391687052165283, 'encoder_test_rmse_all': 1.0664434651260357, 'encoder_test_rmse_orig': 0.7703717230014159, 'encoder_test_rmse_last': 1.006656148074564, 'decoder_val_rmse_all': 0.8530572671195484, 'decoder_val_rmse_orig': 0.8391687052165283, 'decoder_test_rmse_2-step': 1.1856567932815294, 'decoder_test_rmse_3-step': 1.1940896384853388, 'decoder_test_rmse_4-step': 1.1764778962800873, 'decoder_test_rmse_5-step': 1.1781129873847964, 'decoder_test_rmse_6-step': 1.1434197023595147, 'method': 'ct', 'seed': 7, 'seconds_taken': 49.29836197900295, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:24:25,701,701 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 07:24:25,705,705 multiprocessing INFO Running EQ_5_D rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:24:25,758,758 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:28:56,176,176 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7682716032033742, 'propensity_treatment_val_bce_orig': 0.7682553821726084, 'propensity_treatment_test_bce_all': 0.7557073856933749, 'propensity_treatment_test_bce_orig': 0.7598313140941059, 'propensity_history_val_bce_all': 0.7612933340061293, 'propensity_history_val_bce_orig': 0.7613073679066816, 'propensity_history_test_bce_all': 0.7529303039344478, 'propensity_history_test_bce_orig': 0.7559941761015488, 'encoder_val_rmse_all': 1.265095852999298, 'encoder_val_rmse_orig': 1.241772661846641, 'encoder_test_rmse_all': 1.2929406380269413, 'encoder_test_rmse_orig': 0.9293537246958065, 'encoder_test_rmse_last': 1.1333294329176393, 'decoder_val_rmse_all': 0.35188840928638393, 'decoder_val_rmse_orig': 0.35188840928638343, 'decoder_test_rmse_2-step': 1.2285404236316164, 'decoder_test_rmse_3-step': 1.2153705592660853, 'decoder_test_rmse_4-step': 1.1609442817891775, 'decoder_test_rmse_5-step': 1.1054375584270515, 'decoder_test_rmse_6-step': 1.0447604128436196, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 270.4709715600038, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:30:24,637,637 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 07:30:24,640,640 multiprocessing INFO Running EQ_4_A sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:30:24,691,691 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:30:28,354,354 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 3.7138987069920404, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:30:28,355,355 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 7, 2.0)
MainProcess| 2023-05-15 07:30:28,357,357 multiprocessing INFO Running EQ_4_A wsindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:30:28,408,408 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:30:33,898,898 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13168856861510253, 'encoder_test_rmse_orig': 0.11138353812525659, 'encoder_test_rmse_last': 0.11138452921871814, 'decoder_test_rmse_2-step': 0.11129885178475783, 'decoder_test_rmse_3-step': 0.1109400240295072, 'decoder_test_rmse_4-step': 0.1102307736214512, 'decoder_test_rmse_5-step': 0.10914475583140618, 'decoder_test_rmse_6-step': 0.10768758210186835, 'global_equation_string': 'Treatment 0: x_dot = +-1.0083937286365978*x0*u0 | Treatment 1: x_dot = +-1.0084088685992567*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 7, 'seconds_taken': 5.540396099007921, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:30:33,898,898 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 7, 2.0)
MainProcess| 2023-05-15 07:30:33,901,901 multiprocessing INFO Running EQ_4_A crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:30:33,946,946 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:35:31,793,793 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2949245640486817, 'encoder_val_rmse_orig': 1.2949245640486817, 'encoder_test_rmse_all': 0.9434369269351339, 'encoder_test_rmse_orig': 1.2951113314471867, 'encoder_test_rmse_last': 1.312629241133153, 'decoder_val_rmse_all': 0.35339631329296073, 'decoder_val_rmse_orig': 0.3533963132929607, 'decoder_test_rmse_2-step': 0.852560010006073, 'decoder_test_rmse_3-step': 0.8828460085571702, 'decoder_test_rmse_4-step': 0.9732634717929366, 'decoder_test_rmse_5-step': 1.0736516293112013, 'decoder_test_rmse_6-step': 1.1755700205328092, 'method': 'crn', 'seed': 7, 'seconds_taken': 297.8915774769994, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:35:31,793,793 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 7, 2.0)
MainProcess| 2023-05-15 07:35:31,795,795 multiprocessing INFO Running EQ_4_A msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:35:31,844,844 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:35:37,272,272 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 7, 'seconds_taken': 5.476785726990784, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:35:37,273,273 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 07:35:37,276,276 multiprocessing INFO Running EQ_4_A gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:35:37,321,321 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:40:02,915,915 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5568029985449904, 'encoder_val_rmse_orig': 0.5568029985449904, 'encoder_test_rmse_all': 0.5690670019784985, 'encoder_test_rmse_orig': 0.5566697681274216, 'encoder_test_rmse_last': 0.5576261234380269, 'decoder_val_rmse_all': 0.5568029985449904, 'decoder_val_rmse_orig': 0.5568029985449904, 'decoder_test_rmse_2-step': 0.7349413972009455, 'decoder_test_rmse_3-step': 0.8450097057412895, 'decoder_test_rmse_4-step': 0.923975757071247, 'decoder_test_rmse_5-step': 0.9902589352676804, 'decoder_test_rmse_6-step': 1.0417742796661142, 'method': 'gnet', 'seed': 7, 'seconds_taken': 265.6395088099962, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:40:02,915,915 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 7, 2.0)
MainProcess| 2023-05-15 07:40:02,918,918 multiprocessing INFO Running EQ_4_A ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:40:02,964,964 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:40:51,492,492 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.371221213686075, 'encoder_val_rmse_orig': 0.371221213686075, 'encoder_test_rmse_all': 0.47935708962513135, 'encoder_test_rmse_orig': 0.37902589188994906, 'encoder_test_rmse_last': 0.5574943349196085, 'decoder_val_rmse_all': 0.371221213686075, 'decoder_val_rmse_orig': 0.371221213686075, 'decoder_test_rmse_2-step': 0.6540396629703232, 'decoder_test_rmse_3-step': 0.8270275531336315, 'decoder_test_rmse_4-step': 0.8927974284024247, 'decoder_test_rmse_5-step': 0.9510967469843574, 'decoder_test_rmse_6-step': 0.9292013059854024, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.573125050010276, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:40:51,492,492 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 07:40:51,494,494 multiprocessing INFO Running EQ_4_A rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:40:51,549,549 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:45:28,577,577 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4944830465720872, 'propensity_treatment_val_bce_orig': 0.49448304657208725, 'propensity_treatment_test_bce_all': 0.5082775029711805, 'propensity_treatment_test_bce_orig': 0.5155845574107062, 'propensity_history_val_bce_all': 0.4920333105325699, 'propensity_history_val_bce_orig': 0.4920333105325698, 'propensity_history_test_bce_all': 0.504725725835326, 'propensity_history_test_bce_orig': 0.513290254470058, 'encoder_val_rmse_all': 2.9910621437168285, 'encoder_val_rmse_orig': 2.991062143716829, 'encoder_test_rmse_all': 4.1376410795551495, 'encoder_test_rmse_orig': 2.994969701579722, 'encoder_test_rmse_last': 3.0642611165903753, 'decoder_val_rmse_all': 0.27602808071448626, 'decoder_val_rmse_orig': 0.2760280807144861, 'decoder_test_rmse_2-step': 2.6713196600652527, 'decoder_test_rmse_3-step': 2.3745581061354866, 'decoder_test_rmse_4-step': 2.1361476286184224, 'decoder_test_rmse_5-step': 1.937550664659216, 'decoder_test_rmse_6-step': 1.7802394916188, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 277.08214728000166, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:46:54,829,829 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 07:46:54,832,832 multiprocessing INFO Running EQ_4_B sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:46:54,880,880 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:46:58,534,534 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 3.7024539970007027, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:46:58,535,535 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 7, 2.0)
MainProcess| 2023-05-15 07:46:58,537,537 multiprocessing INFO Running EQ_4_B wsindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:46:58,587,587 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:47:04,312,312 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13349225278022914, 'encoder_test_rmse_orig': 0.11335657325511386, 'encoder_test_rmse_last': 0.11344493809187775, 'decoder_test_rmse_2-step': 0.113274227692717, 'decoder_test_rmse_3-step': 0.11299130329010837, 'decoder_test_rmse_4-step': 0.11234515548309959, 'decoder_test_rmse_5-step': 0.11108606654949367, 'decoder_test_rmse_6-step': 0.10965857061801848, 'global_equation_string': 'Treatment 0: x_dot = +-1.008377638116637*x0*u0 | Treatment 1: x_dot = +-1.0084281086993006*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 7, 'seconds_taken': 5.774976152999443, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:47:04,313,313 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 7, 2.0)
MainProcess| 2023-05-15 07:47:04,315,315 multiprocessing INFO Running EQ_4_B crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:47:04,367,367 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:52:08,135,135 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2931186064659081, 'encoder_val_rmse_orig': 1.2931186064659081, 'encoder_test_rmse_all': 0.9435028563503064, 'encoder_test_rmse_orig': 1.2934781711056746, 'encoder_test_rmse_last': 1.3108399878722445, 'decoder_val_rmse_all': 0.35483193468673974, 'decoder_val_rmse_orig': 0.3548319346867399, 'decoder_test_rmse_2-step': 0.8529560388511018, 'decoder_test_rmse_3-step': 0.8836537160342021, 'decoder_test_rmse_4-step': 0.9744625963477077, 'decoder_test_rmse_5-step': 1.0754742255689833, 'decoder_test_rmse_6-step': 1.1783384409671325, 'method': 'crn', 'seed': 7, 'seconds_taken': 303.8193143440003, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:52:08,135,135 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 7, 2.0)
MainProcess| 2023-05-15 07:52:08,138,138 multiprocessing INFO Running EQ_4_B msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:52:08,185,185 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:52:13,634,634 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 7, 'seconds_taken': 5.496277960002772, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:52:13,635,635 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 07:52:13,637,637 multiprocessing INFO Running EQ_4_B gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:52:13,685,685 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:56:35,688,688 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5568350930475379, 'encoder_val_rmse_orig': 0.5568350930475379, 'encoder_test_rmse_all': 0.569291954102547, 'encoder_test_rmse_orig': 0.556772735445892, 'encoder_test_rmse_last': 0.5576069765926465, 'decoder_val_rmse_all': 0.5568350930475379, 'decoder_val_rmse_orig': 0.5568350930475379, 'decoder_test_rmse_2-step': 0.7350579685762074, 'decoder_test_rmse_3-step': 0.8451179112685552, 'decoder_test_rmse_4-step': 0.9240844338399448, 'decoder_test_rmse_5-step': 0.9902064608265738, 'decoder_test_rmse_6-step': 1.0418650736672461, 'method': 'gnet', 'seed': 7, 'seconds_taken': 262.05064710299484, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:56:35,688,688 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 7, 2.0)
MainProcess| 2023-05-15 07:56:35,691,691 multiprocessing INFO Running EQ_4_B ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:56:35,743,743 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 07:57:23,871,871 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3930189080614056, 'encoder_val_rmse_orig': 0.3930189080614056, 'encoder_test_rmse_all': 0.5111901509178708, 'encoder_test_rmse_orig': 0.40004621473867874, 'encoder_test_rmse_last': 0.568254672914259, 'decoder_val_rmse_all': 0.3930189080614056, 'decoder_val_rmse_orig': 0.3930189080614056, 'decoder_test_rmse_2-step': 0.6861400004014485, 'decoder_test_rmse_3-step': 0.8678930304611189, 'decoder_test_rmse_4-step': 0.9389202699088498, 'decoder_test_rmse_5-step': 0.9883322417846341, 'decoder_test_rmse_6-step': 0.9639296019708067, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.1798249350104, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 07:57:23,871,871 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 07:57:23,874,874 multiprocessing INFO Running EQ_4_B rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 07:57:23,927,927 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:02:02,440,440 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4944830465720872, 'propensity_treatment_val_bce_orig': 0.49448304657208725, 'propensity_treatment_test_bce_all': 0.5082775029711805, 'propensity_treatment_test_bce_orig': 0.5155845574107062, 'propensity_history_val_bce_all': 0.4921016481367208, 'propensity_history_val_bce_orig': 0.49210164813672086, 'propensity_history_test_bce_all': 0.504857236541513, 'propensity_history_test_bce_orig': 0.5133575666925932, 'encoder_val_rmse_all': 3.0039352297009496, 'encoder_val_rmse_orig': 3.0039352297009487, 'encoder_test_rmse_all': 4.155333848780222, 'encoder_test_rmse_orig': 3.0077420738293967, 'encoder_test_rmse_last': 3.077285084534937, 'decoder_val_rmse_all': 0.27799281108026985, 'decoder_val_rmse_orig': 0.27799281108026996, 'decoder_test_rmse_2-step': 2.6874406172437357, 'decoder_test_rmse_3-step': 2.3880721651049353, 'decoder_test_rmse_4-step': 2.147167915563339, 'decoder_test_rmse_5-step': 1.9457068022393924, 'decoder_test_rmse_6-step': 1.7850280818755515, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 278.5659223640105, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:03:31,652,652 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 08:03:31,654,654 multiprocessing INFO Running EQ_4_C sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:03:31,706,706 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:03:35,234,234 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 3.5789373839943437, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:03:35,234,234 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 7, 2.0)
MainProcess| 2023-05-15 08:03:35,237,237 multiprocessing INFO Running EQ_4_C wsindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:03:35,287,287 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:03:40,885,885 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.15252961937291445, 'encoder_test_rmse_orig': 0.12439474305868331, 'encoder_test_rmse_last': 0.12440245765862157, 'decoder_test_rmse_2-step': 0.12411358265927051, 'decoder_test_rmse_3-step': 0.12344099062374765, 'decoder_test_rmse_4-step': 0.12218559242559249, 'decoder_test_rmse_5-step': 0.12007130427204359, 'decoder_test_rmse_6-step': 0.11764017037746398, 'global_equation_string': 'Treatment 0: x_dot = +-0.046050243088060425*x0+-1.0181559225541146*x0*u0 | Treatment 1: x_dot = +-0.1464415657373087*x0+-1.0215081033106017*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 7, 'seconds_taken': 5.647874521004269, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:03:40,885,885 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 7, 2.0)
MainProcess| 2023-05-15 08:03:40,888,888 multiprocessing INFO Running EQ_4_C crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:03:40,938,938 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:08:39,403,403 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.4115794854782941, 'encoder_val_rmse_orig': 1.4115794854782941, 'encoder_test_rmse_all': 1.0676312312747558, 'encoder_test_rmse_orig': 1.41249698652768, 'encoder_test_rmse_last': 1.4254172840331707, 'decoder_val_rmse_all': 0.2919069435655284, 'decoder_val_rmse_orig': 0.2919069435655283, 'decoder_test_rmse_2-step': 0.5291503680160616, 'decoder_test_rmse_3-step': 0.526415720892626, 'decoder_test_rmse_4-step': 0.6254503234611897, 'decoder_test_rmse_5-step': 0.7335397780584438, 'decoder_test_rmse_6-step': 0.8353780399590364, 'method': 'crn', 'seed': 7, 'seconds_taken': 298.5152407909918, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:08:39,403,403 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 7, 2.0)
MainProcess| 2023-05-15 08:08:39,407,407 multiprocessing INFO Running EQ_4_C msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:08:39,456,456 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:08:44,954,954 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 7, 'seconds_taken': 5.5465687430114485, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:08:44,954,954 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 08:08:44,957,957 multiprocessing INFO Running EQ_4_C gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:08:45,003,3 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:13:10,607,607 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.454203685948925, 'encoder_val_rmse_orig': 0.454203685948925, 'encoder_test_rmse_all': 0.5132268576181636, 'encoder_test_rmse_orig': 0.45399384956051414, 'encoder_test_rmse_last': 0.4559768577291878, 'decoder_val_rmse_all': 0.454203685948925, 'decoder_val_rmse_orig': 0.454203685948925, 'decoder_test_rmse_2-step': 0.6165968698770159, 'decoder_test_rmse_3-step': 0.7037069642750139, 'decoder_test_rmse_4-step': 0.7599374281616973, 'decoder_test_rmse_5-step': 0.8033348471810827, 'decoder_test_rmse_6-step': 0.8326700165034657, 'method': 'gnet', 'seed': 7, 'seconds_taken': 265.6490877830074, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:13:10,607,607 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 7, 2.0)
MainProcess| 2023-05-15 08:13:10,609,609 multiprocessing INFO Running EQ_4_C ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:13:10,658,658 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:13:58,964,964 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.42963063924015027, 'encoder_val_rmse_orig': 0.42963063924015027, 'encoder_test_rmse_all': 0.5726746229878217, 'encoder_test_rmse_orig': 0.43067000922280263, 'encoder_test_rmse_last': 0.4774771772435568, 'decoder_val_rmse_all': 0.42963063924015027, 'decoder_val_rmse_orig': 0.42963063924015027, 'decoder_test_rmse_2-step': 0.6656142283794175, 'decoder_test_rmse_3-step': 0.8208990087668357, 'decoder_test_rmse_4-step': 0.8910787946597698, 'decoder_test_rmse_5-step': 0.917198416816681, 'decoder_test_rmse_6-step': 0.8848514847088109, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.3546589280013, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:13:58,964,964 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 08:13:58,967,967 multiprocessing INFO Running EQ_4_C rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:13:59,023,23 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:18:35,347,347 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4944830465720872, 'propensity_treatment_val_bce_orig': 0.49448304657208725, 'propensity_treatment_test_bce_all': 0.5082775029711805, 'propensity_treatment_test_bce_orig': 0.5155845574107062, 'propensity_history_val_bce_all': 0.4919984691375393, 'propensity_history_val_bce_orig': 0.49199846913753925, 'propensity_history_test_bce_all': 0.5046564895311991, 'propensity_history_test_bce_orig': 0.5132560966150892, 'encoder_val_rmse_all': 2.6992243098450577, 'encoder_val_rmse_orig': 2.6992243098450577, 'encoder_test_rmse_all': 3.738041945121231, 'encoder_test_rmse_orig': 2.7030105878370203, 'encoder_test_rmse_last': 2.7829509263952534, 'decoder_val_rmse_all': 0.1641266138340918, 'decoder_val_rmse_orig': 0.1641266138340917, 'decoder_test_rmse_2-step': 2.4000666215761903, 'decoder_test_rmse_3-step': 2.1303926225124505, 'decoder_test_rmse_4-step': 1.9117619245280475, 'decoder_test_rmse_5-step': 1.7217574320983722, 'decoder_test_rmse_6-step': 1.558950862228863, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 276.3796319979883, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:20:05,479,479 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 7, 2.0)
MainProcess| 2023-05-15 08:20:05,482,482 multiprocessing INFO Running EQ_4_D sindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:20:05,532,532 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:20:09,358,358 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 7, 'seconds_taken': 3.876091637997888, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:20:09,359,359 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 7, 2.0)
MainProcess| 2023-05-15 08:20:09,361,361 multiprocessing INFO Running EQ_4_D wsindy 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:20:09,413,413 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:20:15,105,105 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.11968494431558697, 'encoder_test_rmse_orig': 0.10162607594957572, 'encoder_test_rmse_last': 0.10207734136204502, 'decoder_test_rmse_2-step': 0.10216383545044376, 'decoder_test_rmse_3-step': 0.1024907200065574, 'decoder_test_rmse_4-step': 0.10250278470475707, 'decoder_test_rmse_5-step': 0.10221236004830592, 'decoder_test_rmse_6-step': 0.10138408623469605, 'global_equation_string': 'Treatment 0: x_dot = +0.19779003119911637*x0+-1.0096363473439203*x0*u0 | Treatment 1: x_dot = +-0.09078184409635841*x0+-1.0204492758103652*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 7, 'seconds_taken': 5.742930118998629, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:20:15,105,105 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 7, 2.0)
MainProcess| 2023-05-15 08:20:15,107,107 multiprocessing INFO Running EQ_4_D crn 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:20:15,158,158 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:25:18,685,685 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.3133204058115542, 'encoder_val_rmse_orig': 1.3133204058115542, 'encoder_test_rmse_all': 1.0679626610827997, 'encoder_test_rmse_orig': 1.3302184039774247, 'encoder_test_rmse_last': 1.4758038324978928, 'decoder_val_rmse_all': 0.4213726572401069, 'decoder_val_rmse_orig': 0.42137265724010686, 'decoder_test_rmse_2-step': 2.141655836407643, 'decoder_test_rmse_3-step': 2.056526747119757, 'decoder_test_rmse_4-step': 2.0365168130937468, 'decoder_test_rmse_5-step': 2.044376276007909, 'decoder_test_rmse_6-step': 2.06796210836599, 'method': 'crn', 'seed': 7, 'seconds_taken': 303.5770892899891, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:25:18,685,685 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 7, 2.0)
MainProcess| 2023-05-15 08:25:18,689,689 multiprocessing INFO Running EQ_4_D msm 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:25:18,733,733 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:25:24,179,179 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 7, 'seconds_taken': 5.489669498012518, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:25:24,179,179 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 7, 2.0)
MainProcess| 2023-05-15 08:25:24,182,182 multiprocessing INFO Running EQ_4_D gnet 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:25:24,230,230 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:29:46,753,753 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7109582217390676, 'encoder_val_rmse_orig': 0.7109582217390675, 'encoder_test_rmse_all': 0.6901491000994007, 'encoder_test_rmse_orig': 0.7114649007683648, 'encoder_test_rmse_last': 0.7190531957617982, 'decoder_val_rmse_all': 0.7109582217390676, 'decoder_val_rmse_orig': 0.7109582217390675, 'decoder_test_rmse_2-step': 0.7680488382752179, 'decoder_test_rmse_3-step': 0.8080756348611826, 'decoder_test_rmse_4-step': 0.8460458788749663, 'decoder_test_rmse_5-step': 0.8822272321573364, 'decoder_test_rmse_6-step': 0.9135921600824328, 'method': 'gnet', 'seed': 7, 'seconds_taken': 262.571701998997, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:29:46,754,754 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 7, 2.0)
MainProcess| 2023-05-15 08:29:46,756,756 multiprocessing INFO Running EQ_4_D ct 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:29:46,805,805 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:30:34,824,824 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.46827760083219, 'encoder_val_rmse_orig': 0.46827760083218994, 'encoder_test_rmse_all': 0.6136661006316001, 'encoder_test_rmse_orig': 0.48524045617443856, 'encoder_test_rmse_last': 0.6540685084484934, 'decoder_val_rmse_all': 0.46827760083219, 'decoder_val_rmse_orig': 0.46827760083218994, 'decoder_test_rmse_2-step': 0.8605959110415572, 'decoder_test_rmse_3-step': 1.102726466145251, 'decoder_test_rmse_4-step': 1.2408290000084896, 'decoder_test_rmse_5-step': 1.3494385213356823, 'decoder_test_rmse_6-step': 1.3811922071502223, 'method': 'ct', 'seed': 7, 'seconds_taken': 48.06723211199278, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:30:34,824,824 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 7, 2.0)
MainProcess| 2023-05-15 08:30:34,827,827 multiprocessing INFO Running EQ_4_D rmsn 7 | domain_conf=2.0
MainProcess| 2023-05-15 08:30:34,877,877 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 7, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:35:13,751,751 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.502106423236556, 'propensity_treatment_val_bce_orig': 0.502106423236556, 'propensity_treatment_test_bce_all': 0.5155752723503247, 'propensity_treatment_test_bce_orig': 0.5224165120306484, 'propensity_history_val_bce_all': 0.49975456558546777, 'propensity_history_val_bce_orig': 0.4997545655854677, 'propensity_history_test_bce_all': 0.5122318616208889, 'propensity_history_test_bce_orig': 0.5202198086884549, 'encoder_val_rmse_all': 2.6058097783392773, 'encoder_val_rmse_orig': 2.6058097783392773, 'encoder_test_rmse_all': 3.572697940081072, 'encoder_test_rmse_orig': 2.6144341646039817, 'encoder_test_rmse_last': 2.7322470039362585, 'decoder_val_rmse_all': 0.2159634680492015, 'decoder_val_rmse_orig': 0.21596346804920158, 'decoder_test_rmse_2-step': 2.458849608474586, 'decoder_test_rmse_3-step': 2.2640283574129474, 'decoder_test_rmse_4-step': 2.1194481656524378, 'decoder_test_rmse_5-step': 1.985441448311895, 'decoder_test_rmse_6-step': 1.8671899350628784, 'method': 'rmsn', 'seed': 7, 'seconds_taken': 278.9239259830065, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:36:37,664,664 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 08:36:37,666,666 multiprocessing INFO Running cancer_sim sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:36:37,717,717 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:36:51,409,409 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 13.742630828986876, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:36:51,409,409 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 8, 2.0)
MainProcess| 2023-05-15 08:36:51,412,412 multiprocessing INFO Running cancer_sim crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:36:51,464,464 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:41:41,437,437 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1049081158743712, 'encoder_val_rmse_orig': 1.0588420033893058, 'encoder_test_rmse_all': 0.7602901858318203, 'encoder_test_rmse_orig': 0.5726572606323046, 'encoder_test_rmse_last': 0.7245883962432419, 'decoder_val_rmse_all': 0.3407967982896573, 'decoder_val_rmse_orig': 0.34079679828965725, 'decoder_test_rmse_2-step': 0.672821387574632, 'decoder_test_rmse_3-step': 0.7379747464308162, 'decoder_test_rmse_4-step': 0.8164028571077406, 'decoder_test_rmse_5-step': 0.8879596837112523, 'decoder_test_rmse_6-step': 0.9495579027430738, 'method': 'crn', 'seed': 8, 'seconds_taken': 290.02461139699153, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:41:41,437,437 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 8, 2.0)
MainProcess| 2023-05-15 08:41:41,440,440 multiprocessing INFO Running cancer_sim msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:41:41,488,488 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:41:52,105,105 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 8, 'seconds_taken': 10.66454206299386, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:41:52,105,105 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 08:41:52,108,108 multiprocessing INFO Running cancer_sim gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:41:52,156,156 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:46:28,178,178 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.123096506746594, 'encoder_val_rmse_orig': 1.077117211565399, 'encoder_test_rmse_all': 0.7400251042513426, 'encoder_test_rmse_orig': 0.5695051252045913, 'encoder_test_rmse_last': 0.6902075699608785, 'decoder_val_rmse_all': 1.123096506746594, 'decoder_val_rmse_orig': 1.077117211565399, 'decoder_test_rmse_2-step': 0.8363370814259409, 'decoder_test_rmse_3-step': 0.9824943391785612, 'decoder_test_rmse_4-step': 1.046324792049011, 'decoder_test_rmse_5-step': 1.107434356200485, 'decoder_test_rmse_6-step': 1.1628333965312172, 'method': 'gnet', 'seed': 8, 'seconds_taken': 276.0695222159993, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:46:28,178,178 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 8, 2.0)
MainProcess| 2023-05-15 08:46:28,181,181 multiprocessing INFO Running cancer_sim ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:46:28,229,229 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:47:18,542,542 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.008179881120125, 'encoder_val_rmse_orig': 0.9673268585405046, 'encoder_test_rmse_all': 0.8518239216740473, 'encoder_test_rmse_orig': 0.6460981295435171, 'encoder_test_rmse_last': 0.7497997838633318, 'decoder_val_rmse_all': 1.008179881120125, 'decoder_val_rmse_orig': 0.9673268585405046, 'decoder_test_rmse_2-step': 0.8327864369610902, 'decoder_test_rmse_3-step': 0.8997422582436534, 'decoder_test_rmse_4-step': 0.9792443527078745, 'decoder_test_rmse_5-step': 1.023005370677895, 'decoder_test_rmse_6-step': 1.0343609322504912, 'method': 'ct', 'seed': 8, 'seconds_taken': 50.36126038400107, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:47:18,542,542 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 08:47:18,545,545 multiprocessing INFO Running cancer_sim rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:47:18,599,599 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:51:46,460,460 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7689713851730096, 'propensity_treatment_val_bce_orig': 0.7688892038824986, 'propensity_treatment_test_bce_all': 0.7607436346135256, 'propensity_treatment_test_bce_orig': 0.7628106061642268, 'propensity_history_val_bce_all': 0.7614123353654199, 'propensity_history_val_bce_orig': 0.761445190645715, 'propensity_history_test_bce_all': 0.7561475693385511, 'propensity_history_test_bce_orig': 0.75794388320537, 'encoder_val_rmse_all': 1.3184111502245142, 'encoder_val_rmse_orig': 1.2628560766231915, 'encoder_test_rmse_all': 0.9353069777305099, 'encoder_test_rmse_orig': 0.6947360629933607, 'encoder_test_rmse_last': 0.8455876966094024, 'decoder_val_rmse_all': 0.31642927730309134, 'decoder_val_rmse_orig': 0.31642927730309134, 'decoder_test_rmse_2-step': 0.8358329745454431, 'decoder_test_rmse_3-step': 0.8657811221099112, 'decoder_test_rmse_4-step': 0.8809381902627016, 'decoder_test_rmse_5-step': 0.9002924293806709, 'decoder_test_rmse_6-step': 0.9220918445586714, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 267.9153169869969, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:54:01,815,815 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 08:54:01,818,818 multiprocessing INFO Running EQ_5_A sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:54:01,866,866 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:54:16,136,136 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 14.318095050010015, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:54:16,136,136 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 8, 2.0)
MainProcess| 2023-05-15 08:54:16,139,139 multiprocessing INFO Running EQ_5_A crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:54:16,187,187 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:59:07,091,91 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8347997378242463, 'encoder_val_rmse_orig': 0.8076364673248275, 'encoder_test_rmse_all': 0.9105152350832164, 'encoder_test_rmse_orig': 0.6608897042172818, 'encoder_test_rmse_last': 0.7879399117982595, 'decoder_val_rmse_all': 0.3407506218079113, 'decoder_val_rmse_orig': 0.3407506218079114, 'decoder_test_rmse_2-step': 0.7826772812817928, 'decoder_test_rmse_3-step': 0.8742542183857718, 'decoder_test_rmse_4-step': 0.96515006158222, 'decoder_test_rmse_5-step': 1.0410462853099, 'decoder_test_rmse_6-step': 1.0774646200196352, 'method': 'crn', 'seed': 8, 'seconds_taken': 290.951751821005, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:59:07,091,91 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 8, 2.0)
MainProcess| 2023-05-15 08:59:07,094,94 multiprocessing INFO Running EQ_5_A msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:59:07,142,142 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 08:59:17,777,777 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 8, 'seconds_taken': 10.683061696996447, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 08:59:17,777,777 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 08:59:17,780,780 multiprocessing INFO Running EQ_5_A gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 08:59:17,830,830 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:04:04,029,29 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8755925902648793, 'encoder_val_rmse_orig': 0.8467698809490144, 'encoder_test_rmse_all': 0.8558106013427307, 'encoder_test_rmse_orig': 0.6186682215875522, 'encoder_test_rmse_last': 0.8092564513414481, 'decoder_val_rmse_all': 0.8755925902648793, 'decoder_val_rmse_orig': 0.8467698809490144, 'decoder_test_rmse_2-step': 0.8435290623964969, 'decoder_test_rmse_3-step': 0.9606956116251281, 'decoder_test_rmse_4-step': 1.0321428186165464, 'decoder_test_rmse_5-step': 1.1078168217677828, 'decoder_test_rmse_6-step': 1.1503574732474164, 'method': 'gnet', 'seed': 8, 'seconds_taken': 286.24880740199296, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:04:04,029,29 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 8, 2.0)
MainProcess| 2023-05-15 09:04:04,032,32 multiprocessing INFO Running EQ_5_A ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:04:04,082,82 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:04:53,170,170 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9866490324714896, 'encoder_val_rmse_orig': 0.9542086208592857, 'encoder_test_rmse_all': 1.160018871043435, 'encoder_test_rmse_orig': 0.8510569228316684, 'encoder_test_rmse_last': 1.1045699472275674, 'decoder_val_rmse_all': 0.9866490324714896, 'decoder_val_rmse_orig': 0.9542086208592857, 'decoder_test_rmse_2-step': 0.9933290194847767, 'decoder_test_rmse_3-step': 1.1337931754862263, 'decoder_test_rmse_4-step': 1.2122740223582105, 'decoder_test_rmse_5-step': 1.2860282496367301, 'decoder_test_rmse_6-step': 1.2587729667570835, 'method': 'ct', 'seed': 8, 'seconds_taken': 49.138234918995295, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:04:53,170,170 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 09:04:53,173,173 multiprocessing INFO Running EQ_5_A rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:04:53,226,226 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:09:22,585,585 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7678453904163713, 'propensity_treatment_val_bce_orig': 0.7677821521136491, 'propensity_treatment_test_bce_all': 0.7621672542270786, 'propensity_treatment_test_bce_orig': 0.7619567925241897, 'propensity_history_val_bce_all': 0.7596813061843682, 'propensity_history_val_bce_orig': 0.7596810892426817, 'propensity_history_test_bce_all': 0.758217380515929, 'propensity_history_test_bce_orig': 0.7571669345478509, 'encoder_val_rmse_all': 1.513518247287944, 'encoder_val_rmse_orig': 1.4624036759004317, 'encoder_test_rmse_all': 1.5687059522640614, 'encoder_test_rmse_orig': 1.1292246287907486, 'encoder_test_rmse_last': 1.280795272237743, 'decoder_val_rmse_all': 0.2640497162832491, 'decoder_val_rmse_orig': 0.26404971628324936, 'decoder_test_rmse_2-step': 1.176405679445437, 'decoder_test_rmse_3-step': 1.1321282413687945, 'decoder_test_rmse_4-step': 1.1298341872024826, 'decoder_test_rmse_5-step': 1.1338997774202693, 'decoder_test_rmse_6-step': 1.1245354294754062, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 269.4110010500008, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:10:58,110,110 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 09:10:58,113,113 multiprocessing INFO Running EQ_5_B sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:10:58,164,164 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:11:12,447,447 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 14.334200701996451, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:11:12,447,447 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 8, 2.0)
MainProcess| 2023-05-15 09:11:12,450,450 multiprocessing INFO Running EQ_5_B crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:11:12,502,502 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:16:05,517,517 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.834761842296022, 'encoder_val_rmse_orig': 0.8076000038596088, 'encoder_test_rmse_all': 0.9105188687738617, 'encoder_test_rmse_orig': 0.6608925124336545, 'encoder_test_rmse_last': 0.787957653324236, 'decoder_val_rmse_all': 0.34074239336759776, 'decoder_val_rmse_orig': 0.3407423933675982, 'decoder_test_rmse_2-step': 0.7826725722669065, 'decoder_test_rmse_3-step': 0.8742492621616527, 'decoder_test_rmse_4-step': 0.9651391127487012, 'decoder_test_rmse_5-step': 1.04103637571813, 'decoder_test_rmse_6-step': 1.0774543535674197, 'method': 'crn', 'seed': 8, 'seconds_taken': 293.06637994501216, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:16:05,517,517 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 8, 2.0)
MainProcess| 2023-05-15 09:16:05,521,521 multiprocessing INFO Running EQ_5_B msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:16:05,568,568 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:16:16,130,130 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 8, 'seconds_taken': 10.608707179009798, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:16:16,130,130 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 09:16:16,133,133 multiprocessing INFO Running EQ_5_B gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:16:16,181,181 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:20:58,149,149 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8755458749615306, 'encoder_val_rmse_orig': 0.8467248376692753, 'encoder_test_rmse_all': 0.8558071657169989, 'encoder_test_rmse_orig': 0.6186664901635323, 'encoder_test_rmse_last': 0.8092491683711831, 'decoder_val_rmse_all': 0.8755458749615306, 'decoder_val_rmse_orig': 0.8467248376692753, 'decoder_test_rmse_2-step': 0.8435363584151584, 'decoder_test_rmse_3-step': 0.9607198123521855, 'decoder_test_rmse_4-step': 1.0321780704204022, 'decoder_test_rmse_5-step': 1.1078593114235362, 'decoder_test_rmse_6-step': 1.1504152066444098, 'method': 'gnet', 'seed': 8, 'seconds_taken': 282.016069920006, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:20:58,149,149 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 8, 2.0)
MainProcess| 2023-05-15 09:20:58,152,152 multiprocessing INFO Running EQ_5_B ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:20:58,203,203 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:21:47,166,166 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9808398739542753, 'encoder_val_rmse_orig': 0.9486028155716222, 'encoder_test_rmse_all': 1.1662374821310375, 'encoder_test_rmse_orig': 0.855257718434729, 'encoder_test_rmse_last': 1.104569815096347, 'decoder_val_rmse_all': 0.9808398739542753, 'decoder_val_rmse_orig': 0.9486028155716222, 'decoder_test_rmse_2-step': 0.9908340641423738, 'decoder_test_rmse_3-step': 1.1291290025562137, 'decoder_test_rmse_4-step': 1.212523897116183, 'decoder_test_rmse_5-step': 1.2840633685016298, 'decoder_test_rmse_6-step': 1.25419150322916, 'method': 'ct', 'seed': 8, 'seconds_taken': 49.013351981004234, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:21:47,166,166 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 09:21:47,169,169 multiprocessing INFO Running EQ_5_B rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:21:47,220,220 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:26:16,891,891 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7678453904163713, 'propensity_treatment_val_bce_orig': 0.7677821521136491, 'propensity_treatment_test_bce_all': 0.7621672542270786, 'propensity_treatment_test_bce_orig': 0.7619567925241897, 'propensity_history_val_bce_all': 0.7601496411037809, 'propensity_history_val_bce_orig': 0.7601526752334021, 'propensity_history_test_bce_all': 0.7585398820328956, 'propensity_history_test_bce_orig': 0.7575605733049275, 'encoder_val_rmse_all': 1.51142759328391, 'encoder_val_rmse_orig': 1.460390906316791, 'encoder_test_rmse_all': 1.5657197220123715, 'encoder_test_rmse_orig': 1.1271531040277694, 'encoder_test_rmse_last': 1.28018769996846, 'decoder_val_rmse_all': 0.26382841083290415, 'decoder_val_rmse_orig': 0.263828410832904, 'decoder_test_rmse_2-step': 1.1753594188379872, 'decoder_test_rmse_3-step': 1.1316150365598705, 'decoder_test_rmse_4-step': 1.129310937164378, 'decoder_test_rmse_5-step': 1.1330489372858703, 'decoder_test_rmse_6-step': 1.123109201053412, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 269.72228577498754, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:27:53,566,566 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 09:27:53,577,577 multiprocessing INFO Running EQ_5_C sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:27:53,629,629 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:28:07,957,957 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 14.379711695000879, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:28:07,957,957 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 8, 2.0)
MainProcess| 2023-05-15 09:28:07,960,960 multiprocessing INFO Running EQ_5_C crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:28:08,012,12 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:33:02,268,268 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.581704023705337, 'encoder_val_rmse_orig': 0.566268837331479, 'encoder_test_rmse_all': 0.8027671092229529, 'encoder_test_rmse_orig': 0.5868962033193714, 'encoder_test_rmse_last': 0.8049174187966767, 'decoder_val_rmse_all': 0.3352814805399492, 'decoder_val_rmse_orig': 0.33528148053994916, 'decoder_test_rmse_2-step': 0.7739459597045014, 'decoder_test_rmse_3-step': 0.8490298478513884, 'decoder_test_rmse_4-step': 0.9267975091817913, 'decoder_test_rmse_5-step': 1.0057563856171405, 'decoder_test_rmse_6-step': 1.0777278799684076, 'method': 'crn', 'seed': 8, 'seconds_taken': 294.3080497799965, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:33:02,268,268 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 8, 2.0)
MainProcess| 2023-05-15 09:33:02,271,271 multiprocessing INFO Running EQ_5_C msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:33:02,322,322 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:33:13,023,23 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 8, 'seconds_taken': 10.752007903996855, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:33:13,023,23 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 09:33:13,026,26 multiprocessing INFO Running EQ_5_C gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:33:13,074,74 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:37:58,748,748 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5937644795712587, 'encoder_val_rmse_orig': 0.5781663318434649, 'encoder_test_rmse_all': 0.8042005435044896, 'encoder_test_rmse_orig': 0.5945402016531929, 'encoder_test_rmse_last': 0.9202220177638326, 'decoder_val_rmse_all': 0.5937644795712587, 'decoder_val_rmse_orig': 0.5781663318434649, 'decoder_test_rmse_2-step': 0.886401487163891, 'decoder_test_rmse_3-step': 0.9716289388833885, 'decoder_test_rmse_4-step': 1.020631554056963, 'decoder_test_rmse_5-step': 1.0297742831031083, 'decoder_test_rmse_6-step': 1.0308637020798146, 'method': 'gnet', 'seed': 8, 'seconds_taken': 285.7221411490027, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:37:58,748,748 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 8, 2.0)
MainProcess| 2023-05-15 09:37:58,751,751 multiprocessing INFO Running EQ_5_C ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:37:58,800,800 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:38:49,653,653 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6930895576948745, 'encoder_val_rmse_orig': 0.6746569922580717, 'encoder_test_rmse_all': 1.151832988522307, 'encoder_test_rmse_orig': 0.8350122000199864, 'encoder_test_rmse_last': 1.0183094842344194, 'decoder_val_rmse_all': 0.6930895576948745, 'decoder_val_rmse_orig': 0.6746569922580717, 'decoder_test_rmse_2-step': 1.0153534361796568, 'decoder_test_rmse_3-step': 1.0169748382232688, 'decoder_test_rmse_4-step': 0.9638995965737761, 'decoder_test_rmse_5-step': 0.9327216976883326, 'decoder_test_rmse_6-step': 0.8879283458773806, 'method': 'ct', 'seed': 8, 'seconds_taken': 50.90232109600038, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:38:49,654,654 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 09:38:49,656,656 multiprocessing INFO Running EQ_5_C rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:38:49,712,712 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:43:21,871,871 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7685899600244652, 'propensity_treatment_val_bce_orig': 0.7685892837827529, 'propensity_treatment_test_bce_all': 0.756168833289704, 'propensity_treatment_test_bce_orig': 0.7597504550851958, 'propensity_history_val_bce_all': 0.7606270296334063, 'propensity_history_val_bce_orig': 0.7606935915223876, 'propensity_history_test_bce_all': 0.750977283288929, 'propensity_history_test_bce_orig': 0.7540321485175651, 'encoder_val_rmse_all': 1.2555748652031236, 'encoder_val_rmse_orig': 1.2203628990816646, 'encoder_test_rmse_all': 1.2336360622134475, 'encoder_test_rmse_orig': 0.8957461775693836, 'encoder_test_rmse_last': 1.1883537123198662, 'decoder_val_rmse_all': 0.3249498586649592, 'decoder_val_rmse_orig': 0.32494985866495923, 'decoder_test_rmse_2-step': 1.0886957661715702, 'decoder_test_rmse_3-step': 1.1761553653671886, 'decoder_test_rmse_4-step': 1.2424526066445296, 'decoder_test_rmse_5-step': 1.3018458930603352, 'decoder_test_rmse_6-step': 1.3572809915626836, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 272.21413051799755, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:44:56,897,897 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 09:44:56,900,900 multiprocessing INFO Running EQ_5_D sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:44:56,953,953 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:45:09,705,705 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 12.804357777989935, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:45:09,705,705 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 8, 2.0)
MainProcess| 2023-05-15 09:45:09,708,708 multiprocessing INFO Running EQ_5_D crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:45:09,760,760 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:50:07,000,0 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6336926102249537, 'encoder_val_rmse_orig': 0.6232520985889295, 'encoder_test_rmse_all': 0.8131447203969864, 'encoder_test_rmse_orig': 0.5871734775595263, 'encoder_test_rmse_last': 0.7228201102792111, 'decoder_val_rmse_all': 0.3998201946582848, 'decoder_val_rmse_orig': 0.39982019465828494, 'decoder_test_rmse_2-step': 0.9318644927747626, 'decoder_test_rmse_3-step': 1.0343534266580772, 'decoder_test_rmse_4-step': 1.083679530816609, 'decoder_test_rmse_5-step': 1.1150000416110595, 'decoder_test_rmse_6-step': 1.1228598114756172, 'method': 'crn', 'seed': 8, 'seconds_taken': 297.2916352519969, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:50:07,000,0 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 8, 2.0)
MainProcess| 2023-05-15 09:50:07,002,2 multiprocessing INFO Running EQ_5_D msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:50:07,049,49 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:50:17,808,808 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 8, 'seconds_taken': 10.805659011995886, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:50:17,808,808 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 09:50:17,811,811 multiprocessing INFO Running EQ_5_D gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:50:17,860,860 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:55:02,722,722 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6709362188837162, 'encoder_val_rmse_orig': 0.661273822646351, 'encoder_test_rmse_all': 0.7959038187807155, 'encoder_test_rmse_orig': 0.5906122399749276, 'encoder_test_rmse_last': 0.745907715629129, 'decoder_val_rmse_all': 0.6709362188837162, 'decoder_val_rmse_orig': 0.661273822646351, 'decoder_test_rmse_2-step': 1.0371999324510912, 'decoder_test_rmse_3-step': 1.1811864142697501, 'decoder_test_rmse_4-step': 1.189904843860426, 'decoder_test_rmse_5-step': 1.198420461578407, 'decoder_test_rmse_6-step': 1.183473119664618, 'method': 'gnet', 'seed': 8, 'seconds_taken': 284.91061223999714, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:55:02,722,722 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 8, 2.0)
MainProcess| 2023-05-15 09:55:02,725,725 multiprocessing INFO Running EQ_5_D ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:55:02,774,774 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 09:55:51,817,817 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8259581854501414, 'encoder_val_rmse_orig': 0.8122234162557541, 'encoder_test_rmse_all': 1.2113946645809701, 'encoder_test_rmse_orig': 0.8756506592545199, 'encoder_test_rmse_last': 1.0276171511375547, 'decoder_val_rmse_all': 0.8259581854501414, 'decoder_val_rmse_orig': 0.8122234162557541, 'decoder_test_rmse_2-step': 1.0492041927135387, 'decoder_test_rmse_3-step': 1.122649675345964, 'decoder_test_rmse_4-step': 1.1365193448332558, 'decoder_test_rmse_5-step': 1.1396956428943332, 'decoder_test_rmse_6-step': 1.099143975610795, 'method': 'ct', 'seed': 8, 'seconds_taken': 49.09222592400329, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 09:55:51,818,818 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 09:55:51,820,820 multiprocessing INFO Running EQ_5_D rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 09:55:51,874,874 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:00:23,607,607 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7693582355545633, 'propensity_treatment_val_bce_orig': 0.7693535695997179, 'propensity_treatment_test_bce_all': 0.7570225487351568, 'propensity_treatment_test_bce_orig': 0.761162610974274, 'propensity_history_val_bce_all': 0.7625158026024387, 'propensity_history_val_bce_orig': 0.7625235873301004, 'propensity_history_test_bce_all': 0.7542830561050632, 'propensity_history_test_bce_orig': 0.7571444925861205, 'encoder_val_rmse_all': 1.4138549330596712, 'encoder_val_rmse_orig': 1.3876111219805405, 'encoder_test_rmse_all': 1.4044669387654314, 'encoder_test_rmse_orig': 1.0076328584944614, 'encoder_test_rmse_last': 1.1860946796734706, 'decoder_val_rmse_all': 0.3349301663915466, 'decoder_val_rmse_orig': 0.3349301663915467, 'decoder_test_rmse_2-step': 1.23079593278624, 'decoder_test_rmse_3-step': 1.2039074482155145, 'decoder_test_rmse_4-step': 1.1623619429584084, 'decoder_test_rmse_5-step': 1.1339328942937403, 'decoder_test_rmse_6-step': 1.099863843597536, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 271.78633596400323, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:01:52,059,59 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 10:01:52,062,62 multiprocessing INFO Running EQ_4_A sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:01:52,112,112 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:01:55,605,605 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 3.5424874410091434, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:01:55,605,605 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 8, 2.0)
MainProcess| 2023-05-15 10:01:55,608,608 multiprocessing INFO Running EQ_4_A wsindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:01:55,658,658 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:02:01,146,146 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13165792352292963, 'encoder_test_rmse_orig': 0.11135858411777982, 'encoder_test_rmse_last': 0.11136528222100649, 'decoder_test_rmse_2-step': 0.1112795027187182, 'decoder_test_rmse_3-step': 0.11092602303360236, 'decoder_test_rmse_4-step': 0.11022160351989152, 'decoder_test_rmse_5-step': 0.10913985396954248, 'decoder_test_rmse_6-step': 0.10768638903658634, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084160704510827*x0*u0 | Treatment 1: x_dot = +-1.0083923903500167*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 8, 'seconds_taken': 5.5379841460089665, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:02:01,146,146 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 8, 2.0)
MainProcess| 2023-05-15 10:02:01,152,152 multiprocessing INFO Running EQ_4_A crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:02:01,203,203 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:07:03,470,470 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.20819382298314, 'encoder_val_rmse_orig': 1.2081938229831397, 'encoder_test_rmse_all': 0.8799050990711407, 'encoder_test_rmse_orig': 1.2078315556327144, 'encoder_test_rmse_last': 1.221717446546352, 'decoder_val_rmse_all': 0.3979866505128494, 'decoder_val_rmse_orig': 0.3979866505128493, 'decoder_test_rmse_2-step': 0.8497738578377088, 'decoder_test_rmse_3-step': 0.7995875460466074, 'decoder_test_rmse_4-step': 0.7573839111024709, 'decoder_test_rmse_5-step': 0.7507185964836885, 'decoder_test_rmse_6-step': 0.7615205144678567, 'method': 'crn', 'seed': 8, 'seconds_taken': 302.31844844399893, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:07:03,470,470 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 8, 2.0)
MainProcess| 2023-05-15 10:07:03,473,473 multiprocessing INFO Running EQ_4_A msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:07:03,519,519 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:07:08,873,873 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 8, 'seconds_taken': 5.399483776011039, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:07:08,873,873 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 10:07:08,876,876 multiprocessing INFO Running EQ_4_A gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:07:08,920,920 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:11:30,441,441 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.24124247540282545, 'encoder_val_rmse_orig': 0.24124247540282545, 'encoder_test_rmse_all': 0.31086192823401926, 'encoder_test_rmse_orig': 0.24140733653398222, 'encoder_test_rmse_last': 0.25509664469885784, 'decoder_val_rmse_all': 0.24124247540282545, 'decoder_val_rmse_orig': 0.24124247540282545, 'decoder_test_rmse_2-step': 0.40060671241944396, 'decoder_test_rmse_3-step': 0.4756755370883335, 'decoder_test_rmse_4-step': 0.5402392066758854, 'decoder_test_rmse_5-step': 0.5945914770011708, 'decoder_test_rmse_6-step': 0.6404976353103757, 'method': 'gnet', 'seed': 8, 'seconds_taken': 261.56531827199797, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:11:30,441,441 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 8, 2.0)
MainProcess| 2023-05-15 10:11:30,444,444 multiprocessing INFO Running EQ_4_A ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:11:30,492,492 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:12:18,330,330 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.36602815541907124, 'encoder_val_rmse_orig': 0.36602815541907124, 'encoder_test_rmse_all': 0.44985588896331696, 'encoder_test_rmse_orig': 0.3761118388708464, 'encoder_test_rmse_last': 0.586225525487867, 'decoder_val_rmse_all': 0.36602815541907124, 'decoder_val_rmse_orig': 0.36602815541907124, 'decoder_test_rmse_2-step': 0.6175279626843548, 'decoder_test_rmse_3-step': 0.8763783057375149, 'decoder_test_rmse_4-step': 1.0126134102858761, 'decoder_test_rmse_5-step': 1.1476940398607598, 'decoder_test_rmse_6-step': 1.2434054460443278, 'method': 'ct', 'seed': 8, 'seconds_taken': 47.88618684900575, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:12:18,330,330 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 10:12:18,333,333 multiprocessing INFO Running EQ_4_A rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:12:18,386,386 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:17:03,214,214 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4941123825816785, 'propensity_treatment_val_bce_orig': 0.49411238258167844, 'propensity_treatment_test_bce_all': 0.5075598776966839, 'propensity_treatment_test_bce_orig': 0.5152270593931777, 'propensity_history_val_bce_all': 0.4919383039868484, 'propensity_history_val_bce_orig': 0.4919383039868484, 'propensity_history_test_bce_all': 0.5045491546699724, 'propensity_history_test_bce_orig': 0.5131980831585089, 'encoder_val_rmse_all': 2.9174845885552254, 'encoder_val_rmse_orig': 2.9174845885552254, 'encoder_test_rmse_all': 4.06816715425059, 'encoder_test_rmse_orig': 2.923367021540008, 'encoder_test_rmse_last': 3.0477356377241045, 'decoder_val_rmse_all': 0.476824444035062, 'decoder_val_rmse_orig': 0.47682444403506186, 'decoder_test_rmse_2-step': 2.5319622864567752, 'decoder_test_rmse_3-step': 2.505205736567381, 'decoder_test_rmse_4-step': 2.5385142985914118, 'decoder_test_rmse_5-step': 2.5851681073060315, 'decoder_test_rmse_6-step': 2.6348661257342747, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 284.88007489198935, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:18:29,936,936 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 10:18:29,939,939 multiprocessing INFO Running EQ_4_B sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:18:29,990,990 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:18:33,590,590 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 3.651328128995374, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:18:33,590,590 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 8, 2.0)
MainProcess| 2023-05-15 10:18:33,593,593 multiprocessing INFO Running EQ_4_B wsindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:18:33,642,642 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:18:39,101,101 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13346245204980528, 'encoder_test_rmse_orig': 0.11333084244972806, 'encoder_test_rmse_last': 0.11341495466908316, 'decoder_test_rmse_2-step': 0.11324457187745195, 'decoder_test_rmse_3-step': 0.11295825662072659, 'decoder_test_rmse_4-step': 0.11230914413890264, 'decoder_test_rmse_5-step': 0.11104761463045132, 'decoder_test_rmse_6-step': 0.109618098429381, 'global_equation_string': 'Treatment 0: x_dot = +-1.00835904385299*x0*u0 | Treatment 1: x_dot = +-1.0084360393741254*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 8, 'seconds_taken': 5.507960479997564, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:18:39,101,101 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 8, 2.0)
MainProcess| 2023-05-15 10:18:39,104,104 multiprocessing INFO Running EQ_4_B crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:18:39,156,156 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:23:37,534,534 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2021446902966524, 'encoder_val_rmse_orig': 1.2021446902966524, 'encoder_test_rmse_all': 0.8762892128781656, 'encoder_test_rmse_orig': 1.2019361150260293, 'encoder_test_rmse_last': 1.2157527007406757, 'decoder_val_rmse_all': 0.39720575137288255, 'decoder_val_rmse_orig': 0.39720575137288255, 'decoder_test_rmse_2-step': 0.8468585813508295, 'decoder_test_rmse_3-step': 0.7947658316877052, 'decoder_test_rmse_4-step': 0.7531476787337188, 'decoder_test_rmse_5-step': 0.7459557238000214, 'decoder_test_rmse_6-step': 0.75614740171135, 'method': 'crn', 'seed': 8, 'seconds_taken': 298.4295943360048, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:23:37,534,534 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 8, 2.0)
MainProcess| 2023-05-15 10:23:37,537,537 multiprocessing INFO Running EQ_4_B msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:23:37,581,581 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:23:43,287,287 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 8, 'seconds_taken': 5.749604988988722, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:23:43,287,287 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 10:23:43,292,292 multiprocessing INFO Running EQ_4_B gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:23:43,341,341 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:28:14,977,977 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.24239653694540214, 'encoder_val_rmse_orig': 0.24239653694540214, 'encoder_test_rmse_all': 0.3117539366349006, 'encoder_test_rmse_orig': 0.24250383338112724, 'encoder_test_rmse_last': 0.25601549756300346, 'decoder_val_rmse_all': 0.24239653694540214, 'decoder_val_rmse_orig': 0.24239653694540214, 'decoder_test_rmse_2-step': 0.4016260214507108, 'decoder_test_rmse_3-step': 0.47638838399743644, 'decoder_test_rmse_4-step': 0.5406091890611131, 'decoder_test_rmse_5-step': 0.59484696819081, 'decoder_test_rmse_6-step': 0.640812705146245, 'method': 'gnet', 'seed': 8, 'seconds_taken': 271.68508809499326, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:28:14,977,977 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 8, 2.0)
MainProcess| 2023-05-15 10:28:14,980,980 multiprocessing INFO Running EQ_4_B ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:28:15,031,31 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:29:03,548,548 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3668511855756476, 'encoder_val_rmse_orig': 0.3668511855756476, 'encoder_test_rmse_all': 0.45048149046331987, 'encoder_test_rmse_orig': 0.3769022465913735, 'encoder_test_rmse_last': 0.588233335883095, 'decoder_val_rmse_all': 0.3668511855756476, 'decoder_val_rmse_orig': 0.3668511855756476, 'decoder_test_rmse_2-step': 0.6200124563032963, 'decoder_test_rmse_3-step': 0.8768395150596677, 'decoder_test_rmse_4-step': 1.0135682579718808, 'decoder_test_rmse_5-step': 1.1482525234372718, 'decoder_test_rmse_6-step': 1.2445659035295737, 'method': 'ct', 'seed': 8, 'seconds_taken': 48.5673009930033, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:29:03,548,548 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 10:29:03,551,551 multiprocessing INFO Running EQ_4_B rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:29:03,604,604 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:33:41,217,217 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4941123825816785, 'propensity_treatment_val_bce_orig': 0.49411238258167844, 'propensity_treatment_test_bce_all': 0.5075598776966839, 'propensity_treatment_test_bce_orig': 0.5152270593931777, 'propensity_history_val_bce_all': 0.49200128597223153, 'propensity_history_val_bce_orig': 0.4920012859722315, 'propensity_history_test_bce_all': 0.5046692077544449, 'propensity_history_test_bce_orig': 0.5132601046085218, 'encoder_val_rmse_all': 2.9838885963726915, 'encoder_val_rmse_orig': 2.983888596372692, 'encoder_test_rmse_all': 4.164605871359292, 'encoder_test_rmse_orig': 2.9888810241634376, 'encoder_test_rmse_last': 3.1139303342727507, 'decoder_val_rmse_all': 0.40753265487715573, 'decoder_val_rmse_orig': 0.40753265487715573, 'decoder_test_rmse_2-step': 2.5314499890378874, 'decoder_test_rmse_3-step': 2.436256313957892, 'decoder_test_rmse_4-step': 2.4029873390364873, 'decoder_test_rmse_5-step': 2.388773263826454, 'decoder_test_rmse_6-step': 2.3890159293124364, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 277.66613448399585, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:35:08,386,386 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 10:35:08,388,388 multiprocessing INFO Running EQ_4_C sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:35:08,440,440 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:35:12,140,140 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 3.751190259004943, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:35:12,140,140 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 8, 2.0)
MainProcess| 2023-05-15 10:35:12,143,143 multiprocessing INFO Running EQ_4_C wsindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:35:12,193,193 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:35:17,786,786 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.15242262109457702, 'encoder_test_rmse_orig': 0.12428088324050106, 'encoder_test_rmse_last': 0.12428910470699875, 'decoder_test_rmse_2-step': 0.12400073519842146, 'decoder_test_rmse_3-step': 0.12332915414424309, 'decoder_test_rmse_4-step': 0.12207625694016858, 'decoder_test_rmse_5-step': 0.11996346195032519, 'decoder_test_rmse_6-step': 0.1175336625505371, 'global_equation_string': 'Treatment 0: x_dot = +-0.04556500658024989*x0+-1.0190883453233555*x0*u0 | Treatment 1: x_dot = +-0.1464091284181689*x0+-1.0215981163173184*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 8, 'seconds_taken': 5.642670647997875, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:35:17,786,786 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 8, 2.0)
MainProcess| 2023-05-15 10:35:17,789,789 multiprocessing INFO Running EQ_4_C crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:35:17,832,832 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:40:24,009,9 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1811071578261667, 'encoder_val_rmse_orig': 1.1811071578261667, 'encoder_test_rmse_all': 0.8844100003925621, 'encoder_test_rmse_orig': 1.1860771602911058, 'encoder_test_rmse_last': 1.2494158684008236, 'decoder_val_rmse_all': 0.3583772914799408, 'decoder_val_rmse_orig': 0.3583772914799408, 'decoder_test_rmse_2-step': 0.5052871268282938, 'decoder_test_rmse_3-step': 0.49764789281084126, 'decoder_test_rmse_4-step': 0.5313731399506956, 'decoder_test_rmse_5-step': 0.5522641435592428, 'decoder_test_rmse_6-step': 0.5568921543968044, 'method': 'crn', 'seed': 8, 'seconds_taken': 306.2203505820071, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:40:24,009,9 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 8, 2.0)
MainProcess| 2023-05-15 10:40:24,012,12 multiprocessing INFO Running EQ_4_C msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:40:24,060,60 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:40:29,443,443 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 8, 'seconds_taken': 5.430868127004942, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:40:29,443,443 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 10:40:29,446,446 multiprocessing INFO Running EQ_4_C gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:40:29,491,491 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:44:53,835,835 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.21325383109133048, 'encoder_val_rmse_orig': 0.21325383109133048, 'encoder_test_rmse_all': 0.2781785759970575, 'encoder_test_rmse_orig': 0.21382859748831842, 'encoder_test_rmse_last': 0.22913203879130173, 'decoder_val_rmse_all': 0.21325383109133048, 'decoder_val_rmse_orig': 0.21325383109133048, 'decoder_test_rmse_2-step': 0.3474676607184852, 'decoder_test_rmse_3-step': 0.3967162674215246, 'decoder_test_rmse_4-step': 0.4349405681770445, 'decoder_test_rmse_5-step': 0.4663067996384298, 'decoder_test_rmse_6-step': 0.49215766140457246, 'method': 'gnet', 'seed': 8, 'seconds_taken': 264.38825758200255, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:44:53,835,835 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 8, 2.0)
MainProcess| 2023-05-15 10:44:53,838,838 multiprocessing INFO Running EQ_4_C ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:44:53,890,890 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:45:42,044,44 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.30756651664457, 'encoder_val_rmse_orig': 0.30756651664456996, 'encoder_test_rmse_all': 0.37404975661208595, 'encoder_test_rmse_orig': 0.3096674933197695, 'encoder_test_rmse_last': 0.40518356892836016, 'decoder_val_rmse_all': 0.30756651664457, 'decoder_val_rmse_orig': 0.30756651664456996, 'decoder_test_rmse_2-step': 0.4358495575632725, 'decoder_test_rmse_3-step': 0.5735812558094447, 'decoder_test_rmse_4-step': 0.663607033937039, 'decoder_test_rmse_5-step': 0.6981391417618285, 'decoder_test_rmse_6-step': 0.7562500386609142, 'method': 'ct', 'seed': 8, 'seconds_taken': 48.206097166010295, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:45:42,044,44 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 10:45:42,047,47 multiprocessing INFO Running EQ_4_C rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:45:42,102,102 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:50:22,700,700 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4941123825816785, 'propensity_treatment_val_bce_orig': 0.49411238258167844, 'propensity_treatment_test_bce_all': 0.5075598776966839, 'propensity_treatment_test_bce_orig': 0.5152270593931777, 'propensity_history_val_bce_all': 0.4919729356644517, 'propensity_history_val_bce_orig': 0.49197293566445177, 'propensity_history_test_bce_all': 0.5046114415010322, 'propensity_history_test_bce_orig': 0.513231972832403, 'encoder_val_rmse_all': 2.7712027384134075, 'encoder_val_rmse_orig': 2.7712027384134084, 'encoder_test_rmse_all': 3.869177715808208, 'encoder_test_rmse_orig': 2.7778616783616323, 'encoder_test_rmse_last': 2.923411792832025, 'decoder_val_rmse_all': 0.4002986830634479, 'decoder_val_rmse_orig': 0.40029868306344807, 'decoder_test_rmse_2-step': 2.336689869599956, 'decoder_test_rmse_3-step': 2.24540292136242, 'decoder_test_rmse_4-step': 2.2139320845092714, 'decoder_test_rmse_5-step': 2.19943599300499, 'decoder_test_rmse_6-step': 2.1946400731952926, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 280.65269694200833, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:51:55,677,677 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 8, 2.0)
MainProcess| 2023-05-15 10:51:55,680,680 multiprocessing INFO Running EQ_4_D sindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:51:55,729,729 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:51:59,286,286 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 8, 'seconds_taken': 3.6062248399975942, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:51:59,286,286 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 8, 2.0)
MainProcess| 2023-05-15 10:51:59,289,289 multiprocessing INFO Running EQ_4_D wsindy 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:51:59,339,339 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:52:04,860,860 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.11991172847392471, 'encoder_test_rmse_orig': 0.10176539029770801, 'encoder_test_rmse_last': 0.10221052178896077, 'decoder_test_rmse_2-step': 0.10229688750064664, 'decoder_test_rmse_3-step': 0.1026217192053538, 'decoder_test_rmse_4-step': 0.10263271642290875, 'decoder_test_rmse_5-step': 0.10234173364435846, 'decoder_test_rmse_6-step': 0.10151341361200855, 'global_equation_string': 'Treatment 0: x_dot = +0.1977406104782367*x0+-1.0095156401299532*x0*u0 | Treatment 1: x_dot = +-0.09092373549896592*x0+-1.0202177688801306*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 8, 'seconds_taken': 5.570320163998986, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:52:04,860,860 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 8, 2.0)
MainProcess| 2023-05-15 10:52:04,863,863 multiprocessing INFO Running EQ_4_D crn 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:52:04,914,914 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:57:06,871,871 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.452610891154333, 'encoder_val_rmse_orig': 1.4526108911543332, 'encoder_test_rmse_all': 1.1887168550803742, 'encoder_test_rmse_orig': 1.479301561702247, 'encoder_test_rmse_last': 1.7747048550578803, 'decoder_val_rmse_all': 0.4043391634636716, 'decoder_val_rmse_orig': 0.4043391634636715, 'decoder_test_rmse_2-step': 2.0013372817740915, 'decoder_test_rmse_3-step': 1.8577167866083357, 'decoder_test_rmse_4-step': 1.840904733453245, 'decoder_test_rmse_5-step': 1.8776402044797307, 'decoder_test_rmse_6-step': 1.9366337522036419, 'method': 'crn', 'seed': 8, 'seconds_taken': 302.0077720400004, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:57:06,871,871 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 8, 2.0)
MainProcess| 2023-05-15 10:57:06,873,873 multiprocessing INFO Running EQ_4_D msm 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:57:06,922,922 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 10:57:12,299,299 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 8, 'seconds_taken': 5.425422194995917, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 10:57:12,300,300 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 8, 2.0)
MainProcess| 2023-05-15 10:57:12,302,302 multiprocessing INFO Running EQ_4_D gnet 8 | domain_conf=2.0
MainProcess| 2023-05-15 10:57:12,350,350 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:01:32,593,593 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5247401118353062, 'encoder_val_rmse_orig': 0.5247401118353062, 'encoder_test_rmse_all': 0.6803359605200666, 'encoder_test_rmse_orig': 0.5251814303953237, 'encoder_test_rmse_last': 0.5330268750562466, 'decoder_val_rmse_all': 0.5247401118353062, 'decoder_val_rmse_orig': 0.5247401118353062, 'decoder_test_rmse_2-step': 0.7206849077691945, 'decoder_test_rmse_3-step': 0.8560644940480209, 'decoder_test_rmse_4-step': 0.9870649442942991, 'decoder_test_rmse_5-step': 1.1031420239886651, 'decoder_test_rmse_6-step': 1.2043171905614676, 'method': 'gnet', 'seed': 8, 'seconds_taken': 260.29062611199333, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:01:32,593,593 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 8, 2.0)
MainProcess| 2023-05-15 11:01:32,596,596 multiprocessing INFO Running EQ_4_D ct 8 | domain_conf=2.0
MainProcess| 2023-05-15 11:01:32,644,644 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:02:23,273,273 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3822035324825374, 'encoder_val_rmse_orig': 0.3822035324825374, 'encoder_test_rmse_all': 0.46365715939316726, 'encoder_test_rmse_orig': 0.3954600164093985, 'encoder_test_rmse_last': 0.5579514016670016, 'decoder_val_rmse_all': 0.3822035324825374, 'decoder_val_rmse_orig': 0.3822035324825374, 'decoder_test_rmse_2-step': 0.593108758190842, 'decoder_test_rmse_3-step': 0.7905338685696227, 'decoder_test_rmse_4-step': 0.9265129315515007, 'decoder_test_rmse_5-step': 1.0420475655204653, 'decoder_test_rmse_6-step': 1.12518914885207, 'method': 'ct', 'seed': 8, 'seconds_taken': 50.6762661679968, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:02:23,273,273 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 8, 2.0)
MainProcess| 2023-05-15 11:02:23,277,277 multiprocessing INFO Running EQ_4_D rmsn 8 | domain_conf=2.0
MainProcess| 2023-05-15 11:02:23,337,337 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 8, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:07:08,710,710 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5015971149428416, 'propensity_treatment_val_bce_orig': 0.5015971149428416, 'propensity_treatment_test_bce_all': 0.514706150180876, 'propensity_treatment_test_bce_orig': 0.5219306963347784, 'propensity_history_val_bce_all': 0.4997406403139486, 'propensity_history_val_bce_orig': 0.4997406403139486, 'propensity_history_test_bce_all': 0.512204236983832, 'propensity_history_test_bce_orig': 0.5202061907020548, 'encoder_val_rmse_all': 2.733255254809968, 'encoder_val_rmse_orig': 2.733255254809968, 'encoder_test_rmse_all': 3.7879930087865854, 'encoder_test_rmse_orig': 2.743085292871304, 'encoder_test_rmse_last': 2.891163904761865, 'decoder_val_rmse_all': 0.35996092457606926, 'decoder_val_rmse_orig': 0.35996092457606926, 'decoder_test_rmse_2-step': 2.4415088212862335, 'decoder_test_rmse_3-step': 2.3788422273382244, 'decoder_test_rmse_4-step': 2.375150912147611, 'decoder_test_rmse_5-step': 2.386671507494162, 'decoder_test_rmse_6-step': 2.4065343351285615, 'method': 'rmsn', 'seed': 8, 'seconds_taken': 285.4325265279913, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:08:31,265,265 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 11:08:31,268,268 multiprocessing INFO Running cancer_sim sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:08:31,317,317 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:08:45,594,594 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.156088252028878, 'encoder_test_rmse_orig': 1.7342646495065481, 'encoder_test_rmse_last': 1.7533225309220122, 'decoder_test_rmse_2-step': 1.327252086844152, 'decoder_test_rmse_3-step': 1.3053306069334676, 'decoder_test_rmse_4-step': 1.297414430898069, 'decoder_test_rmse_5-step': 1.2942172534259109, 'decoder_test_rmse_6-step': 1.289684544561717, 'global_equation_string': 'Treatment 0: x_dot = +-0.05601456082026624*1+-0.11598756834077*x0+-0.07958279124512227*u0+0.07326347275734027*x0*u0 | Treatment 1: x_dot = +-0.5517350343589641*1+-0.8761667536689084*x0+-0.053397817822270766*u0+-0.035996455669168224*x0*u0 | Treatment 2: x_dot = +-3.649800303098579*1+-0.8626472911638889*x0+1.1157911611997717*u0+-0.6373790072514276*x0*u0 | Treatment 3: x_dot = +-1.6336216074116419*1+-3.49858670473956*x0+-3.584018882175004*u0+0.06151172618047967*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 14.325381721006124, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:08:45,594,594 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 9, 2.0)
MainProcess| 2023-05-15 11:08:45,597,597 multiprocessing INFO Running cancer_sim crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:08:45,641,641 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:13:38,601,601 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0891642775092933, 'encoder_val_rmse_orig': 1.0442230623998219, 'encoder_test_rmse_all': 0.7985156579396038, 'encoder_test_rmse_orig': 0.6041873062256238, 'encoder_test_rmse_last': 0.7270786827259137, 'decoder_val_rmse_all': 0.3363287750547328, 'decoder_val_rmse_orig': 0.3363287750547328, 'decoder_test_rmse_2-step': 0.6859893194110313, 'decoder_test_rmse_3-step': 0.7712280077835653, 'decoder_test_rmse_4-step': 0.87179954456985, 'decoder_test_rmse_5-step': 0.9649108873593283, 'decoder_test_rmse_6-step': 1.0496604929939861, 'method': 'crn', 'seed': 9, 'seconds_taken': 293.00357887300197, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:13:38,601,601 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 9, 2.0)
MainProcess| 2023-05-15 11:13:38,604,604 multiprocessing INFO Running cancer_sim msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:13:38,651,651 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:13:52,299,299 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.5853316940763078, 'encoder_test_rmse_orig': 1.1863726817019866, 'encoder_test_rmse_last': 1.0930980890288786, 'decoder_test_rmse_2-step': 1.8301674918117996, 'decoder_test_rmse_3-step': 2.1383268535506286, 'decoder_test_rmse_4-step': 2.290881764923292, 'decoder_test_rmse_5-step': 2.3535418141722713, 'decoder_test_rmse_6-step': 2.357252778527648, 'method': 'msm', 'seed': 9, 'seconds_taken': 13.695169975006138, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:13:52,299,299 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 11:13:52,302,302 multiprocessing INFO Running cancer_sim gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:13:52,349,349 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:18:31,660,660 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1748207525179923, 'encoder_val_rmse_orig': 1.1248912397362965, 'encoder_test_rmse_all': 0.7472197139154053, 'encoder_test_rmse_orig': 0.560336343420842, 'encoder_test_rmse_last': 0.6853917120659987, 'decoder_val_rmse_all': 1.1748207525179923, 'decoder_val_rmse_orig': 1.1248912397362965, 'decoder_test_rmse_2-step': 0.8249094165882509, 'decoder_test_rmse_3-step': 0.9856768598160864, 'decoder_test_rmse_4-step': 1.053140992697864, 'decoder_test_rmse_5-step': 1.1235236505054431, 'decoder_test_rmse_6-step': 1.1845446477631036, 'method': 'gnet', 'seed': 9, 'seconds_taken': 279.35730457400496, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:18:31,660,660 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 9, 2.0)
MainProcess| 2023-05-15 11:18:31,663,663 multiprocessing INFO Running cancer_sim ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:18:31,713,713 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:19:22,536,536 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0284191121048505, 'encoder_val_rmse_orig': 0.9863149416272832, 'encoder_test_rmse_all': 0.8334455601310811, 'encoder_test_rmse_orig': 0.6296399555853848, 'encoder_test_rmse_last': 0.7450606965554805, 'decoder_val_rmse_all': 1.0284191121048505, 'decoder_val_rmse_orig': 0.9863149416272832, 'decoder_test_rmse_2-step': 0.7908715867199606, 'decoder_test_rmse_3-step': 0.8383552927190371, 'decoder_test_rmse_4-step': 0.9125253177267315, 'decoder_test_rmse_5-step': 0.9561984637248586, 'decoder_test_rmse_6-step': 0.9812883722107612, 'method': 'ct', 'seed': 9, 'seconds_taken': 50.87353549100226, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:19:22,536,536 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 11:19:22,542,542 multiprocessing INFO Running cancer_sim rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:19:22,594,594 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:23:54,650,650 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7679095996934793, 'propensity_treatment_val_bce_orig': 0.7678323115099738, 'propensity_treatment_test_bce_all': 0.7583104327912399, 'propensity_treatment_test_bce_orig': 0.7612879208904003, 'propensity_history_val_bce_all': 0.762883229837255, 'propensity_history_val_bce_orig': 0.7629251453021322, 'propensity_history_test_bce_all': 0.75781099133677, 'propensity_history_test_bce_orig': 0.7595670984442762, 'encoder_val_rmse_all': 1.3463999758430054, 'encoder_val_rmse_orig': 1.2901242409705516, 'encoder_test_rmse_all': 0.921253306295762, 'encoder_test_rmse_orig': 0.6911229986147354, 'encoder_test_rmse_last': 0.8320368748331725, 'decoder_val_rmse_all': 0.3435921432459118, 'decoder_val_rmse_orig': 0.3435921432459117, 'decoder_test_rmse_2-step': 0.8488943138804196, 'decoder_test_rmse_3-step': 0.881722235288561, 'decoder_test_rmse_4-step': 0.9212389775513434, 'decoder_test_rmse_5-step': 0.9623059289846269, 'decoder_test_rmse_6-step': 0.9982284485716589, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 272.108031759999, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:26:10,835,835 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 11:26:10,838,838 multiprocessing INFO Running EQ_5_A sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:26:10,886,886 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:26:23,472,472 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.187529254012116, 'encoder_test_rmse_orig': 1.664287448357416, 'encoder_test_rmse_last': 1.7273690135261972, 'decoder_test_rmse_2-step': 1.488343073192752, 'decoder_test_rmse_3-step': 1.4750086673006824, 'decoder_test_rmse_4-step': 1.4674327615763596, 'decoder_test_rmse_5-step': 1.4642280591920718, 'decoder_test_rmse_6-step': 1.4628919594697574, 'global_equation_string': 'Treatment 0: x_dot = +138438267.379093*1+-3753986189599.5938*x0+-138438267.64922675*u0+3753986189599.668*x0*u0 | Treatment 1: x_dot = +-0.31541331216328927*1+-0.45872538103637056*x0+-0.3154133121632892*u0+-0.45872538103637134*x0*u0 | Treatment 2: x_dot = +-0.9597142478864851*1+-1.164402237658134*x0+-0.9597142478864851*u0+-1.1644022376581322*x0*u0 | Treatment 3: x_dot = +-1715233595.0462215*1+-17700235653783.754*x0+1715233588.4293523*u0+17700235653780.484*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 12.634240340994438, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:26:23,473,473 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 9, 2.0)
MainProcess| 2023-05-15 11:26:23,475,475 multiprocessing INFO Running EQ_5_A crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:26:23,527,527 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:31:19,833,833 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8510546598831646, 'encoder_val_rmse_orig': 0.8233121474173127, 'encoder_test_rmse_all': 0.9164170803932208, 'encoder_test_rmse_orig': 0.6653280082314511, 'encoder_test_rmse_last': 0.7922893508797699, 'decoder_val_rmse_all': 0.33195028279151173, 'decoder_val_rmse_orig': 0.3319502827915116, 'decoder_test_rmse_2-step': 0.7713846040697577, 'decoder_test_rmse_3-step': 0.8579234335520933, 'decoder_test_rmse_4-step': 0.947342547868254, 'decoder_test_rmse_5-step': 1.0226725147731721, 'decoder_test_rmse_6-step': 1.0593065778907982, 'method': 'crn', 'seed': 9, 'seconds_taken': 296.35714646198903, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:31:19,833,833 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 9, 2.0)
MainProcess| 2023-05-15 11:31:19,835,835 multiprocessing INFO Running EQ_5_A msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:31:19,883,883 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:31:31,560,560 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.962392293990357, 'encoder_test_rmse_orig': 1.4189287525739116, 'encoder_test_rmse_last': 1.3605612824135538, 'decoder_test_rmse_2-step': 2.0715409228848087, 'decoder_test_rmse_3-step': 2.436880119924487, 'decoder_test_rmse_4-step': 2.60650554570575, 'decoder_test_rmse_5-step': 2.6639196525553497, 'decoder_test_rmse_6-step': 2.6060835782992684, 'method': 'msm', 'seed': 9, 'seconds_taken': 11.724478222007747, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:31:31,560,560 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 11:31:31,563,563 multiprocessing INFO Running EQ_5_A gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:31:31,608,608 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:36:24,289,289 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8232182443577929, 'encoder_val_rmse_orig': 0.7973041426320677, 'encoder_test_rmse_all': 0.8412247939436488, 'encoder_test_rmse_orig': 0.6181417054471728, 'encoder_test_rmse_last': 0.823914301292543, 'decoder_val_rmse_all': 0.8232182443577929, 'decoder_val_rmse_orig': 0.7973041426320677, 'decoder_test_rmse_2-step': 0.8563079857424611, 'decoder_test_rmse_3-step': 1.0556217245943218, 'decoder_test_rmse_4-step': 1.2388310942102734, 'decoder_test_rmse_5-step': 1.3630466671244523, 'decoder_test_rmse_6-step': 1.4284782600343473, 'method': 'gnet', 'seed': 9, 'seconds_taken': 292.72613958700094, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:36:24,290,290 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 9, 2.0)
MainProcess| 2023-05-15 11:36:24,292,292 multiprocessing INFO Running EQ_5_A ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:36:24,340,340 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:37:14,195,195 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9695189498587575, 'encoder_val_rmse_orig': 0.9375749130018796, 'encoder_test_rmse_all': 1.1703323765704603, 'encoder_test_rmse_orig': 0.8527366941304984, 'encoder_test_rmse_last': 1.0864708992431122, 'decoder_val_rmse_all': 0.9695189498587575, 'decoder_val_rmse_orig': 0.9375749130018796, 'decoder_test_rmse_2-step': 0.998164262227506, 'decoder_test_rmse_3-step': 1.086440443986429, 'decoder_test_rmse_4-step': 1.1743610778046736, 'decoder_test_rmse_5-step': 1.2123277005066646, 'decoder_test_rmse_6-step': 1.1977063376482078, 'method': 'ct', 'seed': 9, 'seconds_taken': 49.902236110996455, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:37:14,195,195 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 11:37:14,198,198 multiprocessing INFO Running EQ_5_A rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:37:14,251,251 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:41:40,051,51 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7678159106985665, 'propensity_treatment_val_bce_orig': 0.767765478752324, 'propensity_treatment_test_bce_all': 0.7605446179877812, 'propensity_treatment_test_bce_orig': 0.7613793627095822, 'propensity_history_val_bce_all': 0.7614677407718993, 'propensity_history_val_bce_orig': 0.7615131257833002, 'propensity_history_test_bce_all': 0.7594907476359859, 'propensity_history_test_bce_orig': 0.7589917181998136, 'encoder_val_rmse_all': 1.4565643003112245, 'encoder_val_rmse_orig': 1.4077157688309032, 'encoder_test_rmse_all': 1.5079426213233282, 'encoder_test_rmse_orig': 1.0892921423633346, 'encoder_test_rmse_last': 1.2585527719480345, 'decoder_val_rmse_all': 0.28578711626380565, 'decoder_val_rmse_orig': 0.2857871162638058, 'decoder_test_rmse_2-step': 1.0908193353009366, 'decoder_test_rmse_3-step': 1.116242578022112, 'decoder_test_rmse_4-step': 1.2558745499539437, 'decoder_test_rmse_5-step': 1.422410264904119, 'decoder_test_rmse_6-step': 1.578244086957915, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 265.8534689549997, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:43:19,720,720 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 11:43:19,723,723 multiprocessing INFO Running EQ_5_B sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:43:19,768,768 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:43:34,714,714 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1905837361584974, 'encoder_test_rmse_orig': 1.6665418302107198, 'encoder_test_rmse_last': 1.7298676491708076, 'decoder_test_rmse_2-step': 1.49129690105742, 'decoder_test_rmse_3-step': 1.4784604152901513, 'decoder_test_rmse_4-step': 1.4711812757232126, 'decoder_test_rmse_5-step': 1.4682015031751892, 'decoder_test_rmse_6-step': 1.467074073641207, 'global_equation_string': 'Treatment 0: x_dot = +-0.13949001094766103*1+0.038106499687738035*x0+-0.13949001094766109*u0+0.03810649968773813*x0*u0 | Treatment 1: x_dot = +-0.31636715572831164*1+-0.45872999296352895*x0+-0.31636715572831164*u0+-0.4587299929635294*x0*u0 | Treatment 2: x_dot = +-0.9593069062748397*1+-1.164409304320919*x0+-0.9593069062748393*u0+-1.1644093043209196*x0*u0 | Treatment 3: x_dot = +-3.35560219805594*1+-1.6300585505736231*x0+-3.355602198055942*u0+-1.6300585505735987*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 14.99037064499862, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:43:34,714,714 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 9, 2.0)
MainProcess| 2023-05-15 11:43:34,717,717 multiprocessing INFO Running EQ_5_B crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:43:34,762,762 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:48:14,592,592 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8510310575198274, 'encoder_val_rmse_orig': 0.8232894781062126, 'encoder_test_rmse_all': 0.9164118272554206, 'encoder_test_rmse_orig': 0.6653251838023138, 'encoder_test_rmse_last': 0.7923113901518977, 'decoder_val_rmse_all': 0.3319439226326294, 'decoder_val_rmse_orig': 0.33194392263262945, 'decoder_test_rmse_2-step': 0.7713889469502495, 'decoder_test_rmse_3-step': 0.8579363282083043, 'decoder_test_rmse_4-step': 0.9473524960172109, 'decoder_test_rmse_5-step': 1.022684468529758, 'decoder_test_rmse_6-step': 1.059314700509465, 'method': 'crn', 'seed': 9, 'seconds_taken': 279.8749963139999, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:48:14,592,592 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 9, 2.0)
MainProcess| 2023-05-15 11:48:14,595,595 multiprocessing INFO Running EQ_5_B msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:48:14,645,645 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:48:26,334,334 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9623978171783403, 'encoder_test_rmse_orig': 1.4189331788046755, 'encoder_test_rmse_last': 1.360571980131382, 'decoder_test_rmse_2-step': 2.0715598927542858, 'decoder_test_rmse_3-step': 2.4368975108684032, 'decoder_test_rmse_4-step': 2.6065325622919167, 'decoder_test_rmse_5-step': 2.6639388000928257, 'decoder_test_rmse_6-step': 2.606101386349805, 'method': 'msm', 'seed': 9, 'seconds_taken': 11.739043994995882, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:48:26,335,335 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 11:48:26,337,337 multiprocessing INFO Running EQ_5_B gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:48:26,380,380 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:53:18,122,122 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.8231907924470101, 'encoder_val_rmse_orig': 0.7972781750258248, 'encoder_test_rmse_all': 0.8412213946082138, 'encoder_test_rmse_orig': 0.6181428346124361, 'encoder_test_rmse_last': 0.8239299584846088, 'decoder_val_rmse_all': 0.8231907924470101, 'decoder_val_rmse_orig': 0.7972781750258248, 'decoder_test_rmse_2-step': 0.8563208975708692, 'decoder_test_rmse_3-step': 1.0556228060036037, 'decoder_test_rmse_4-step': 1.238825050361705, 'decoder_test_rmse_5-step': 1.3630479585405875, 'decoder_test_rmse_6-step': 1.4284908612676368, 'method': 'gnet', 'seed': 9, 'seconds_taken': 291.7847806110076, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:53:18,123,123 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 9, 2.0)
MainProcess| 2023-05-15 11:53:18,128,128 multiprocessing INFO Running EQ_5_B ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:53:18,177,177 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:54:07,640,640 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.968150087583106, 'encoder_val_rmse_orig': 0.9362495754760022, 'encoder_test_rmse_all': 1.163847327114954, 'encoder_test_rmse_orig': 0.8488457580205049, 'encoder_test_rmse_last': 1.0816876566988172, 'decoder_val_rmse_all': 0.968150087583106, 'decoder_val_rmse_orig': 0.9362495754760022, 'decoder_test_rmse_2-step': 1.008199410507913, 'decoder_test_rmse_3-step': 1.10458544661647, 'decoder_test_rmse_4-step': 1.1953100910449204, 'decoder_test_rmse_5-step': 1.232474220319474, 'decoder_test_rmse_6-step': 1.2181204174416453, 'method': 'ct', 'seed': 9, 'seconds_taken': 49.51158426699112, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 11:54:07,640,640 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 11:54:07,644,644 multiprocessing INFO Running EQ_5_B rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 11:54:07,691,691 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 11:58:39,346,346 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7678159106985665, 'propensity_treatment_val_bce_orig': 0.767765478752324, 'propensity_treatment_test_bce_all': 0.7605446179877812, 'propensity_treatment_test_bce_orig': 0.7613793627095822, 'propensity_history_val_bce_all': 0.7614283599603257, 'propensity_history_val_bce_orig': 0.7614735786513654, 'propensity_history_test_bce_all': 0.7593688772192052, 'propensity_history_test_bce_orig': 0.7589185528844052, 'encoder_val_rmse_all': 1.4574374780404813, 'encoder_val_rmse_orig': 1.408549746843124, 'encoder_test_rmse_all': 1.5088512441275208, 'encoder_test_rmse_orig': 1.0898519737580281, 'encoder_test_rmse_last': 1.257997892087354, 'decoder_val_rmse_all': 0.28723887575067747, 'decoder_val_rmse_orig': 0.2872388757506774, 'decoder_test_rmse_2-step': 1.0897550029367824, 'decoder_test_rmse_3-step': 1.1157715308701892, 'decoder_test_rmse_4-step': 1.2545087980562886, 'decoder_test_rmse_5-step': 1.426709746188821, 'decoder_test_rmse_6-step': 1.5946543449975839, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 271.70151405999786, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:00:16,450,450 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 12:00:16,453,453 multiprocessing INFO Running EQ_5_C sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:00:16,505,505 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:00:29,377,377 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6990100595633204, 'encoder_test_rmse_orig': 1.2672049072680407, 'encoder_test_rmse_last': 1.4376967794000832, 'decoder_test_rmse_2-step': 1.531927928951183, 'decoder_test_rmse_3-step': 1.498303900238378, 'decoder_test_rmse_4-step': 1.4645597464223412, 'decoder_test_rmse_5-step': 1.4299756618789763, 'decoder_test_rmse_6-step': 1.3970786142204286, 'global_equation_string': 'Treatment 0: x_dot = +-0.3349139195999049*1+0.06577241468577671*x0+0.025362258060439492*u0+0.002917183399514234*x0*u0 | Treatment 1: x_dot = +-0.8239085068897137*1+-0.8897065194872419*x0+0.3245294341533462*u0+-0.11433871900164339*x0*u0 | Treatment 2: x_dot = +1.756362867398984*1+-2.999706475701108*x0+-1.520029993754713*u0+0.36896431018194503*x0*u0 | Treatment 3: x_dot = +-7.821545095500868*1+-3.0948544324296603*x0+0.0862530497485207*u0+-0.0873055133014646*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 12.923472186012077, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:00:29,377,377 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 9, 2.0)
MainProcess| 2023-05-15 12:00:29,380,380 multiprocessing INFO Running EQ_5_C crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:00:29,432,432 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:05:28,652,652 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5792186890729304, 'encoder_val_rmse_orig': 0.5639678474784624, 'encoder_test_rmse_all': 0.8521853817021993, 'encoder_test_rmse_orig': 0.6230140917490928, 'encoder_test_rmse_last': 0.8240134079497436, 'decoder_val_rmse_all': 0.3258714108441058, 'decoder_val_rmse_orig': 0.32587141084410565, 'decoder_test_rmse_2-step': 0.79318409745621, 'decoder_test_rmse_3-step': 0.8519547754851862, 'decoder_test_rmse_4-step': 0.9354066658155809, 'decoder_test_rmse_5-step': 1.027373761371509, 'decoder_test_rmse_6-step': 1.1191596997245716, 'method': 'crn', 'seed': 9, 'seconds_taken': 299.27173330800724, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:05:28,652,652 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 9, 2.0)
MainProcess| 2023-05-15 12:05:28,655,655 multiprocessing INFO Running EQ_5_C msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:05:28,703,703 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:05:39,553,553 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8306295278340854, 'encoder_test_rmse_orig': 1.3305350972659173, 'encoder_test_rmse_last': 1.2962104935341419, 'decoder_test_rmse_2-step': 1.5982762327299849, 'decoder_test_rmse_3-step': 1.8751998557208764, 'decoder_test_rmse_4-step': 2.0116578763879125, 'decoder_test_rmse_5-step': 2.037274898679089, 'decoder_test_rmse_6-step': 1.9890728456292381, 'method': 'msm', 'seed': 9, 'seconds_taken': 10.898137155993027, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:05:39,553,553 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 12:05:39,556,556 multiprocessing INFO Running EQ_5_C gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:05:39,602,602 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:10:21,440,440 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5415370029135457, 'encoder_val_rmse_orig': 0.5268057907394184, 'encoder_test_rmse_all': 0.8180720463308935, 'encoder_test_rmse_orig': 0.6032725378223196, 'encoder_test_rmse_last': 1.018234311389909, 'decoder_val_rmse_all': 0.5415370029135457, 'decoder_val_rmse_orig': 0.5268057907394184, 'decoder_test_rmse_2-step': 0.8953938871597064, 'decoder_test_rmse_3-step': 0.9386232511060096, 'decoder_test_rmse_4-step': 0.9572734414913224, 'decoder_test_rmse_5-step': 0.9400297525561749, 'decoder_test_rmse_6-step': 0.9129154464969517, 'method': 'gnet', 'seed': 9, 'seconds_taken': 281.88438953198784, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:10:21,440,440 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 9, 2.0)
MainProcess| 2023-05-15 12:10:21,443,443 multiprocessing INFO Running EQ_5_C ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:10:21,492,492 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:11:10,966,966 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7026322790566458, 'encoder_val_rmse_orig': 0.6839834816138555, 'encoder_test_rmse_all': 1.2450002997083922, 'encoder_test_rmse_orig': 0.9063340740891532, 'encoder_test_rmse_last': 1.08469757419181, 'decoder_val_rmse_all': 0.7026322790566458, 'decoder_val_rmse_orig': 0.6839834816138555, 'decoder_test_rmse_2-step': 1.0368666934128088, 'decoder_test_rmse_3-step': 1.1021080998928434, 'decoder_test_rmse_4-step': 1.0531698152414555, 'decoder_test_rmse_5-step': 1.0221499420819238, 'decoder_test_rmse_6-step': 0.9712240611977949, 'method': 'ct', 'seed': 9, 'seconds_taken': 49.52274860999023, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:11:10,966,966 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 12:11:10,969,969 multiprocessing INFO Running EQ_5_C rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:11:11,023,23 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:15:44,027,27 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7674985107448962, 'propensity_treatment_val_bce_orig': 0.7675040151488761, 'propensity_treatment_test_bce_all': 0.7533691270425555, 'propensity_treatment_test_bce_orig': 0.7579187507101514, 'propensity_history_val_bce_all': 0.7612627197968409, 'propensity_history_val_bce_orig': 0.761337462414687, 'propensity_history_test_bce_all': 0.7519569463751705, 'propensity_history_test_bce_orig': 0.7549131723407824, 'encoder_val_rmse_all': 1.2602812518533684, 'encoder_val_rmse_orig': 1.2251941994425009, 'encoder_test_rmse_all': 1.278316416587612, 'encoder_test_rmse_orig': 0.9311292072889261, 'encoder_test_rmse_last': 1.189873480909436, 'decoder_val_rmse_all': 0.30234012803942123, 'decoder_val_rmse_orig': 0.3023401280394211, 'decoder_test_rmse_2-step': 1.0194945837259959, 'decoder_test_rmse_3-step': 1.008946365238267, 'decoder_test_rmse_4-step': 0.9762330041024109, 'decoder_test_rmse_5-step': 0.9473929720593975, 'decoder_test_rmse_6-step': 0.9204214068222215, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 273.0574962429964, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:17:19,894,894 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 12:17:19,897,897 multiprocessing INFO Running EQ_5_D sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:17:19,946,946 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:17:34,545,545 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.1141762838217435, 'encoder_test_rmse_orig': 1.5897814521977212, 'encoder_test_rmse_last': 1.5963258458511171, 'decoder_test_rmse_2-step': 1.6879335350517155, 'decoder_test_rmse_3-step': 1.6625128693755848, 'decoder_test_rmse_4-step': 1.628090639204641, 'decoder_test_rmse_5-step': 1.5920737550196133, 'decoder_test_rmse_6-step': 1.5550130837724179, 'global_equation_string': 'Treatment 0: x_dot = +-0.05409908000289315*1+-0.11600263266139853*x0+-0.08019050573092351*u0+0.07327838354867373*x0*u0 | Treatment 1: x_dot = +-0.5513853323797979*1+-0.8761602523145982*x0+-0.05373052128988454*u0+-0.036006315931208774*x0*u0 | Treatment 2: x_dot = +-3.6516866758641715*1+-0.8626202709211677*x0+1.1167851415559553*u0+-0.6374017748903649*x0*u0 | Treatment 3: x_dot = +-1.6395477269681447*1+-3.498571528865055*x0+-3.581459363770935*u0+0.06150704880019835*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 14.64806944099837, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:17:34,546,546 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 9, 2.0)
MainProcess| 2023-05-15 12:17:34,548,548 multiprocessing INFO Running EQ_5_D crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:17:34,601,601 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:22:29,827,827 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.6442691905542137, 'encoder_val_rmse_orig': 0.633631937981385, 'encoder_test_rmse_all': 0.8644224313228329, 'encoder_test_rmse_orig': 0.6240120909494871, 'encoder_test_rmse_last': 0.7648899557659007, 'decoder_val_rmse_all': 0.38311240199096, 'decoder_val_rmse_orig': 0.3831124019909602, 'decoder_test_rmse_2-step': 0.9227354032218592, 'decoder_test_rmse_3-step': 1.0176972431164388, 'decoder_test_rmse_4-step': 1.0555417402746483, 'decoder_test_rmse_5-step': 1.0747037341584464, 'decoder_test_rmse_6-step': 1.0668237066343873, 'method': 'crn', 'seed': 9, 'seconds_taken': 295.27798414799327, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:22:29,827,827 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 9, 2.0)
MainProcess| 2023-05-15 12:22:29,830,830 multiprocessing INFO Running EQ_5_D msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:22:29,876,876 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:22:40,805,805 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.9448757133812309, 'encoder_test_rmse_orig': 1.4041666795687227, 'encoder_test_rmse_last': 1.3189921693333793, 'decoder_test_rmse_2-step': 1.7816377298694988, 'decoder_test_rmse_3-step': 2.052473787661664, 'decoder_test_rmse_4-step': 2.162628489991669, 'decoder_test_rmse_5-step': 2.1883940911136253, 'decoder_test_rmse_6-step': 2.128334155706435, 'method': 'msm', 'seed': 9, 'seconds_taken': 10.975770299992291, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:22:40,806,806 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 12:22:40,808,808 multiprocessing INFO Running EQ_5_D gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:22:40,856,856 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:27:23,046,46 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7171810415061537, 'encoder_val_rmse_orig': 0.7063925845741079, 'encoder_test_rmse_all': 0.7571063813836674, 'encoder_test_rmse_orig': 0.5480535637364017, 'encoder_test_rmse_last': 0.7318510582028697, 'decoder_val_rmse_all': 0.7171810415061537, 'decoder_val_rmse_orig': 0.7063925845741079, 'decoder_test_rmse_2-step': 0.9818140819676878, 'decoder_test_rmse_3-step': 1.12591347481089, 'decoder_test_rmse_4-step': 1.1572678415121165, 'decoder_test_rmse_5-step': 1.1679258706027766, 'decoder_test_rmse_6-step': 1.1475059032798056, 'method': 'gnet', 'seed': 9, 'seconds_taken': 282.2373967399908, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:27:23,046,46 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 9, 2.0)
MainProcess| 2023-05-15 12:27:23,049,49 multiprocessing INFO Running EQ_5_D ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:27:23,098,98 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:28:12,191,191 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.7868656837781441, 'encoder_val_rmse_orig': 0.7737270415761921, 'encoder_test_rmse_all': 1.0404214885915533, 'encoder_test_rmse_orig': 0.7535414103976895, 'encoder_test_rmse_last': 0.9505587076353158, 'decoder_val_rmse_all': 0.7868656837781441, 'decoder_val_rmse_orig': 0.7737270415761921, 'decoder_test_rmse_2-step': 1.0616143198068695, 'decoder_test_rmse_3-step': 1.1093953673019665, 'decoder_test_rmse_4-step': 1.1329167936623847, 'decoder_test_rmse_5-step': 1.1529356134284898, 'decoder_test_rmse_6-step': 1.1072753308290895, 'method': 'ct', 'seed': 9, 'seconds_taken': 49.141583763004746, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:28:12,191,191 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 12:28:12,194,194 multiprocessing INFO Running EQ_5_D rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:28:12,246,246 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2.0, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:32:45,203,203 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7682277786599429, 'propensity_treatment_val_bce_orig': 0.7682330199217705, 'propensity_treatment_test_bce_all': 0.7541573139228087, 'propensity_treatment_test_bce_orig': 0.7594280674064474, 'propensity_history_val_bce_all': 0.7623974978976295, 'propensity_history_val_bce_orig': 0.762438220612766, 'propensity_history_test_bce_all': 0.7547172312249444, 'propensity_history_test_bce_orig': 0.7577310332260797, 'encoder_val_rmse_all': 1.3281391262743885, 'encoder_val_rmse_orig': 1.303735412117077, 'encoder_test_rmse_all': 1.3616589632165335, 'encoder_test_rmse_orig': 0.9814233667559991, 'encoder_test_rmse_last': 1.1758112532306988, 'decoder_val_rmse_all': 0.3478765558475296, 'decoder_val_rmse_orig': 0.34787655584752936, 'decoder_test_rmse_2-step': 1.2384526775588351, 'decoder_test_rmse_3-step': 1.2211585655363242, 'decoder_test_rmse_4-step': 1.1937240512377527, 'decoder_test_rmse_5-step': 1.177182348224484, 'decoder_test_rmse_6-step': 1.1602419531143662, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 273.00862164300634, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:34:14,314,314 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 12:34:14,317,317 multiprocessing INFO Running EQ_4_A sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:34:14,365,365 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:34:17,841,841 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 3.524067947000731, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:34:17,841,841 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 9, 2.0)
MainProcess| 2023-05-15 12:34:17,844,844 multiprocessing INFO Running EQ_4_A wsindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:34:17,891,891 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:34:23,370,370 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13156593344952008, 'encoder_test_rmse_orig': 0.1112806390591032, 'encoder_test_rmse_last': 0.11128610556287555, 'decoder_test_rmse_2-step': 0.11120041385838463, 'decoder_test_rmse_3-step': 0.11084605214775366, 'decoder_test_rmse_4-step': 0.11014112633820551, 'decoder_test_rmse_5-step': 0.10905927587844214, 'decoder_test_rmse_6-step': 0.10760611034396667, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084049095722447*x0*u0 | Treatment 1: x_dot = +-1.0083896344435272*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 9, 'seconds_taken': 5.526483946989174, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:34:23,371,371 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 9, 2.0)
MainProcess| 2023-05-15 12:34:23,373,373 multiprocessing INFO Running EQ_4_A crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:34:23,425,425 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:39:22,453,453 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1051635125584802, 'encoder_val_rmse_orig': 1.1051635125584802, 'encoder_test_rmse_all': 0.8450438548870107, 'encoder_test_rmse_orig': 1.1051893338204088, 'encoder_test_rmse_last': 1.1244227978825736, 'decoder_val_rmse_all': 0.344542346302652, 'decoder_val_rmse_orig': 0.344542346302652, 'decoder_test_rmse_2-step': 1.1727157377127606, 'decoder_test_rmse_3-step': 1.017722911028489, 'decoder_test_rmse_4-step': 1.038507588747131, 'decoder_test_rmse_5-step': 1.1062900406199936, 'decoder_test_rmse_6-step': 1.1873858155764767, 'method': 'crn', 'seed': 9, 'seconds_taken': 299.07926361000864, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:39:22,453,453 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 9, 2.0)
MainProcess| 2023-05-15 12:39:22,456,456 multiprocessing INFO Running EQ_4_A msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:39:22,505,505 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:39:28,055,55 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 9, 'seconds_taken': 5.599240645999089, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:39:28,055,55 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 12:39:28,058,58 multiprocessing INFO Running EQ_4_A gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:39:28,100,100 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:43:49,196,196 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4019975622699962, 'encoder_val_rmse_orig': 0.4019975622699963, 'encoder_test_rmse_all': 0.504196697747899, 'encoder_test_rmse_orig': 0.4017741694706166, 'encoder_test_rmse_last': 0.4144567455472075, 'decoder_val_rmse_all': 0.4019975622699962, 'decoder_val_rmse_orig': 0.4019975622699963, 'decoder_test_rmse_2-step': 0.6126346537634275, 'decoder_test_rmse_3-step': 0.7476615102093053, 'decoder_test_rmse_4-step': 0.8609112584981171, 'decoder_test_rmse_5-step': 0.9496731342887169, 'decoder_test_rmse_6-step': 1.0173980190568164, 'method': 'gnet', 'seed': 9, 'seconds_taken': 261.1380350600084, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:43:49,196,196 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 9, 2.0)
MainProcess| 2023-05-15 12:43:49,199,199 multiprocessing INFO Running EQ_4_A ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:43:49,251,251 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:44:38,094,94 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.2946238383178955, 'encoder_val_rmse_orig': 0.2946238383178955, 'encoder_test_rmse_all': 0.379407927509432, 'encoder_test_rmse_orig': 0.2967023129984225, 'encoder_test_rmse_last': 0.36125168833467475, 'decoder_val_rmse_all': 0.2946238383178955, 'decoder_val_rmse_orig': 0.2946238383178955, 'decoder_test_rmse_2-step': 0.4567786712805986, 'decoder_test_rmse_3-step': 0.6184160785218531, 'decoder_test_rmse_4-step': 0.7391468314878611, 'decoder_test_rmse_5-step': 0.84227462896787, 'decoder_test_rmse_6-step': 0.903771603306915, 'method': 'ct', 'seed': 9, 'seconds_taken': 48.89515835499333, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:44:38,095,95 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 12:44:38,097,97 multiprocessing INFO Running EQ_4_A rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:44:38,151,151 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:49:16,397,397 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4942355792906325, 'propensity_treatment_val_bce_orig': 0.49423557929063244, 'propensity_treatment_test_bce_all': 0.507768298452015, 'propensity_treatment_test_bce_orig': 0.5153424326338876, 'propensity_history_val_bce_all': 0.49209848024077335, 'propensity_history_val_bce_orig': 0.4920984802407733, 'propensity_history_test_bce_all': 0.5048409428850742, 'propensity_history_test_bce_orig': 0.5133539477137419, 'encoder_val_rmse_all': 2.698905078642274, 'encoder_val_rmse_orig': 2.6989050786422735, 'encoder_test_rmse_all': 3.740703901035573, 'encoder_test_rmse_orig': 2.7088462713505432, 'encoder_test_rmse_last': 2.9280836814319375, 'decoder_val_rmse_all': 0.447168297801815, 'decoder_val_rmse_orig': 0.44716829780181544, 'decoder_test_rmse_2-step': 2.4539190960041797, 'decoder_test_rmse_3-step': 2.23951121100967, 'decoder_test_rmse_4-step': 2.1137177671310883, 'decoder_test_rmse_5-step': 2.0542497663261767, 'decoder_test_rmse_6-step': 2.051920631719054, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 278.29887301501003, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:50:43,580,580 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 12:50:43,583,583 multiprocessing INFO Running EQ_4_B sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:50:43,633,633 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:50:47,494,494 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 3.9108603299973765, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:50:47,494,494 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 9, 2.0)
MainProcess| 2023-05-15 12:50:47,497,497 multiprocessing INFO Running EQ_4_B wsindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:50:47,550,550 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:50:53,286,286 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1334820424198281, 'encoder_test_rmse_orig': 0.11334866782665559, 'encoder_test_rmse_last': 0.11344152179060682, 'decoder_test_rmse_2-step': 0.11327047562359786, 'decoder_test_rmse_3-step': 0.11299123349550177, 'decoder_test_rmse_4-step': 0.1123484377736443, 'decoder_test_rmse_5-step': 0.1110922850437242, 'decoder_test_rmse_6-step': 0.10966739801799776, 'global_equation_string': 'Treatment 0: x_dot = +-1.008394655755242*x0*u0 | Treatment 1: x_dot = +-1.0084169361354136*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 9, 'seconds_taken': 5.789283574005822, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:50:53,286,286 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 9, 2.0)
MainProcess| 2023-05-15 12:50:53,289,289 multiprocessing INFO Running EQ_4_B crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:50:53,340,340 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:55:51,907,907 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.121604602887387, 'encoder_val_rmse_orig': 1.121604602887387, 'encoder_test_rmse_all': 0.8564296816684986, 'encoder_test_rmse_orig': 1.121783494216752, 'encoder_test_rmse_last': 1.1405794861225, 'decoder_val_rmse_all': 0.345563478990265, 'decoder_val_rmse_orig': 0.3455634789902648, 'decoder_test_rmse_2-step': 1.1994164792364443, 'decoder_test_rmse_3-step': 1.0340940494426059, 'decoder_test_rmse_4-step': 1.0493440324620513, 'decoder_test_rmse_5-step': 1.1137851914929962, 'decoder_test_rmse_6-step': 1.19280119626871, 'method': 'crn', 'seed': 9, 'seconds_taken': 298.6174649050081, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:55:51,907,907 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 9, 2.0)
MainProcess| 2023-05-15 12:55:51,910,910 multiprocessing INFO Running EQ_4_B msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:55:51,958,958 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 12:55:59,464,464 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 9, 'seconds_taken': 7.554151181000634, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 12:55:59,464,464 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 12:55:59,467,467 multiprocessing INFO Running EQ_4_B gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 12:55:59,518,518 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:00:35,475,475 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.40260118852616805, 'encoder_val_rmse_orig': 0.40260118852616805, 'encoder_test_rmse_all': 0.5048618500777101, 'encoder_test_rmse_orig': 0.40244400822890286, 'encoder_test_rmse_last': 0.4150725258660098, 'decoder_val_rmse_all': 0.40260118852616805, 'decoder_val_rmse_orig': 0.40260118852616805, 'decoder_test_rmse_2-step': 0.6133486102321225, 'decoder_test_rmse_3-step': 0.7481488724733374, 'decoder_test_rmse_4-step': 0.8616884297410414, 'decoder_test_rmse_5-step': 0.9506994227335203, 'decoder_test_rmse_6-step': 1.0185752813631879, 'method': 'gnet', 'seed': 9, 'seconds_taken': 276.0073309879954, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:00:35,475,475 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 9, 2.0)
MainProcess| 2023-05-15 13:00:35,478,478 multiprocessing INFO Running EQ_4_B ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:00:35,530,530 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:01:25,270,270 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.29289570635259926, 'encoder_val_rmse_orig': 0.2928957063525993, 'encoder_test_rmse_all': 0.3765426592861505, 'encoder_test_rmse_orig': 0.2949676756056017, 'encoder_test_rmse_last': 0.3579691930220499, 'decoder_val_rmse_all': 0.29289570635259926, 'decoder_val_rmse_orig': 0.2928957063525993, 'decoder_test_rmse_2-step': 0.4515493607684361, 'decoder_test_rmse_3-step': 0.6133461347971214, 'decoder_test_rmse_4-step': 0.731909257614402, 'decoder_test_rmse_5-step': 0.8326128659044332, 'decoder_test_rmse_6-step': 0.8922809692674071, 'method': 'ct', 'seed': 9, 'seconds_taken': 49.79238495300524, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:01:25,270,270 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 13:01:25,273,273 multiprocessing INFO Running EQ_4_B rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:01:25,333,333 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:06:10,030,30 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4942355792906325, 'propensity_treatment_val_bce_orig': 0.49423557929063244, 'propensity_treatment_test_bce_all': 0.507768298452015, 'propensity_treatment_test_bce_orig': 0.5153424326338876, 'propensity_history_val_bce_all': 0.49212524234743443, 'propensity_history_val_bce_orig': 0.49212524234743443, 'propensity_history_test_bce_all': 0.5048907368372557, 'propensity_history_test_bce_orig': 0.5133802027899452, 'encoder_val_rmse_all': 2.6968238847629706, 'encoder_val_rmse_orig': 2.696823884762971, 'encoder_test_rmse_all': 3.740683818413135, 'encoder_test_rmse_orig': 2.7076437410377774, 'encoder_test_rmse_last': 2.969062029167223, 'decoder_val_rmse_all': 0.3960009348880973, 'decoder_val_rmse_orig': 0.3960009348880973, 'decoder_test_rmse_2-step': 2.4053821962893736, 'decoder_test_rmse_3-step': 2.1926861643856923, 'decoder_test_rmse_4-step': 2.052156525966347, 'decoder_test_rmse_5-step': 1.967376327711766, 'decoder_test_rmse_6-step': 1.9337953198214595, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 284.75638030799746, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:07:37,835,835 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 13:07:37,840,840 multiprocessing INFO Running EQ_4_C sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:07:37,891,891 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:07:41,528,528 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 3.6876926040131366, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:07:41,528,528 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 9, 2.0)
MainProcess| 2023-05-15 13:07:41,531,531 multiprocessing INFO Running EQ_4_C wsindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:07:41,582,582 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:07:47,243,243 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1485895237258789, 'encoder_test_rmse_orig': 0.12101813582817425, 'encoder_test_rmse_last': 0.12090026465950583, 'decoder_test_rmse_2-step': 0.12062293517881942, 'decoder_test_rmse_3-step': 0.11987153533565165, 'decoder_test_rmse_4-step': 0.11857423605465325, 'decoder_test_rmse_5-step': 0.11644818766184527, 'decoder_test_rmse_6-step': 0.11403018258626887, 'global_equation_string': 'Treatment 0: x_dot = +-0.044823986535041785*x0+-1.0197477577423621*x0*u0 | Treatment 1: x_dot = +-0.14603569522573454*x0+-1.0223479528340231*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 9, 'seconds_taken': 5.712510878001922, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:07:47,244,244 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 9, 2.0)
MainProcess| 2023-05-15 13:07:47,246,246 multiprocessing INFO Running EQ_4_C crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:07:47,292,292 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:12:52,257,257 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0160442169580588, 'encoder_val_rmse_orig': 1.0160442169580588, 'encoder_test_rmse_all': 0.8006937025002443, 'encoder_test_rmse_orig': 1.016811615248313, 'encoder_test_rmse_last': 1.0342186178320654, 'decoder_val_rmse_all': 0.3042960760477292, 'decoder_val_rmse_orig': 0.304296076047729, 'decoder_test_rmse_2-step': 0.7160360626792059, 'decoder_test_rmse_3-step': 0.6760576226991927, 'decoder_test_rmse_4-step': 0.7503107828900849, 'decoder_test_rmse_5-step': 0.8403007082901666, 'decoder_test_rmse_6-step': 0.9201538463147115, 'method': 'crn', 'seed': 9, 'seconds_taken': 305.01035072999366, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:12:52,257,257 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 9, 2.0)
MainProcess| 2023-05-15 13:12:52,260,260 multiprocessing INFO Running EQ_4_C msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:12:52,308,308 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:12:57,978,978 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 9, 'seconds_taken': 5.717750088006142, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:12:57,978,978 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 13:12:57,981,981 multiprocessing INFO Running EQ_4_C gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:12:58,029,29 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:17:24,971,971 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.36470293986420893, 'encoder_val_rmse_orig': 0.36470293986420893, 'encoder_test_rmse_all': 0.4472689413187225, 'encoder_test_rmse_orig': 0.3642147743832294, 'encoder_test_rmse_last': 0.3718248171714092, 'decoder_val_rmse_all': 0.36470293986420893, 'decoder_val_rmse_orig': 0.36470293986420893, 'decoder_test_rmse_2-step': 0.5478709740207883, 'decoder_test_rmse_3-step': 0.6474635523156793, 'decoder_test_rmse_4-step': 0.7269839749876275, 'decoder_test_rmse_5-step': 0.7828277699547139, 'decoder_test_rmse_6-step': 0.8193528854463623, 'method': 'gnet', 'seed': 9, 'seconds_taken': 266.9900178759999, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:17:24,971,971 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 9, 2.0)
MainProcess| 2023-05-15 13:17:24,974,974 multiprocessing INFO Running EQ_4_C ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:17:25,025,25 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:18:13,475,475 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.28399277271736784, 'encoder_val_rmse_orig': 0.2839927727173679, 'encoder_test_rmse_all': 0.3667004764796449, 'encoder_test_rmse_orig': 0.28482605500790936, 'encoder_test_rmse_last': 0.3204598107066832, 'decoder_val_rmse_all': 0.28399277271736784, 'decoder_val_rmse_orig': 0.2839927727173679, 'decoder_test_rmse_2-step': 0.404914658406742, 'decoder_test_rmse_3-step': 0.546057143300357, 'decoder_test_rmse_4-step': 0.6615690287812894, 'decoder_test_rmse_5-step': 0.747435262009166, 'decoder_test_rmse_6-step': 0.798786959299834, 'method': 'ct', 'seed': 9, 'seconds_taken': 48.50144691899186, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:18:13,476,476 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 13:18:13,478,478 multiprocessing INFO Running EQ_4_C rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:18:13,531,531 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:22:53,043,43 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.4942355792906325, 'propensity_treatment_val_bce_orig': 0.49423557929063244, 'propensity_treatment_test_bce_all': 0.507768298452015, 'propensity_treatment_test_bce_orig': 0.5153424326338876, 'propensity_history_val_bce_all': 0.4920776521250353, 'propensity_history_val_bce_orig': 0.4920776521250353, 'propensity_history_test_bce_all': 0.5048018091917038, 'propensity_history_test_bce_orig': 0.5133332909938765, 'encoder_val_rmse_all': 2.541448799199704, 'encoder_val_rmse_orig': 2.5414487991997046, 'encoder_test_rmse_all': 3.534437236389399, 'encoder_test_rmse_orig': 2.5521616954128823, 'encoder_test_rmse_last': 2.779408826590426, 'decoder_val_rmse_all': 0.32044621933845735, 'decoder_val_rmse_orig': 0.32044621933845713, 'decoder_test_rmse_2-step': 2.159912644621603, 'decoder_test_rmse_3-step': 1.9082666656448068, 'decoder_test_rmse_4-step': 1.7356801620511473, 'decoder_test_rmse_5-step': 1.6198033587931475, 'decoder_test_rmse_6-step': 1.550926124681221, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 279.5647337739938, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:24:23,789,789 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 9, 2.0)
MainProcess| 2023-05-15 13:24:23,792,792 multiprocessing INFO Running EQ_4_D sindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:24:23,842,842 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:24:29,532,532 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 9, 'seconds_taken': 5.740303006008617, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:24:29,532,532 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 9, 2.0)
MainProcess| 2023-05-15 13:24:29,535,535 multiprocessing INFO Running EQ_4_D wsindy 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:24:29,586,586 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:24:35,122,122 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.12013831781552074, 'encoder_test_rmse_orig': 0.10199754991015454, 'encoder_test_rmse_last': 0.10244873232768986, 'decoder_test_rmse_2-step': 0.10253554209724353, 'decoder_test_rmse_3-step': 0.10286318062982668, 'decoder_test_rmse_4-step': 0.10287543464303567, 'decoder_test_rmse_5-step': 0.10258397197726565, 'decoder_test_rmse_6-step': 0.10175385297454073, 'global_equation_string': 'Treatment 0: x_dot = +0.19779908892854015*x0+-1.0096594829490602*x0*u0 | Treatment 1: x_dot = +-0.09094385915331273*x0+-1.0201783255160224*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 9, 'seconds_taken': 5.5870752280025044, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:24:35,123,123 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 9, 2.0)
MainProcess| 2023-05-15 13:24:35,125,125 multiprocessing INFO Running EQ_4_D crn 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:24:35,177,177 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:29:43,002,2 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9393169337413632, 'encoder_val_rmse_orig': 0.9393169337413632, 'encoder_test_rmse_all': 0.7953231740013245, 'encoder_test_rmse_orig': 0.9691318030359142, 'encoder_test_rmse_last': 1.2420354606430088, 'decoder_val_rmse_all': 0.4062138505878235, 'decoder_val_rmse_orig': 0.4062138505878236, 'decoder_test_rmse_2-step': 2.305904931210809, 'decoder_test_rmse_3-step': 2.1316590659533046, 'decoder_test_rmse_4-step': 2.0891047524873216, 'decoder_test_rmse_5-step': 2.0882265578102808, 'decoder_test_rmse_6-step': 2.110166742618863, 'method': 'crn', 'seed': 9, 'seconds_taken': 307.8758432439936, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:29:43,002,2 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 9, 2.0)
MainProcess| 2023-05-15 13:29:43,004,4 multiprocessing INFO Running EQ_4_D msm 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:29:43,053,53 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:29:50,389,389 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 9, 'seconds_taken': 7.383993848998216, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:29:50,389,389 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 9, 2.0)
MainProcess| 2023-05-15 13:29:50,392,392 multiprocessing INFO Running EQ_4_D gnet 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:29:50,442,442 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:34:15,628,628 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.35456810620515533, 'encoder_val_rmse_orig': 0.3545681062051553, 'encoder_test_rmse_all': 0.4308054695946426, 'encoder_test_rmse_orig': 0.35458252773030763, 'encoder_test_rmse_last': 0.3670926243602458, 'decoder_val_rmse_all': 0.35456810620515533, 'decoder_val_rmse_orig': 0.3545681062051553, 'decoder_test_rmse_2-step': 0.5021974536145675, 'decoder_test_rmse_3-step': 0.5917393082127149, 'decoder_test_rmse_4-step': 0.6617416392793557, 'decoder_test_rmse_5-step': 0.724084141508181, 'decoder_test_rmse_6-step': 0.7789201257000657, 'method': 'gnet', 'seed': 9, 'seconds_taken': 265.23592277700664, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:34:15,628,628 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 9, 2.0)
MainProcess| 2023-05-15 13:34:15,631,631 multiprocessing INFO Running EQ_4_D ct 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:34:15,680,680 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:35:04,304,304 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.348463607891141, 'encoder_val_rmse_orig': 0.348463607891141, 'encoder_test_rmse_all': 0.4473013909417741, 'encoder_test_rmse_orig': 0.38009848231607934, 'encoder_test_rmse_last': 0.6622307836988056, 'decoder_val_rmse_all': 0.348463607891141, 'decoder_val_rmse_orig': 0.348463607891141, 'decoder_test_rmse_2-step': 0.7155560278671392, 'decoder_test_rmse_3-step': 0.7602727335600099, 'decoder_test_rmse_4-step': 0.8295848433300492, 'decoder_test_rmse_5-step': 0.887157892458244, 'decoder_test_rmse_6-step': 0.9266434622797564, 'method': 'ct', 'seed': 9, 'seconds_taken': 48.672712442988995, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 13:35:04,304,304 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 9, 2.0)
MainProcess| 2023-05-15 13:35:04,306,306 multiprocessing INFO Running EQ_4_D rmsn 9 | domain_conf=2.0
MainProcess| 2023-05-15 13:35:04,359,359 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 9, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 13:39:43,675,675 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5018521952831139, 'propensity_treatment_val_bce_orig': 0.501852195283114, 'propensity_treatment_test_bce_all': 0.5150649640186359, 'propensity_treatment_test_bce_orig': 0.5221697326739514, 'propensity_history_val_bce_all': 0.49982688499709305, 'propensity_history_val_bce_orig': 0.4998268849970931, 'propensity_history_test_bce_all': 0.5123577030102412, 'propensity_history_test_bce_orig': 0.5202896251984787, 'encoder_val_rmse_all': 2.617913074116981, 'encoder_val_rmse_orig': 2.6179130741169807, 'encoder_test_rmse_all': 3.6077635149754665, 'encoder_test_rmse_orig': 2.627836208234768, 'encoder_test_rmse_last': 2.797888181712153, 'decoder_val_rmse_all': 0.24870722066080803, 'decoder_val_rmse_orig': 0.24870722066080772, 'decoder_test_rmse_2-step': 2.3434590512341753, 'decoder_test_rmse_3-step': 2.1895439401148384, 'decoder_test_rmse_4-step': 2.0880292303936288, 'decoder_test_rmse_5-step': 2.0123855531657786, 'decoder_test_rmse_6-step': 1.958320001133645, 'method': 'rmsn', 'seed': 9, 'seconds_taken': 279.36827310398803, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:34:13,317,317 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 18:34:13,320,320 multiprocessing INFO Running cancer_sim sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:34:13,374,374 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:34:26,506,506 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.8590274129929585, 'encoder_test_rmse_orig': 1.4154394235251138, 'encoder_test_rmse_last': 1.6758154545834107, 'decoder_test_rmse_2-step': 0.715743988166079, 'decoder_test_rmse_3-step': 0.723515727466902, 'decoder_test_rmse_4-step': 0.7301157793589865, 'decoder_test_rmse_5-step': 0.7323977099687957, 'decoder_test_rmse_6-step': 0.7336853580711198, 'global_equation_string': 'Treatment 0: x_dot = +-0.23289937252854623*1+0.03833621473232831*x0+0.018247193194504033*u0+0.017122092011270455*x0*u0 | Treatment 1: x_dot = +1.5073238692265027*1+-1.6310659841258652*x0+-0.8431675438051872*u0+0.24802929066372228*x0*u0 | Treatment 2: x_dot = +0.4110156395214163*1+-2.085902528738108*x0+-0.8567956424569358*u0+-0.17805421516743117*x0*u0 | Treatment 3: x_dot = +-8.960385749382013*1+-2.483539915759043*x0+-0.8208245791374845*u0+-0.2132663745269498*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 13.185965489014052, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:34:26,506,506 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'crn', 10, 2.0)
MainProcess| 2023-05-15 18:34:26,509,509 multiprocessing INFO Running cancer_sim crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:34:26,563,563 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:39:18,037,37 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.9331277640476844, 'encoder_val_rmse_orig': 0.9114971422938634, 'encoder_test_rmse_all': 0.9863191289300972, 'encoder_test_rmse_orig': 0.7166254446040334, 'encoder_test_rmse_last': 1.205130306457842, 'decoder_val_rmse_all': 0.3058680328177018, 'decoder_val_rmse_orig': 0.3058680328177017, 'decoder_test_rmse_2-step': 0.4521939879848943, 'decoder_test_rmse_3-step': 0.5220333208198521, 'decoder_test_rmse_4-step': 0.5783614560774438, 'decoder_test_rmse_5-step': 0.6264146267788908, 'decoder_test_rmse_6-step': 0.6541491561316879, 'method': 'crn', 'seed': 10, 'seconds_taken': 291.52781297698675, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:39:18,037,37 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'msm', 10, 2.0)
MainProcess| 2023-05-15 18:39:18,040,40 multiprocessing INFO Running cancer_sim msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:39:18,086,86 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:39:29,498,498 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.0245426405717226, 'encoder_test_rmse_orig': 1.463970674383332, 'encoder_test_rmse_last': 1.620690212844637, 'decoder_test_rmse_2-step': 1.3517494891019766, 'decoder_test_rmse_3-step': 1.6212069107014369, 'decoder_test_rmse_4-step': 1.7440565794019356, 'decoder_test_rmse_5-step': 1.8130115426438098, 'decoder_test_rmse_6-step': 1.809555782813769, 'method': 'msm', 'seed': 10, 'seconds_taken': 11.457786436993047, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:39:29,498,498 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 18:39:29,501,501 multiprocessing INFO Running cancer_sim gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:39:29,549,549 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:44:07,635,635 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.892599630389731, 'encoder_val_rmse_orig': 0.8716203228411512, 'encoder_test_rmse_all': 0.9970558803740691, 'encoder_test_rmse_orig': 0.721038831424583, 'encoder_test_rmse_last': 1.1768139428733801, 'decoder_val_rmse_all': 0.892599630389731, 'decoder_val_rmse_orig': 0.8716203228411512, 'decoder_test_rmse_2-step': 0.7573991050856688, 'decoder_test_rmse_3-step': 0.9809203601541663, 'decoder_test_rmse_4-step': 1.0211361495790878, 'decoder_test_rmse_5-step': 1.0338394851437056, 'decoder_test_rmse_6-step': 1.0190465488712412, 'method': 'gnet', 'seed': 10, 'seconds_taken': 278.1341184049961, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:44:07,635,635 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'ct', 10, 2.0)
MainProcess| 2023-05-15 18:44:07,638,638 multiprocessing INFO Running cancer_sim ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:44:07,688,688 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:44:59,366,366 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.027525189416524, 'encoder_val_rmse_orig': 1.003811012163115, 'encoder_test_rmse_all': 1.1854099271969387, 'encoder_test_rmse_orig': 0.8658782327907231, 'encoder_test_rmse_last': 1.4192907032918423, 'decoder_val_rmse_all': 1.027525189416524, 'decoder_val_rmse_orig': 1.003811012163115, 'decoder_test_rmse_2-step': 0.5907301967746291, 'decoder_test_rmse_3-step': 0.7289652047021321, 'decoder_test_rmse_4-step': 0.8253402535675682, 'decoder_test_rmse_5-step': 0.8741269288857132, 'decoder_test_rmse_6-step': 0.8953720305733522, 'method': 'ct', 'seed': 10, 'seconds_taken': 51.72796502900019, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:44:59,366,366 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 18:44:59,369,369 multiprocessing INFO Running cancer_sim rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:44:59,423,423 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:49:25,257,257 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7687530592269863, 'propensity_treatment_val_bce_orig': 0.7687875685292215, 'propensity_treatment_test_bce_all': 0.7706649253476581, 'propensity_treatment_test_bce_orig': 0.7681901701358158, 'propensity_history_val_bce_all': 0.7632555532264199, 'propensity_history_val_bce_orig': 0.7633774858170654, 'propensity_history_test_bce_all': 0.773497101525524, 'propensity_history_test_bce_orig': 0.7688428184255945, 'encoder_val_rmse_all': 1.458686367218776, 'encoder_val_rmse_orig': 1.423649729966157, 'encoder_test_rmse_all': 1.5598992612091644, 'encoder_test_rmse_orig': 1.121211707461954, 'encoder_test_rmse_last': 1.4834380651001937, 'decoder_val_rmse_all': 0.31902008903241097, 'decoder_val_rmse_orig': 0.319020089032411, 'decoder_test_rmse_2-step': 0.5960976824630877, 'decoder_test_rmse_3-step': 0.615505031979313, 'decoder_test_rmse_4-step': 0.6279414192127247, 'decoder_test_rmse_5-step': 0.6537658888018506, 'decoder_test_rmse_6-step': 0.6717785456911103, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 265.8875393490016, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:51:13,721,721 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 18:51:13,723,723 multiprocessing INFO Running EQ_5_A sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:51:13,777,777 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:51:27,337,337 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.4355394929412262, 'encoder_test_rmse_orig': 1.0960263558693342, 'encoder_test_rmse_last': 1.088678662044641, 'decoder_test_rmse_2-step': 1.2642803313440487, 'decoder_test_rmse_3-step': 1.2723488743451863, 'decoder_test_rmse_4-step': 1.2908398030242976, 'decoder_test_rmse_5-step': 1.312743049831418, 'decoder_test_rmse_6-step': 1.3390674747406934, 'global_equation_string': 'Treatment 0: x_dot = +-0.023784944400154596*1+-0.01544264582992373*x0+-0.023784944400154585*u0+-0.015442645829923765*x0*u0 | Treatment 1: x_dot = +-0.20073304275969767*1+-0.4902095687323896*x0+-0.20073304275969775*u0+-0.4902095687323895*x0*u0 | Treatment 2: x_dot = +-0.7471858823915185*1+-1.1891051954237228*x0+-0.7471858823915184*u0+-1.1891051954237217*x0*u0 | Treatment 3: x_dot = +-5.372972176638321*1+-1.5223572764619941*x0+-5.372972176638328*u0+-1.5223572764619513*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 13.61331067699939, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:51:27,337,337 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'crn', 10, 2.0)
MainProcess| 2023-05-15 18:51:27,340,340 multiprocessing INFO Running EQ_5_A crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:51:27,394,394 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:56:20,650,650 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4337363917102608, 'encoder_val_rmse_orig': 0.43030431759354604, 'encoder_test_rmse_all': 0.6865432162640784, 'encoder_test_rmse_orig': 0.5021870510666063, 'encoder_test_rmse_last': 0.4919513956487702, 'decoder_val_rmse_all': 0.25002209546709375, 'decoder_val_rmse_orig': 0.2500220954670938, 'decoder_test_rmse_2-step': 0.6073078175022283, 'decoder_test_rmse_3-step': 0.7448758369260531, 'decoder_test_rmse_4-step': 0.8418430781469153, 'decoder_test_rmse_5-step': 0.918911701128657, 'decoder_test_rmse_6-step': 0.9891046485968015, 'method': 'crn', 'seed': 10, 'seconds_taken': 293.31013387200073, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:56:20,650,650 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'msm', 10, 2.0)
MainProcess| 2023-05-15 18:56:20,653,653 multiprocessing INFO Running EQ_5_A msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:56:20,702,702 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 18:56:32,207,207 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.1010695281987863, 'encoder_test_rmse_orig': 0.7985600256396778, 'encoder_test_rmse_last': 0.7733340556597772, 'decoder_test_rmse_2-step': 1.4045326881093922, 'decoder_test_rmse_3-step': 1.6930629714078522, 'decoder_test_rmse_4-step': 1.884705269998968, 'decoder_test_rmse_5-step': 1.9842946155346783, 'decoder_test_rmse_6-step': 2.0247162388674314, 'method': 'msm', 'seed': 10, 'seconds_taken': 11.553729668012238, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 18:56:32,207,207 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 18:56:32,210,210 multiprocessing INFO Running EQ_5_A gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 18:56:32,261,261 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:01:19,804,804 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.419101605293675, 'encoder_val_rmse_orig': 0.41548607984286934, 'encoder_test_rmse_all': 0.6296510392622207, 'encoder_test_rmse_orig': 0.4608163979513458, 'encoder_test_rmse_last': 0.45512958616718785, 'decoder_val_rmse_all': 0.419101605293675, 'decoder_val_rmse_orig': 0.41548607984286934, 'decoder_test_rmse_2-step': 0.8270983157544345, 'decoder_test_rmse_3-step': 1.0167187808753853, 'decoder_test_rmse_4-step': 1.083020788487784, 'decoder_test_rmse_5-step': 1.1170773910035967, 'decoder_test_rmse_6-step': 1.153695697663119, 'method': 'gnet', 'seed': 10, 'seconds_taken': 287.5946330220031, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:01:19,805,805 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'ct', 10, 2.0)
MainProcess| 2023-05-15 19:01:19,807,807 multiprocessing INFO Running EQ_5_A ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:01:19,859,859 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:02:09,180,180 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4178499159959808, 'encoder_val_rmse_orig': 0.414806761777345, 'encoder_test_rmse_all': 0.7231833274156061, 'encoder_test_rmse_orig': 0.5381011134891972, 'encoder_test_rmse_last': 0.5195493420323494, 'decoder_val_rmse_all': 0.4178499159959808, 'decoder_val_rmse_orig': 0.414806761777345, 'decoder_test_rmse_2-step': 0.6197040423490621, 'decoder_test_rmse_3-step': 0.8319212623850014, 'decoder_test_rmse_4-step': 1.0000895501827674, 'decoder_test_rmse_5-step': 1.1070012154816484, 'decoder_test_rmse_6-step': 1.1760304997958706, 'method': 'ct', 'seed': 10, 'seconds_taken': 49.37248447799357, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:02:09,180,180 multiprocessing INFO [Now evaluating exp] ('EQ_5_A', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 19:02:09,183,183 multiprocessing INFO Running EQ_5_A rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:02:09,237,237 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_A', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:06:35,801,801 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7671447852260618, 'propensity_treatment_val_bce_orig': 0.7671292723163801, 'propensity_treatment_test_bce_all': 0.7498714109688626, 'propensity_treatment_test_bce_orig': 0.7554778977716227, 'propensity_history_val_bce_all': 0.7630916544930666, 'propensity_history_val_bce_orig': 0.7631029234526593, 'propensity_history_test_bce_all': 0.750251335859411, 'propensity_history_test_bce_orig': 0.7545498228959611, 'encoder_val_rmse_all': 0.5673483048056346, 'encoder_val_rmse_orig': 0.5625422395179172, 'encoder_test_rmse_all': 0.7868918545030039, 'encoder_test_rmse_orig': 0.5762892412904264, 'encoder_test_rmse_last': 0.5988266813908011, 'decoder_val_rmse_all': 0.26234352974328196, 'decoder_val_rmse_orig': 0.2623435297432819, 'decoder_test_rmse_2-step': 0.7184890289300684, 'decoder_test_rmse_3-step': 0.7693001042869186, 'decoder_test_rmse_4-step': 0.8140529099018874, 'decoder_test_rmse_5-step': 0.8425465451018722, 'decoder_test_rmse_6-step': 0.8643294918007333, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 266.61861232999945, 'errored': False, 'dataset_name': 'EQ_5_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:08:24,799,799 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 19:08:24,802,802 multiprocessing INFO Running EQ_5_B sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:08:24,854,854 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:08:38,574,574 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.4355431115329087, 'encoder_test_rmse_orig': 1.0960275027293227, 'encoder_test_rmse_last': 1.0886912945861658, 'decoder_test_rmse_2-step': 1.2642915022070604, 'decoder_test_rmse_3-step': 1.2723585149675074, 'decoder_test_rmse_4-step': 1.2908474137384087, 'decoder_test_rmse_5-step': 1.3127487560171565, 'decoder_test_rmse_6-step': 1.339075065444748, 'global_equation_string': 'Treatment 0: x_dot = +-0.02353288515960747*1+-0.015436932768303812*x0+-0.023532885159607473*u0+-0.015436932768303843*x0*u0 | Treatment 1: x_dot = +-0.20092389922873685*1+-0.4902241772560684*x0+-0.20092389922873694*u0+-0.49022417725606804*x0*u0 | Treatment 2: x_dot = +-0.7475589919196012*1+-1.1891245179421999*x0+-0.7475589919196007*u0+-1.1891245179421976*x0*u0 | Treatment 3: x_dot = +-5.372412002844353*1+-1.5223537145850436*x0+-5.372412002844355*u0+-1.5223537145850414*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 13.77220474499336, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:08:38,575,575 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'crn', 10, 2.0)
MainProcess| 2023-05-15 19:08:38,577,577 multiprocessing INFO Running EQ_5_B crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:08:38,630,630 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:13:35,162,162 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4337399578366513, 'encoder_val_rmse_orig': 0.43030779324238166, 'encoder_test_rmse_all': 0.6865507618595356, 'encoder_test_rmse_orig': 0.5021935904494368, 'encoder_test_rmse_last': 0.491947903772909, 'decoder_val_rmse_all': 0.2500252115090476, 'decoder_val_rmse_orig': 0.2500252115090476, 'decoder_test_rmse_2-step': 0.6072973565355789, 'decoder_test_rmse_3-step': 0.7448620758530595, 'decoder_test_rmse_4-step': 0.8418343708584198, 'decoder_test_rmse_5-step': 0.9188954830854489, 'decoder_test_rmse_6-step': 0.9890911731269254, 'method': 'crn', 'seed': 10, 'seconds_taken': 296.584164305008, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:13:35,162,162 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'msm', 10, 2.0)
MainProcess| 2023-05-15 19:13:35,164,164 multiprocessing INFO Running EQ_5_B msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:13:35,213,213 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:13:46,880,880 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.1010698524492863, 'encoder_test_rmse_orig': 0.7985604890423057, 'encoder_test_rmse_last': 0.7733365125067851, 'decoder_test_rmse_2-step': 1.4045354524110523, 'decoder_test_rmse_3-step': 1.6930503344315715, 'decoder_test_rmse_4-step': 1.8847028905745027, 'decoder_test_rmse_5-step': 1.9842808244543677, 'decoder_test_rmse_6-step': 2.024717232809829, 'method': 'msm', 'seed': 10, 'seconds_taken': 11.714953788003186, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:13:46,880,880 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 19:13:46,882,882 multiprocessing INFO Running EQ_5_B gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:13:46,930,930 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:18:40,043,43 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4191021678922193, 'encoder_val_rmse_orig': 0.415486627956785, 'encoder_test_rmse_all': 0.6296733313271767, 'encoder_test_rmse_orig': 0.46083329218449137, 'encoder_test_rmse_last': 0.455140165813036, 'decoder_val_rmse_all': 0.4191021678922193, 'decoder_val_rmse_orig': 0.415486627956785, 'decoder_test_rmse_2-step': 0.8027247731797008, 'decoder_test_rmse_3-step': 0.9907621428466573, 'decoder_test_rmse_4-step': 1.0656373776040757, 'decoder_test_rmse_5-step': 1.1193036809901458, 'decoder_test_rmse_6-step': 1.1647964271112163, 'method': 'gnet', 'seed': 10, 'seconds_taken': 293.1606829289958, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:18:40,043,43 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'ct', 10, 2.0)
MainProcess| 2023-05-15 19:18:40,046,46 multiprocessing INFO Running EQ_5_B ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:18:40,098,98 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:19:29,809,809 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4150004558840047, 'encoder_val_rmse_orig': 0.4120033171186554, 'encoder_test_rmse_all': 0.7209600473615598, 'encoder_test_rmse_orig': 0.5367427948494726, 'encoder_test_rmse_last': 0.5200643619512255, 'decoder_val_rmse_all': 0.4150004558840047, 'decoder_val_rmse_orig': 0.4120033171186554, 'decoder_test_rmse_2-step': 0.6098142010392649, 'decoder_test_rmse_3-step': 0.8204273244205859, 'decoder_test_rmse_4-step': 0.9825710174630402, 'decoder_test_rmse_5-step': 1.0873795880172337, 'decoder_test_rmse_6-step': 1.1560934469830466, 'method': 'ct', 'seed': 10, 'seconds_taken': 49.76304654699925, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:19:29,809,809 multiprocessing INFO [Now evaluating exp] ('EQ_5_B', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 19:19:29,812,812 multiprocessing INFO Running EQ_5_B rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:19:29,867,867 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_B', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:23:57,920,920 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7671447852260618, 'propensity_treatment_val_bce_orig': 0.7671292723163801, 'propensity_treatment_test_bce_all': 0.7498714109688626, 'propensity_treatment_test_bce_orig': 0.7554778977716227, 'propensity_history_val_bce_all': 0.7612569805020011, 'propensity_history_val_bce_orig': 0.7612665984822387, 'propensity_history_test_bce_all': 0.7488105250253269, 'propensity_history_test_bce_orig': 0.7529582577852196, 'encoder_val_rmse_all': 0.5698601618977616, 'encoder_val_rmse_orig': 0.5650270904034782, 'encoder_test_rmse_all': 0.7881734656243733, 'encoder_test_rmse_orig': 0.577332429701992, 'encoder_test_rmse_last': 0.6002458483359671, 'decoder_val_rmse_all': 0.2653354439347863, 'decoder_val_rmse_orig': 0.26533544393478614, 'decoder_test_rmse_2-step': 0.7139386645965008, 'decoder_test_rmse_3-step': 0.7639963845684083, 'decoder_test_rmse_4-step': 0.8092273019936073, 'decoder_test_rmse_5-step': 0.8373621077349729, 'decoder_test_rmse_6-step': 0.8563605277407158, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 268.1077409779973, 'errored': False, 'dataset_name': 'EQ_5_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:26:00,060,60 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 19:26:00,063,63 multiprocessing INFO Running EQ_5_C sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:26:00,112,112 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:26:13,652,652 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.906584940783992, 'encoder_test_rmse_orig': 1.6477752198225573, 'encoder_test_rmse_last': 1.6802333453343463, 'decoder_test_rmse_2-step': 1.2726940585373219, 'decoder_test_rmse_3-step': 1.303018136307232, 'decoder_test_rmse_4-step': 1.348110960717405, 'decoder_test_rmse_5-step': 1.4012010936390649, 'decoder_test_rmse_6-step': 1.4551991777970357, 'global_equation_string': 'Treatment 0: x_dot = +-0.19080268761343025*1+0.04402272786037651*x0+-0.036484973010534355*u0+0.012331783656517903*x0*u0 | Treatment 1: x_dot = +-0.09092986584801704*1+-1.0052874097326692*x0+-0.005131428464012247*u0+-0.05961388764777559*x0*u0 | Treatment 2: x_dot = +-1.921073202830765*1+-1.6831277240331755*x0+-0.08853784900278111*u0+-0.3112300869435447*x0*u0 | Treatment 3: x_dot = +-6.063138085050031*1+-2.928782474824149*x0+-1.3800762356445897*u0+-0.05616988801502409*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 13.589255548999063, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:26:13,652,652 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'crn', 10, 2.0)
MainProcess| 2023-05-15 19:26:13,655,655 multiprocessing INFO Running EQ_5_C crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:26:13,708,708 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:31:03,936,936 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.5109473475632833, 'encoder_val_rmse_orig': 0.5061837910878614, 'encoder_test_rmse_all': 0.8306278857612093, 'encoder_test_rmse_orig': 0.6367256536252485, 'encoder_test_rmse_last': 0.8078077307811513, 'decoder_val_rmse_all': 0.3155563941087586, 'decoder_val_rmse_orig': 0.3155563941087588, 'decoder_test_rmse_2-step': 0.5787609698193433, 'decoder_test_rmse_3-step': 0.6880726864803535, 'decoder_test_rmse_4-step': 0.782597514668432, 'decoder_test_rmse_5-step': 0.8701808187900759, 'decoder_test_rmse_6-step': 0.9372483974827315, 'method': 'crn', 'seed': 10, 'seconds_taken': 290.2810954019951, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:31:03,936,936 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'msm', 10, 2.0)
MainProcess| 2023-05-15 19:31:03,939,939 multiprocessing INFO Running EQ_5_C msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:31:03,987,987 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:31:15,606,606 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.6173862181070924, 'encoder_test_rmse_orig': 1.2322784307059405, 'encoder_test_rmse_last': 1.050427466566702, 'decoder_test_rmse_2-step': 1.7938483786915003, 'decoder_test_rmse_3-step': 2.232431489325454, 'decoder_test_rmse_4-step': 2.4700974596924077, 'decoder_test_rmse_5-step': 2.6143452351044214, 'decoder_test_rmse_6-step': 2.6869375635667705, 'method': 'msm', 'seed': 10, 'seconds_taken': 11.667217510999762, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:31:15,607,607 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 19:31:15,610,610 multiprocessing INFO Running EQ_5_C gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:31:15,657,657 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:36:10,236,236 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4921490526628175, 'encoder_val_rmse_orig': 0.48720837708126086, 'encoder_test_rmse_all': 0.8645903545949639, 'encoder_test_rmse_orig': 0.6481150283636111, 'encoder_test_rmse_last': 0.7513292260098017, 'decoder_val_rmse_all': 0.4921490526628175, 'decoder_val_rmse_orig': 0.48720837708126086, 'decoder_test_rmse_2-step': 0.7120656327555542, 'decoder_test_rmse_3-step': 0.9370746570518779, 'decoder_test_rmse_4-step': 1.0800720066719185, 'decoder_test_rmse_5-step': 1.2202855391481038, 'decoder_test_rmse_6-step': 1.3519672368937399, 'method': 'gnet', 'seed': 10, 'seconds_taken': 294.6264389720018, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:36:10,236,236 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'ct', 10, 2.0)
MainProcess| 2023-05-15 19:36:10,239,239 multiprocessing INFO Running EQ_5_C ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:36:10,290,290 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:37:00,152,152 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.44807816010868856, 'encoder_val_rmse_orig': 0.4440871607714631, 'encoder_test_rmse_all': 0.8100621521367618, 'encoder_test_rmse_orig': 0.6305237978177384, 'encoder_test_rmse_last': 0.7191616708626013, 'decoder_val_rmse_all': 0.44807816010868856, 'decoder_val_rmse_orig': 0.4440871607714631, 'decoder_test_rmse_2-step': 0.6602819035662286, 'decoder_test_rmse_3-step': 0.7903664475025228, 'decoder_test_rmse_4-step': 0.8777165239353649, 'decoder_test_rmse_5-step': 0.9506023310355358, 'decoder_test_rmse_6-step': 0.9788828233933755, 'method': 'ct', 'seed': 10, 'seconds_taken': 49.913021555010346, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:37:00,152,152 multiprocessing INFO [Now evaluating exp] ('EQ_5_C', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 19:37:00,155,155 multiprocessing INFO Running EQ_5_C rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:37:00,207,207 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_C', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:41:25,244,244 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7679657755691974, 'propensity_treatment_val_bce_orig': 0.7679736193740074, 'propensity_treatment_test_bce_all': 0.7691706392203437, 'propensity_treatment_test_bce_orig': 0.7672845575998792, 'propensity_history_val_bce_all': 0.7633165725334519, 'propensity_history_val_bce_orig': 0.7633576690146845, 'propensity_history_test_bce_all': 0.7707217548715948, 'propensity_history_test_bce_orig': 0.7679992300052447, 'encoder_val_rmse_all': 0.5875950853860076, 'encoder_val_rmse_orig': 0.5819444951972119, 'encoder_test_rmse_all': 1.0706083748861919, 'encoder_test_rmse_orig': 0.8088885971768224, 'encoder_test_rmse_last': 0.8527507658833363, 'decoder_val_rmse_all': 0.3370870884670614, 'decoder_val_rmse_orig': 0.3370870884670617, 'decoder_test_rmse_2-step': 0.622044971104764, 'decoder_test_rmse_3-step': 0.720906110813673, 'decoder_test_rmse_4-step': 0.9013515770645129, 'decoder_test_rmse_5-step': 1.0990937731054706, 'decoder_test_rmse_6-step': 1.2735306644767412, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 265.0887421399966, 'errored': False, 'dataset_name': 'EQ_5_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:43:26,991,991 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 19:43:26,994,994 multiprocessing INFO Running EQ_5_D sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:43:27,044,44 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_5_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:43:40,554,554 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.7010540574229824, 'encoder_test_rmse_orig': 2.1444588916481853, 'encoder_test_rmse_last': 2.0643265056344067, 'decoder_test_rmse_2-step': 1.1067742056441998, 'decoder_test_rmse_3-step': 1.1091506587760405, 'decoder_test_rmse_4-step': 1.1201368099053735, 'decoder_test_rmse_5-step': 1.1356422462090365, 'decoder_test_rmse_6-step': 1.1522022629525088, 'global_equation_string': 'Treatment 0: x_dot = +-0.23004828260277535*1+0.03832152575483535*x0+0.017215865410929256*u0+0.01713058785771064*x0*u0 | Treatment 1: x_dot = +1.5029373031926216*1+-1.6310866506211164*x0+-0.8415513317030396*u0+0.24802487606528437*x0*u0 | Treatment 2: x_dot = +0.4101397087213633*1+-2.0858065707246776*x0+-0.8565320470534028*u0+-0.17808441194224606*x0*u0 | Treatment 3: x_dot = +-8.9588806447565*1+-2.4835585073835786*x0+-0.8210122519628554*u0+-0.2132582474397979*x0*u0', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 13.560153351005283, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:43:40,555,555 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'crn', 10, 2.0)
MainProcess| 2023-05-15 19:43:40,557,557 multiprocessing INFO Running EQ_5_D crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:43:40,609,609 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:48:32,074,74 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.4508903733053538, 'encoder_val_rmse_orig': 0.4465783625889815, 'encoder_test_rmse_all': 0.7784174829466742, 'encoder_test_rmse_orig': 0.5906991868797421, 'encoder_test_rmse_last': 0.6512605434825582, 'decoder_val_rmse_all': 0.2610340163528015, 'decoder_val_rmse_orig': 0.2610340163528018, 'decoder_test_rmse_2-step': 0.4779805528618024, 'decoder_test_rmse_3-step': 0.5181379727224851, 'decoder_test_rmse_4-step': 0.5588779202159623, 'decoder_test_rmse_5-step': 0.6022201425732868, 'decoder_test_rmse_6-step': 0.6423889831411359, 'method': 'crn', 'seed': 10, 'seconds_taken': 291.51658291200874, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:48:32,074,74 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'msm', 10, 2.0)
MainProcess| 2023-05-15 19:48:32,077,77 multiprocessing INFO Running EQ_5_D msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:48:32,125,125 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:48:43,732,732 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 1.4923800624706225, 'encoder_test_rmse_orig': 1.1208129585531115, 'encoder_test_rmse_last': 1.0052343934772174, 'decoder_test_rmse_2-step': 1.3559017471754828, 'decoder_test_rmse_3-step': 1.6678324829606357, 'decoder_test_rmse_4-step': 1.8256828343867801, 'decoder_test_rmse_5-step': 1.928463726828673, 'decoder_test_rmse_6-step': 1.962227861155989, 'method': 'msm', 'seed': 10, 'seconds_taken': 11.655054157003178, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:48:43,732,732 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 19:48:43,736,736 multiprocessing INFO Running EQ_5_D gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:48:43,787,787 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:53:35,187,187 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3888822585426696, 'encoder_val_rmse_orig': 0.3850787785888243, 'encoder_test_rmse_all': 0.7494257074516749, 'encoder_test_rmse_orig': 0.554003774353892, 'encoder_test_rmse_last': 0.5584062176961206, 'decoder_val_rmse_all': 0.3888822585426696, 'decoder_val_rmse_orig': 0.3850787785888243, 'decoder_test_rmse_2-step': 0.6708616761280537, 'decoder_test_rmse_3-step': 0.8616314037447085, 'decoder_test_rmse_4-step': 0.9117263363120007, 'decoder_test_rmse_5-step': 0.9372857643020467, 'decoder_test_rmse_6-step': 0.9557364193769226, 'method': 'gnet', 'seed': 10, 'seconds_taken': 291.45003155501036, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:53:35,187,187 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'ct', 10, 2.0)
MainProcess| 2023-05-15 19:53:35,190,190 multiprocessing INFO Running EQ_5_D ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:53:35,241,241 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:54:24,877,877 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3949942570537321, 'encoder_val_rmse_orig': 0.3914756490033649, 'encoder_test_rmse_all': 0.7014141681736994, 'encoder_test_rmse_orig': 0.5499873295716985, 'encoder_test_rmse_last': 0.572475227059336, 'decoder_val_rmse_all': 0.3949942570537321, 'decoder_val_rmse_orig': 0.3914756490033649, 'decoder_test_rmse_2-step': 0.4671383973591843, 'decoder_test_rmse_3-step': 0.5573754335964868, 'decoder_test_rmse_4-step': 0.6448274718782728, 'decoder_test_rmse_5-step': 0.7425623628915851, 'decoder_test_rmse_6-step': 0.783906151530609, 'method': 'ct', 'seed': 10, 'seconds_taken': 49.687684757009265, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 19:54:24,878,878 multiprocessing INFO [Now evaluating exp] ('EQ_5_D', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 19:54:24,880,880 multiprocessing INFO Running EQ_5_D rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 19:54:24,935,935 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticContinuousDatasetCollection', 'name': 'continuous_generator', 'equation_str': 'EQ_5_D', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 19:58:49,457,457 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.7669244216973238, 'propensity_treatment_val_bce_orig': 0.7669103906800981, 'propensity_treatment_test_bce_all': 0.7685177116969865, 'propensity_treatment_test_bce_orig': 0.76702969806727, 'propensity_history_val_bce_all': 0.760786292064683, 'propensity_history_val_bce_orig': 0.760808887271572, 'propensity_history_test_bce_all': 0.7688395806217516, 'propensity_history_test_bce_orig': 0.7661193715336054, 'encoder_val_rmse_all': 0.5419184351524593, 'encoder_val_rmse_orig': 0.5368489602539868, 'encoder_test_rmse_all': 0.953137388552128, 'encoder_test_rmse_orig': 0.7148628125400868, 'encoder_test_rmse_last': 0.7360268599747102, 'decoder_val_rmse_all': 0.25597106507065354, 'decoder_val_rmse_orig': 0.2559710650706534, 'decoder_test_rmse_2-step': 0.5060012076795489, 'decoder_test_rmse_3-step': 0.5561778279696745, 'decoder_test_rmse_4-step': 0.5998210010486018, 'decoder_test_rmse_5-step': 0.6435517503447661, 'decoder_test_rmse_6-step': 0.6883957131827555, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 264.57689768099226, 'errored': False, 'dataset_name': 'EQ_5_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:00:16,582,582 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 20:00:16,586,586 multiprocessing INFO Running EQ_4_A sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:00:16,638,638 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:00:20,234,234 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13200332413673002, 'encoder_test_rmse_orig': 0.11165000026478643, 'encoder_test_rmse_last': 0.1116538105062243, 'decoder_test_rmse_2-step': 0.11156786334781689, 'decoder_test_rmse_3-step': 0.11121076367870666, 'decoder_test_rmse_4-step': 0.11050209997804812, 'decoder_test_rmse_5-step': 0.10941543989210444, 'decoder_test_rmse_6-step': 0.10795641190424674, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084258601191902*x0*u0 | Treatment 1: x_dot = +-1.0084219422393685*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 3.648395102994982, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:00:20,235,235 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'wsindy', 10, 2.0)
MainProcess| 2023-05-15 20:00:20,237,237 multiprocessing INFO Running EQ_4_A wsindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:00:20,289,289 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_A', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:00:25,695,695 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13171402686692754, 'encoder_test_rmse_orig': 0.11140533805765629, 'encoder_test_rmse_last': 0.11140806198580679, 'decoder_test_rmse_2-step': 0.11132233062330578, 'decoder_test_rmse_3-step': 0.11096502968211867, 'decoder_test_rmse_4-step': 0.11025705520297253, 'decoder_test_rmse_5-step': 0.10917204205798771, 'decoder_test_rmse_6-step': 0.10771560446881559, 'global_equation_string': 'Treatment 0: x_dot = +-1.008402709342263*x0*u0 | Treatment 1: x_dot = +-1.00840612218166*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 10, 'seconds_taken': 5.457334319988149, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:00:25,695,695 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'crn', 10, 2.0)
MainProcess| 2023-05-15 20:00:25,697,697 multiprocessing INFO Running EQ_4_A crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:00:25,749,749 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:05:20,143,143 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.1931843962894597, 'encoder_val_rmse_orig': 1.1931843962894595, 'encoder_test_rmse_all': 0.9066950852130878, 'encoder_test_rmse_orig': 1.193449793234155, 'encoder_test_rmse_last': 1.220419705618054, 'decoder_val_rmse_all': 0.3313729775213724, 'decoder_val_rmse_orig': 0.33137297752137224, 'decoder_test_rmse_2-step': 0.7618283435798267, 'decoder_test_rmse_3-step': 0.7851564560132751, 'decoder_test_rmse_4-step': 0.8618539558188247, 'decoder_test_rmse_5-step': 0.9490274511160173, 'decoder_test_rmse_6-step': 1.0353188875925192, 'method': 'crn', 'seed': 10, 'seconds_taken': 294.44509658600145, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:05:20,143,143 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'msm', 10, 2.0)
MainProcess| 2023-05-15 20:05:20,146,146 multiprocessing INFO Running EQ_4_A msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:05:20,191,191 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:05:26,032,32 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7889042256376224, 'encoder_test_rmse_orig': 0.5625954575359708, 'encoder_test_rmse_last': 0.5842135341982103, 'decoder_test_rmse_2-step': 1.3109665596583584, 'decoder_test_rmse_3-step': 1.2099261071764371, 'decoder_test_rmse_4-step': 1.1236008875173709, 'decoder_test_rmse_5-step': 1.049594507190473, 'decoder_test_rmse_6-step': 0.9857963648373708, 'method': 'msm', 'seed': 10, 'seconds_taken': 5.886476304003736, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:05:26,032,32 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 20:05:26,035,35 multiprocessing INFO Running EQ_4_A gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:05:26,083,83 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:09:43,082,82 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3216849460962576, 'encoder_val_rmse_orig': 0.3216849460962575, 'encoder_test_rmse_all': 0.3791803756782113, 'encoder_test_rmse_orig': 0.32183374620405814, 'encoder_test_rmse_last': 0.3315499768049382, 'decoder_val_rmse_all': 0.3216849460962576, 'decoder_val_rmse_orig': 0.3216849460962575, 'decoder_test_rmse_2-step': 0.4781967175061514, 'decoder_test_rmse_3-step': 0.5710806549422802, 'decoder_test_rmse_4-step': 0.6432722011187217, 'decoder_test_rmse_5-step': 0.7014405197714257, 'decoder_test_rmse_6-step': 0.7466093618885135, 'method': 'gnet', 'seed': 10, 'seconds_taken': 257.0464077840006, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:09:43,082,82 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'ct', 10, 2.0)
MainProcess| 2023-05-15 20:09:43,085,85 multiprocessing INFO Running EQ_4_A ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:09:43,137,137 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:10:31,298,298 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.28011666587853745, 'encoder_val_rmse_orig': 0.2801166658785375, 'encoder_test_rmse_all': 0.3412451007529504, 'encoder_test_rmse_orig': 0.28247662628835357, 'encoder_test_rmse_last': 0.37612240356916193, 'decoder_val_rmse_all': 0.28011666587853745, 'decoder_val_rmse_orig': 0.2801166658785375, 'decoder_test_rmse_2-step': 0.4045223630994248, 'decoder_test_rmse_3-step': 0.4727818097080712, 'decoder_test_rmse_4-step': 0.5172306399464178, 'decoder_test_rmse_5-step': 0.5613499552259672, 'decoder_test_rmse_6-step': 0.5855718192365761, 'method': 'ct', 'seed': 10, 'seconds_taken': 48.21349617400847, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:10:31,299,299 multiprocessing INFO [Now evaluating exp] ('EQ_4_A', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 20:10:31,301,301 multiprocessing INFO Running EQ_4_A rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:10:31,353,353 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_A', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:15:04,526,526 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49460084156464723, 'propensity_treatment_val_bce_orig': 0.4946008415646472, 'propensity_treatment_test_bce_all': 0.5084506918819948, 'propensity_treatment_test_bce_orig': 0.5157008743844328, 'propensity_history_val_bce_all': 0.49205901617720976, 'propensity_history_val_bce_orig': 0.4920590161772098, 'propensity_history_test_bce_all': 0.504764601066035, 'propensity_history_test_bce_orig': 0.5133154870443516, 'encoder_val_rmse_all': 2.268291776593638, 'encoder_val_rmse_orig': 2.268291776593638, 'encoder_test_rmse_all': 3.147006768587226, 'encoder_test_rmse_orig': 2.2730212328881394, 'encoder_test_rmse_last': 2.3831692713186894, 'decoder_val_rmse_all': 0.19794651263075497, 'decoder_val_rmse_orig': 0.1979465126307549, 'decoder_test_rmse_2-step': 2.0000066704873896, 'decoder_test_rmse_3-step': 1.8362016160982362, 'decoder_test_rmse_4-step': 1.706111142283315, 'decoder_test_rmse_5-step': 1.5885831041989922, 'decoder_test_rmse_6-step': 1.486084360486614, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 273.2240161390073, 'errored': False, 'dataset_name': 'EQ_4_A', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:16:30,784,784 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 20:16:30,786,786 multiprocessing INFO Running EQ_4_B sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:16:30,837,837 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:16:34,446,446 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13378955783812846, 'encoder_test_rmse_orig': 0.11360975339067558, 'encoder_test_rmse_last': 0.113716955084815, 'decoder_test_rmse_2-step': 0.11354471118922811, 'decoder_test_rmse_3-step': 0.11327640250134106, 'decoder_test_rmse_4-step': 0.11264256416846202, 'decoder_test_rmse_5-step': 0.1113929516670458, 'decoder_test_rmse_6-step': 0.10997262521306646, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084723460573537*x0*u0 | Treatment 1: x_dot = +-1.0084023951543961*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 3.6593702969985316, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:16:34,446,446 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'wsindy', 10, 2.0)
MainProcess| 2023-05-15 20:16:34,449,449 multiprocessing INFO Running EQ_4_B wsindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:16:34,498,498 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_B', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:16:40,128,128 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.13418244756008613, 'encoder_test_rmse_orig': 0.11393825875594218, 'encoder_test_rmse_last': 0.11403136687489926, 'decoder_test_rmse_2-step': 0.11386008402000979, 'decoder_test_rmse_3-step': 0.11357932194381341, 'decoder_test_rmse_4-step': 0.11293303634752411, 'decoder_test_rmse_5-step': 0.11167109715938192, 'decoder_test_rmse_6-step': 0.11023846553562877, 'global_equation_string': 'Treatment 0: x_dot = +-1.0084417086409463*x0*u0 | Treatment 1: x_dot = +-1.0084615662427352*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 10, 'seconds_taken': 5.679001698998036, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:16:40,128,128 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'crn', 10, 2.0)
MainProcess| 2023-05-15 20:16:40,130,130 multiprocessing INFO Running EQ_4_B crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:16:40,179,179 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:21:39,748,748 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.359834331147184, 'encoder_val_rmse_orig': 1.359834331147184, 'encoder_test_rmse_all': 1.0092548988181402, 'encoder_test_rmse_orig': 1.3600688776493108, 'encoder_test_rmse_last': 1.3800560773107498, 'decoder_val_rmse_all': 0.32541501859618444, 'decoder_val_rmse_orig': 0.3254150185961843, 'decoder_test_rmse_2-step': 0.7920941667585243, 'decoder_test_rmse_3-step': 0.8207605626308246, 'decoder_test_rmse_4-step': 0.8900395071915547, 'decoder_test_rmse_5-step': 0.9682610325046833, 'decoder_test_rmse_6-step': 1.0463303246941804, 'method': 'crn', 'seed': 10, 'seconds_taken': 299.61713285600126, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:21:39,748,748 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'msm', 10, 2.0)
MainProcess| 2023-05-15 20:21:39,750,750 multiprocessing INFO Running EQ_4_B msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:21:39,797,797 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:21:45,428,428 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7895629725136167, 'encoder_test_rmse_orig': 0.5639155454464421, 'encoder_test_rmse_last': 0.5844423333289338, 'decoder_test_rmse_2-step': 1.3113665617612245, 'decoder_test_rmse_3-step': 1.210731279134207, 'decoder_test_rmse_4-step': 1.1249003349373081, 'decoder_test_rmse_5-step': 1.0512274538402642, 'decoder_test_rmse_6-step': 0.9879050263916438, 'method': 'msm', 'seed': 10, 'seconds_taken': 5.677245040991693, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:21:45,428,428 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 20:21:45,431,431 multiprocessing INFO Running EQ_4_B gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:21:45,480,480 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:26:08,006,6 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3224675391273474, 'encoder_val_rmse_orig': 0.3224675391273474, 'encoder_test_rmse_all': 0.3797483101254873, 'encoder_test_rmse_orig': 0.3225758792858772, 'encoder_test_rmse_last': 0.3322343415155567, 'decoder_val_rmse_all': 0.3224675391273474, 'decoder_val_rmse_orig': 0.3224675391273474, 'decoder_test_rmse_2-step': 0.4788437213742708, 'decoder_test_rmse_3-step': 0.5715075229369447, 'decoder_test_rmse_4-step': 0.6434048849632327, 'decoder_test_rmse_5-step': 0.7018120190213726, 'decoder_test_rmse_6-step': 0.7469325956057759, 'method': 'gnet', 'seed': 10, 'seconds_taken': 262.575236492994, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:26:08,006,6 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'ct', 10, 2.0)
MainProcess| 2023-05-15 20:26:08,009,9 multiprocessing INFO Running EQ_4_B ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:26:08,057,57 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:26:56,819,819 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.2814008767982572, 'encoder_val_rmse_orig': 0.2814008767982572, 'encoder_test_rmse_all': 0.34294909558280356, 'encoder_test_rmse_orig': 0.28377888584597816, 'encoder_test_rmse_last': 0.37694430528295975, 'decoder_val_rmse_all': 0.2814008767982572, 'decoder_val_rmse_orig': 0.2814008767982572, 'decoder_test_rmse_2-step': 0.40525704713333677, 'decoder_test_rmse_3-step': 0.4741523399477603, 'decoder_test_rmse_4-step': 0.5187378874385857, 'decoder_test_rmse_5-step': 0.5627067015550389, 'decoder_test_rmse_6-step': 0.5869426354080873, 'method': 'ct', 'seed': 10, 'seconds_taken': 48.8102843240049, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:26:56,819,819 multiprocessing INFO [Now evaluating exp] ('EQ_4_B', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 20:26:56,822,822 multiprocessing INFO Running EQ_4_B rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:26:56,876,876 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_B', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:31:31,950,950 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49460084156464723, 'propensity_treatment_val_bce_orig': 0.4946008415646472, 'propensity_treatment_test_bce_all': 0.5084506918819948, 'propensity_treatment_test_bce_orig': 0.5157008743844328, 'propensity_history_val_bce_all': 0.4920237379255941, 'propensity_history_val_bce_orig': 0.4920237379255942, 'propensity_history_test_bce_all': 0.5046991974693739, 'propensity_history_test_bce_orig': 0.5132810942547744, 'encoder_val_rmse_all': 2.3320735068983294, 'encoder_val_rmse_orig': 2.33207350689833, 'encoder_test_rmse_all': 3.2367432701123113, 'encoder_test_rmse_orig': 2.3367735642149303, 'encoder_test_rmse_last': 2.4482801929512985, 'decoder_val_rmse_all': 0.20974468213680683, 'decoder_val_rmse_orig': 0.2097446821368068, 'decoder_test_rmse_2-step': 2.047036622070875, 'decoder_test_rmse_3-step': 1.8887515295761845, 'decoder_test_rmse_4-step': 1.7544691909430452, 'decoder_test_rmse_5-step': 1.6323858676951728, 'decoder_test_rmse_6-step': 1.5257260295040156, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 275.1273599599954, 'errored': False, 'dataset_name': 'EQ_4_B', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:32:59,549,549 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 20:32:59,552,552 multiprocessing INFO Running EQ_4_C sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:32:59,604,604 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:33:03,349,349 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1672240022816418, 'encoder_test_rmse_orig': 0.13617085111808308, 'encoder_test_rmse_last': 0.13541149547134768, 'decoder_test_rmse_2-step': 0.1351167712618842, 'decoder_test_rmse_3-step': 0.13378877015714477, 'decoder_test_rmse_4-step': 0.13213495105942435, 'decoder_test_rmse_5-step': 0.129626177173557, 'decoder_test_rmse_6-step': 0.1268006524800974, 'global_equation_string': 'Treatment 0: x_dot = +-1.1107592869834308*x0*u0 | Treatment 1: x_dot = +-0.14540553723951796*x0+-1.0234639833519243*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 3.7967737419967307, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:33:03,349,349 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'wsindy', 10, 2.0)
MainProcess| 2023-05-15 20:33:03,351,351 multiprocessing INFO Running EQ_4_C wsindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:33:03,402,402 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_C', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:33:09,027,27 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.15319179926640705, 'encoder_test_rmse_orig': 0.12491370555520828, 'encoder_test_rmse_last': 0.1249300239505199, 'decoder_test_rmse_2-step': 0.124640150584778, 'decoder_test_rmse_3-step': 0.12397090660995402, 'decoder_test_rmse_4-step': 0.12271597073456246, 'decoder_test_rmse_5-step': 0.12059712492643558, 'decoder_test_rmse_6-step': 0.11815741281298078, 'global_equation_string': 'Treatment 0: x_dot = +-0.04564381470412596*x0+-1.019033395921092*x0*u0 | Treatment 1: x_dot = +-0.14620573070330864*x0+-1.0220469871566278*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 10, 'seconds_taken': 5.675582194991875, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:33:09,027,27 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'crn', 10, 2.0)
MainProcess| 2023-05-15 20:33:09,030,30 multiprocessing INFO Running EQ_4_C crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:33:09,075,75 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:38:09,950,950 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.2294482158662765, 'encoder_val_rmse_orig': 1.2294482158662765, 'encoder_test_rmse_all': 0.9335316741223959, 'encoder_test_rmse_orig': 1.230118508433034, 'encoder_test_rmse_last': 1.2401040148825135, 'decoder_val_rmse_all': 0.28884822172489494, 'decoder_val_rmse_orig': 0.2888482217248949, 'decoder_test_rmse_2-step': 0.42782031686146677, 'decoder_test_rmse_3-step': 0.4575308308463861, 'decoder_test_rmse_4-step': 0.5478747403240474, 'decoder_test_rmse_5-step': 0.6532839081055513, 'decoder_test_rmse_6-step': 0.75388805845106, 'method': 'crn', 'seed': 10, 'seconds_taken': 300.9197375000076, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:38:09,950,950 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'msm', 10, 2.0)
MainProcess| 2023-05-15 20:38:09,953,953 multiprocessing INFO Running EQ_4_C msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:38:09,999,999 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:38:15,567,567 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.9423960169018466, 'encoder_test_rmse_orig': 0.6727435229483882, 'encoder_test_rmse_last': 0.6902901129521176, 'decoder_test_rmse_2-step': 1.4148992117964447, 'decoder_test_rmse_3-step': 1.2708584813003785, 'decoder_test_rmse_4-step': 1.1177521946716376, 'decoder_test_rmse_5-step': 1.0125941205488038, 'decoder_test_rmse_6-step': 0.9687008176811571, 'method': 'msm', 'seed': 10, 'seconds_taken': 5.614574974999414, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:38:15,568,568 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 20:38:15,570,570 multiprocessing INFO Running EQ_4_C gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:38:15,620,620 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:42:37,644,644 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.25655645308094605, 'encoder_val_rmse_orig': 0.25655645308094605, 'encoder_test_rmse_all': 0.3130124777568197, 'encoder_test_rmse_orig': 0.2566666127608421, 'encoder_test_rmse_last': 0.2671253880262602, 'decoder_val_rmse_all': 0.25655645308094605, 'decoder_val_rmse_orig': 0.25655645308094605, 'decoder_test_rmse_2-step': 0.38404176325039685, 'decoder_test_rmse_3-step': 0.4470446899775973, 'decoder_test_rmse_4-step': 0.491828138341362, 'decoder_test_rmse_5-step': 0.5257673444918962, 'decoder_test_rmse_6-step': 0.5497532763234941, 'method': 'gnet', 'seed': 10, 'seconds_taken': 262.0738801300031, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:42:37,645,645 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'ct', 10, 2.0)
MainProcess| 2023-05-15 20:42:37,647,647 multiprocessing INFO Running EQ_4_C ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:42:37,699,699 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:43:26,367,367 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.271112034523507, 'encoder_val_rmse_orig': 0.271112034523507, 'encoder_test_rmse_all': 0.34257640760132896, 'encoder_test_rmse_orig': 0.272727030426604, 'encoder_test_rmse_last': 0.33010064182185517, 'decoder_val_rmse_all': 0.271112034523507, 'decoder_val_rmse_orig': 0.271112034523507, 'decoder_test_rmse_2-step': 0.3528851134801429, 'decoder_test_rmse_3-step': 0.3813291957085085, 'decoder_test_rmse_4-step': 0.4081950967999533, 'decoder_test_rmse_5-step': 0.43374270095802336, 'decoder_test_rmse_6-step': 0.4429964926614855, 'method': 'ct', 'seed': 10, 'seconds_taken': 48.71932946800371, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:43:26,367,367 multiprocessing INFO [Now evaluating exp] ('EQ_4_C', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 20:43:26,370,370 multiprocessing INFO Running EQ_4_C rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:43:26,426,426 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_C', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:48:01,462,462 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.49460084156464723, 'propensity_treatment_val_bce_orig': 0.4946008415646472, 'propensity_treatment_test_bce_all': 0.5084506918819948, 'propensity_treatment_test_bce_orig': 0.5157008743844328, 'propensity_history_val_bce_all': 0.49213916896763493, 'propensity_history_val_bce_orig': 0.49213916896763493, 'propensity_history_test_bce_all': 0.5049183385124651, 'propensity_history_test_bce_orig': 0.5133939532734265, 'encoder_val_rmse_all': 2.2974579405890956, 'encoder_val_rmse_orig': 2.297457940589096, 'encoder_test_rmse_all': 3.197152743789431, 'encoder_test_rmse_orig': 2.3022744610338033, 'encoder_test_rmse_last': 2.42035936545669, 'decoder_val_rmse_all': 0.20021434452146392, 'decoder_val_rmse_orig': 0.20021434452146392, 'decoder_test_rmse_2-step': 2.00873918908259, 'decoder_test_rmse_3-step': 1.8147859223863356, 'decoder_test_rmse_4-step': 1.6592621765849171, 'decoder_test_rmse_5-step': 1.5247527611740097, 'decoder_test_rmse_6-step': 1.4126225800715722, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 275.0927887590078, 'errored': False, 'dataset_name': 'EQ_4_C', 'method_name': 'rmsn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:49:31,592,592 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'sindy', 10, 2.0)
MainProcess| 2023-05-15 20:49:31,595,595 multiprocessing INFO Running EQ_4_D sindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:49:31,644,644 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:49:35,074,74 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.1957376769296075, 'encoder_test_rmse_orig': 0.16033534022158547, 'encoder_test_rmse_last': 0.1582962091892089, 'decoder_test_rmse_2-step': 0.15810020306491654, 'decoder_test_rmse_3-step': 0.15592187788039688, 'decoder_test_rmse_4-step': 0.15362249645734852, 'decoder_test_rmse_5-step': 0.15118539620469687, 'decoder_test_rmse_6-step': 0.14825812746463357, 'global_equation_string': 'Treatment 0: x_dot = +0.19768737972045228*x0+-1.009452783649069*x0*u0 | Treatment 1: x_dot = +-1.2013982255230478*x0*u1', 'fine_tuned': False, 'method': 'sindy', 'seed': 10, 'seconds_taken': 3.4789844850020017, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:49:35,074,74 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'wsindy', 10, 2.0)
MainProcess| 2023-05-15 20:49:35,077,77 multiprocessing INFO Running EQ_4_D wsindy 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:49:35,128,128 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'WSINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 500.0, 'sindy_threshold': 0.1, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': False, 'insite': False, 'wsindy': True, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'resources_per_trial': None, 'dataset_name': 'EQ_4_D', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multiclass', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:49:40,494,494 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.12044063295374102, 'encoder_test_rmse_orig': 0.10229807613650063, 'encoder_test_rmse_last': 0.10275675766843276, 'decoder_test_rmse_2-step': 0.10284543819029976, 'decoder_test_rmse_3-step': 0.10317676334532527, 'decoder_test_rmse_4-step': 0.10319185597039449, 'decoder_test_rmse_5-step': 0.10290052186466307, 'decoder_test_rmse_6-step': 0.1020685365856194, 'global_equation_string': 'Treatment 0: x_dot = +0.19814848694427412*x0+-1.0103919985411562*x0*u0 | Treatment 1: x_dot = +-0.09114550391014063*x0+-1.019770513620763*x0*u1', 'fine_tuned': False, 'method': 'wsindy', 'seed': 10, 'seconds_taken': 5.417129358000238, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'wsindy', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:49:40,495,495 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'crn', 10, 2.0)
MainProcess| 2023-05-15 20:49:40,497,497 multiprocessing INFO Running EQ_4_D crn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:49:40,550,550 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CRN', 'encoder': {'_target_': 'src.models.crn.CRNEncoder', 'seq_hidden_units': 24, 'br_size': 6, 'fc_hidden_units': 18, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 64, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.crn.CRNDecoder', 'seq_hidden_units': None, 'br_size': 3, 'fc_hidden_units': 9, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 512, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 30, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:54:41,704,704 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 1.0121831407792896, 'encoder_val_rmse_orig': 1.0121831407792896, 'encoder_test_rmse_all': 0.8494921594703161, 'encoder_test_rmse_orig': 1.0329781449250708, 'encoder_test_rmse_last': 1.2420254384242873, 'decoder_val_rmse_all': 0.38384242857794754, 'decoder_val_rmse_orig': 0.38384242857794754, 'decoder_test_rmse_2-step': 1.9357484726419454, 'decoder_test_rmse_3-step': 1.8293384387937852, 'decoder_test_rmse_4-step': 1.8033713822254809, 'decoder_test_rmse_5-step': 1.818622405567675, 'decoder_test_rmse_6-step': 1.858228406230783, 'method': 'crn', 'seed': 10, 'seconds_taken': 301.20635749700887, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'crn', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:54:41,704,704 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'msm', 10, 2.0)
MainProcess| 2023-05-15 20:54:41,706,706 multiprocessing INFO Running EQ_4_D msm 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:54:41,754,754 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'MSM', 'lag_features': 1, 'propensity_treatment': {'_target_': 'src.models.msm.MSMPropensityTreatment'}, 'propensity_history': {'_target_': 'src.models.msm.MSMPropensityHistory'}, 'msm_regressor': {'_target_': 'src.models.msm.MSMRegressor'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:54:47,328,328 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 0.7276715080675642, 'encoder_test_rmse_orig': 0.5212870143535687, 'encoder_test_rmse_last': 0.7596116110110187, 'decoder_test_rmse_2-step': 1.3365078278232765, 'decoder_test_rmse_3-step': 1.479160472653518, 'decoder_test_rmse_4-step': 1.6792228081975151, 'decoder_test_rmse_5-step': 1.8908060101759054, 'decoder_test_rmse_6-step': 2.0939821163890673, 'method': 'msm', 'seed': 10, 'seconds_taken': 5.621613932002219, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'msm', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:54:47,328,328 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'gnet', 10, 2.0)
MainProcess| 2023-05-15 20:54:47,331,331 multiprocessing INFO Running EQ_4_D gnet 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:54:47,378,378 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'G-Net', 'g_net': {'_target_': 'src.models.gnet.GNet', 'seq_hidden_units': 24, 'num_layer': 1, 'r_size': 3, 'fc_hidden_units': 48, 'num_comp': 1, 'mc_samples': 25, 'fit_vitals': True, 'comp_sizes': None, 'batch_size': 128, 'dropout_rate': 0.1, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', 'holdout_ratio': 0.1, '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:59:09,334,334 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3842225445142924, 'encoder_val_rmse_orig': 0.38422254451429244, 'encoder_test_rmse_all': 0.4112804659438871, 'encoder_test_rmse_orig': 0.38535984977164606, 'encoder_test_rmse_last': 0.4037659259407945, 'decoder_val_rmse_all': 0.3842225445142924, 'decoder_val_rmse_orig': 0.38422254451429244, 'decoder_test_rmse_2-step': 0.47951359447661634, 'decoder_test_rmse_3-step': 0.5427937172805745, 'decoder_test_rmse_4-step': 0.5879001496413477, 'decoder_test_rmse_5-step': 0.6277639192152271, 'decoder_test_rmse_6-step': 0.6613136696142781, 'method': 'gnet', 'seed': 10, 'seconds_taken': 262.0027515979891, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'gnet', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:59:09,334,334 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'ct', 10, 2.0)
MainProcess| 2023-05-15 20:59:09,337,337 multiprocessing INFO Running EQ_4_D ct 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:59:09,389,389 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'CT', 'multi': {'_target_': 'src.models.ct.CT', 'max_seq_length': '${sum:${dataset.max_seq_length},${dataset.projection_horizon}}', 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1, 'num_layer': 1, 'num_heads': 2, 'max_grad_norm': None, 'batch_size': 256, 'attn_dropout': True, 'disable_cross_attention': False, 'isolate_subnetwork': '_', 'self_positional_encoding': {'absolute': False, 'trainable': True, 'max_relative_position': 15}, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'augment_with_masked_vitals': True, 'tune_hparams': False, 'tune_range': 50, 'hparams_grid': None, 'resources_per_trial': None}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': True, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 20:59:57,921,921 multiprocessing INFO [Exp evaluation complete] {'encoder_val_rmse_all': 0.3409139291454322, 'encoder_val_rmse_orig': 0.34091392914543217, 'encoder_test_rmse_all': 0.4295210662938381, 'encoder_test_rmse_orig': 0.3696230838929803, 'encoder_test_rmse_last': 0.6316362918678807, 'decoder_val_rmse_all': 0.3409139291454322, 'decoder_val_rmse_orig': 0.34091392914543217, 'decoder_test_rmse_2-step': 0.6608911241292739, 'decoder_test_rmse_3-step': 0.7027406984877648, 'decoder_test_rmse_4-step': 0.7045981950363022, 'decoder_test_rmse_5-step': 0.7126162007946022, 'decoder_test_rmse_6-step': 0.7136916730329075, 'method': 'ct', 'seed': 10, 'seconds_taken': 48.58365409199905, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'ct', 'domain_conf': 2.0}
MainProcess| 2023-05-15 20:59:57,921,921 multiprocessing INFO [Now evaluating exp] ('EQ_4_D', 'rmsn', 10, 2.0)
MainProcess| 2023-05-15 20:59:57,923,923 multiprocessing INFO Running EQ_4_D rmsn 10 | domain_conf=2.0
MainProcess| 2023-05-15 20:59:57,977,977 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 2, 'dim_vitals': 0, 'dim_static_features': 2, 'dim_outcomes': 1, 'name': 'RMSN', 'propensity_treatment': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkTreatment', 'seq_hidden_units': 8, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'propensity_history': {'_target_': 'src.models.rmsn.RMSNPropensityNetworkHistory', 'seq_hidden_units': 16, 'dropout_rate': 0.3, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.01, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'encoder': {'_target_': 'src.models.rmsn.RMSNEncoder', 'seq_hidden_units': 12, 'dropout_rate': 0.1, 'num_layer': 1, 'batch_size': 64, 'max_grad_norm': 2.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 50, 'resources_per_trial': None, 'hparams_grid': None}, 'train_decoder': True, 'decoder': {'_target_': 'src.models.rmsn.RMSNDecoder', 'seq_hidden_units': 64, 'dropout_rate': 0.2, 'num_layer': 1, 'batch_size': 256, 'max_grad_norm': 1.0, 'optimizer': {'optimizer_cls': 'adam', 'learning_rate': 0.001, 'weight_decay': 0.0, 'lr_scheduler': False}, 'tune_hparams': False, 'tune_range': 20, 'resources_per_trial': None}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticPkpdDatasetCollection', 'name': 'pkpd_generator', 'equation_str': 'EQ_4_D', 'coeff': 2, 'conf_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 10, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 1.0, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': None, 'bce_weight': False, 'weights_ema': None, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-15 21:04:36,094,94 multiprocessing INFO [Exp evaluation complete] {'propensity_treatment_val_bce_all': 0.5021658545833523, 'propensity_treatment_val_bce_orig': 0.5021658545833522, 'propensity_treatment_test_bce_all': 0.5156751014458931, 'propensity_treatment_test_bce_orig': 0.5224794972411468, 'propensity_history_val_bce_all': 0.49978322188227864, 'propensity_history_val_bce_orig': 0.49978322188227864, 'propensity_history_test_bce_all': 0.5122720501857289, 'propensity_history_test_bce_orig': 0.5202468307974016, 'encoder_val_rmse_all': 2.181454316252546, 'encoder_val_rmse_orig': 2.1814543162525464, 'encoder_test_rmse_all': 3.0065686563205354, 'encoder_test_rmse_orig': 2.1892363650012094, 'encoder_test_rmse_last': 2.307073382668698, 'decoder_val_rmse_all': 0.30270999987601616, 'decoder_val_rmse_orig': 0.3027099998760163, 'decoder_test_rmse_2-step': 1.950574952621689, 'decoder_test_rmse_3-step': 1.7877912725304979, 'decoder_test_rmse_4-step': 1.7118495608680788, 'decoder_test_rmse_5-step': 1.6758339348168523, 'decoder_test_rmse_6-step': 1.6682419686713805, 'method': 'rmsn', 'seed': 10, 'seconds_taken': 278.17072879600164, 'errored': False, 'dataset_name': 'EQ_4_D', 'method_name': 'rmsn', 'domain_conf': 2.0}
