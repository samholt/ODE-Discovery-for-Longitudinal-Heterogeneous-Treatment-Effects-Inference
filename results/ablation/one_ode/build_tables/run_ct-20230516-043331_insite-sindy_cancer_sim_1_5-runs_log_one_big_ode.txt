MainProcess| 2023-05-16 04:33:31,385,385 multiprocessing INFO Starting run 	 | See log at : logs/run_ct-20230516-043331_insite-sindy_cancer_sim_1_5-runs_log.txt
MainProcess| 2023-05-16 04:33:31,385,385 multiprocessing INFO [Main Config] {'run': {'epochs': 100, 'log_path': 'logs/run_ct-20230516-043331_insite-sindy_cancer_sim_1_5-runs_log.txt', 'device': 'cuda:0', 'window': 50, 'train_samples': 1000, 'val_samples': 100, 'test_samples': 100, 'obs_noise': 0.01, 'bsv_noise': 0.01, 'domain_conf': 2.0, 'step_actions': 5, 'batch_size': 32, 'normalize_data': True, 'clip_grad_norm': 1.0, 'clip_grad_norm_on': True}, 'sindy': {'sindy_alpha': 0.5, 'dataset_params': {'sindy_threshold': {'cancer_sim': 0.001, 'EQ_5': 0.001, 'EQ_4': 0.1}, 'lam': {'cancer_sim': 10.0, 'EQ_5': 10.0, 'EQ_4': 10.0}}}, 'tecde': {'learning_rate': 0.01, 'hidden_channels_x': 8, 'hidden_units': 128, 'mcd': True, 'early_stopping': {'patience': 5, 'delta': 0.0001}}, 'gnet': {'mcsamples': 25}, 'setup': {'debug_mode': False, 'flush_mode': False, 'multi_process_results': False, 'multi_process_cores': 1, 'experiment': 'ABLATION_ONE_ODE', 'ct_methods_to_evaluate': ['insite', 'sindy'], 'ct_datasets_to_evaluate': ['cancer_sim'], 'domain_confs': [0, 1, 2, 3, 4], 'wandb': {'project': 'CausalODEs', 'track': False}, 'log_dir': 'logs', 'torch_deterministic': True, 'seed_start': 1, 'seed_runs': 5, 'normalize_obs': True, 'cuda': True, 'load_from_cache': True, 'force_recache': False, 'treatment_mode': 'multilabel'}}
MainProcess| 2023-05-16 04:33:31,386,386 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'insite', 1, 2.0)
MainProcess| 2023-05-16 04:33:31,388,388 multiprocessing INFO Running cancer_sim insite 1 | domain_conf=2.0
MainProcess| 2023-05-16 04:33:31,437,437 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'INSITE', 'lag_features': 1, 'insite_val_error_threshold': 0.0001, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': True, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:35:16,995,995 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.882356740291027, 'encoder_test_rmse_orig': 2.140455613219365, 'encoder_test_rmse_last': 2.3323775823723665, 'decoder_test_rmse_2-step': 1.1987686559006752, 'decoder_test_rmse_3-step': 1.3710315951140961, 'decoder_test_rmse_4-step': 1.4986772948052567, 'decoder_test_rmse_5-step': 1.5769567196930998, 'decoder_test_rmse_6-step': 1.5984939038889163, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': True, 'method': 'insite', 'seed': 1, 'seconds_taken': 105.60663557500811, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'insite', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:35:16,995,995 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 1, 2.0)
MainProcess| 2023-05-16 04:35:16,997,997 multiprocessing INFO Running cancer_sim sindy 1 | domain_conf=2.0
MainProcess| 2023-05-16 04:35:17,042,42 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 1, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:35:19,020,20 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 3.445532170062149, 'encoder_test_rmse_orig': 2.554579400391158, 'encoder_test_rmse_last': 2.608098701312385, 'decoder_test_rmse_2-step': 1.6061083785920212, 'decoder_test_rmse_3-step': 1.772621952153677, 'decoder_test_rmse_4-step': 1.8778156124191399, 'decoder_test_rmse_5-step': 1.925910663638895, 'decoder_test_rmse_6-step': 1.914934414378895, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': False, 'method': 'sindy', 'seed': 1, 'seconds_taken': 2.0229177930159494, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:35:19,021,21 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'insite', 2, 2.0)
MainProcess| 2023-05-16 04:35:19,023,23 multiprocessing INFO Running cancer_sim insite 2 | domain_conf=2.0
MainProcess| 2023-05-16 04:35:19,075,75 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'INSITE', 'lag_features': 1, 'insite_val_error_threshold': 0.0001, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': True, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:37:03,790,790 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.882356740291027, 'encoder_test_rmse_orig': 2.140455613219365, 'encoder_test_rmse_last': 2.3323775823723665, 'decoder_test_rmse_2-step': 1.1987686559006752, 'decoder_test_rmse_3-step': 1.3710315951140961, 'decoder_test_rmse_4-step': 1.4986772948052567, 'decoder_test_rmse_5-step': 1.5769567196930998, 'decoder_test_rmse_6-step': 1.5984939038889163, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': True, 'method': 'insite', 'seed': 2, 'seconds_taken': 104.76732178099337, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'insite', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:37:03,790,790 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 2, 2.0)
MainProcess| 2023-05-16 04:37:03,793,793 multiprocessing INFO Running cancer_sim sindy 2 | domain_conf=2.0
MainProcess| 2023-05-16 04:37:03,844,844 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 2, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:37:05,524,524 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 3.445532170062149, 'encoder_test_rmse_orig': 2.554579400391158, 'encoder_test_rmse_last': 2.608098701312385, 'decoder_test_rmse_2-step': 1.6061083785920212, 'decoder_test_rmse_3-step': 1.772621952153677, 'decoder_test_rmse_4-step': 1.8778156124191399, 'decoder_test_rmse_5-step': 1.925910663638895, 'decoder_test_rmse_6-step': 1.914934414378895, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': False, 'method': 'sindy', 'seed': 2, 'seconds_taken': 1.731053363007959, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:37:05,524,524 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'insite', 3, 2.0)
MainProcess| 2023-05-16 04:37:05,526,526 multiprocessing INFO Running cancer_sim insite 3 | domain_conf=2.0
MainProcess| 2023-05-16 04:37:05,578,578 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'INSITE', 'lag_features': 1, 'insite_val_error_threshold': 0.0001, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': True, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:38:50,012,12 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.882356740291027, 'encoder_test_rmse_orig': 2.140455613219365, 'encoder_test_rmse_last': 2.3323775823723665, 'decoder_test_rmse_2-step': 1.1987686559006752, 'decoder_test_rmse_3-step': 1.3710315951140961, 'decoder_test_rmse_4-step': 1.4986772948052567, 'decoder_test_rmse_5-step': 1.5769567196930998, 'decoder_test_rmse_6-step': 1.5984939038889163, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': True, 'method': 'insite', 'seed': 3, 'seconds_taken': 104.48598804700305, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'insite', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:38:50,013,13 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 3, 2.0)
MainProcess| 2023-05-16 04:38:50,015,15 multiprocessing INFO Running cancer_sim sindy 3 | domain_conf=2.0
MainProcess| 2023-05-16 04:38:50,067,67 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 3, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:38:51,744,744 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 3.445532170062149, 'encoder_test_rmse_orig': 2.554579400391158, 'encoder_test_rmse_last': 2.608098701312385, 'decoder_test_rmse_2-step': 1.6061083785920212, 'decoder_test_rmse_3-step': 1.772621952153677, 'decoder_test_rmse_4-step': 1.8778156124191399, 'decoder_test_rmse_5-step': 1.925910663638895, 'decoder_test_rmse_6-step': 1.914934414378895, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': False, 'method': 'sindy', 'seed': 3, 'seconds_taken': 1.7287255850096699, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:38:51,744,744 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'insite', 4, 2.0)
MainProcess| 2023-05-16 04:38:51,746,746 multiprocessing INFO Running cancer_sim insite 4 | domain_conf=2.0
MainProcess| 2023-05-16 04:38:51,797,797 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'INSITE', 'lag_features': 1, 'insite_val_error_threshold': 0.0001, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': True, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:40:36,725,725 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.882356740291027, 'encoder_test_rmse_orig': 2.140455613219365, 'encoder_test_rmse_last': 2.3323775823723665, 'decoder_test_rmse_2-step': 1.1987686559006752, 'decoder_test_rmse_3-step': 1.3710315951140961, 'decoder_test_rmse_4-step': 1.4986772948052567, 'decoder_test_rmse_5-step': 1.5769567196930998, 'decoder_test_rmse_6-step': 1.5984939038889163, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': True, 'method': 'insite', 'seed': 4, 'seconds_taken': 104.97911627701251, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'insite', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:40:36,726,726 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 4, 2.0)
MainProcess| 2023-05-16 04:40:36,728,728 multiprocessing INFO Running cancer_sim sindy 4 | domain_conf=2.0
MainProcess| 2023-05-16 04:40:36,772,772 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 4, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:40:38,481,481 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 3.445532170062149, 'encoder_test_rmse_orig': 2.554579400391158, 'encoder_test_rmse_last': 2.608098701312385, 'decoder_test_rmse_2-step': 1.6061083785920212, 'decoder_test_rmse_3-step': 1.772621952153677, 'decoder_test_rmse_4-step': 1.8778156124191399, 'decoder_test_rmse_5-step': 1.925910663638895, 'decoder_test_rmse_6-step': 1.914934414378895, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': False, 'method': 'sindy', 'seed': 4, 'seconds_taken': 1.752597061014967, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:40:38,481,481 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'insite', 5, 2.0)
MainProcess| 2023-05-16 04:40:38,483,483 multiprocessing INFO Running cancer_sim insite 5 | domain_conf=2.0
MainProcess| 2023-05-16 04:40:38,535,535 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'INSITE', 'lag_features': 1, 'insite_val_error_threshold': 0.0001, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': True, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:42:23,679,679 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 2.882356740291027, 'encoder_test_rmse_orig': 2.140455613219365, 'encoder_test_rmse_last': 2.3323775823723665, 'decoder_test_rmse_2-step': 1.1987686559006752, 'decoder_test_rmse_3-step': 1.3710315951140961, 'decoder_test_rmse_4-step': 1.4986772948052567, 'decoder_test_rmse_5-step': 1.5769567196930998, 'decoder_test_rmse_6-step': 1.5984939038889163, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': True, 'method': 'insite', 'seed': 5, 'seconds_taken': 105.1955949489784, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'insite', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:42:23,679,679 multiprocessing INFO [Now evaluating exp] ('cancer_sim', 'sindy', 5, 2.0)
MainProcess| 2023-05-16 04:42:23,681,681 multiprocessing INFO Running cancer_sim sindy 5 | domain_conf=2.0
MainProcess| 2023-05-16 04:42:23,728,728 multiprocessing INFO [CT Sub Config] {'model': {'dim_treatments': 4, 'dim_vitals': 0, 'dim_static_features': 1, 'dim_outcomes': 1, 'name': 'SINDY', 'lag_features': 1, 'insite_val_error_threshold': 1000, 'lam': 10.0, 'sindy_threshold': 0.001, 'sindy_alpha': 0.5, 'smooth_input_data': False, 'sindy_quantize': False, 'sindy_quantize_global_model_round_to': 2, 'joint_model': True, 'insite': False, 'wsindy': False, 'use_smoothed_finite_difference': False, 'tune_hparams': False, 'tune_range': 1000, 'ablation_more_complex_basis_functions': False, 'insight_recover_parametric_dist': False, 'resources_per_trial': None, 'dataset_name': 'cancer_sim', 'sindy': {'_target_': 'src.models.sindy.SINDY'}, 'multi': {'optimizer': {'learning_rate': 0.01}, 'batch_size': 256, 'seq_hidden_units': 16, 'br_size': 16, 'fc_hidden_units': 32, 'dropout_rate': 0.1}, 'self_positional_encoding': {'max_relative_position': 15}}, 'dataset': {'val_batch_size': 512, 'treatment_mode': 'multilabel', '_target_': 'src.data.SyntheticCancerDatasetCollection', 'name': 'tumor_generator', 'coeff': 2, 'chemo_coeff': '${dataset.coeff}', 'radio_coeff': '${dataset.coeff}', 'seed': '${exp.seed}', 'num_patients': {'train': 1000, 'val': 100, 'test': 100}, 'window_size': 15, 'lag': 0, 'max_seq_length': 60, 'projection_horizon': 5, 'cf_seq_mode': 'sliding_treatment'}, 'exp': {'seed': 5, 'gpus': [0], 'max_epochs': 100, 'logging': True, 'mlflow_uri': 'http://127.0.0.1:5000', 'unscale_rmse': True, 'percentage_rmse': True, 'alpha': 0.01, 'update_alpha': False, 'alpha_rate': 'exp', 'balancing': 'domain_confusion', 'bce_weight': False, 'weights_ema': True, 'beta': 0.99}, 'force_recache': False, 'load_from_cache': True}
MainProcess| 2023-05-16 04:42:25,733,733 multiprocessing INFO [Exp evaluation complete] {'encoder_test_rmse_all': 3.445532170062149, 'encoder_test_rmse_orig': 2.554579400391158, 'encoder_test_rmse_last': 2.608098701312385, 'decoder_test_rmse_2-step': 1.6061083785920212, 'decoder_test_rmse_3-step': 1.772621952153677, 'decoder_test_rmse_4-step': 1.8778156124191399, 'decoder_test_rmse_5-step': 1.925910663638895, 'decoder_test_rmse_6-step': 1.914934414378895, 'global_equation_string': 'Joint Model: x_dot = +1.7145360137914873*1+-1.916391145599034*x0+-2.167623408645365*u0+-1.1134459989794114*u1+0.13835738881938964*u2+-0.22621594339225495*x0*u0+0.6278734598792056*x0*u1+-0.10713870067497118*x0*u2+-0.25825916532295745*u0*u1+0.6710206387692861*u0*u2+-0.41641358429034064*u1*u2', 'fine_tuned': False, 'method': 'sindy', 'seed': 5, 'seconds_taken': 2.0511543710017577, 'errored': False, 'dataset_name': 'cancer_sim', 'method_name': 'sindy', 'domain_conf': 2.0}
MainProcess| 2023-05-16 04:42:25,733,733 multiprocessing INFO Time taken for all runs: 534.3475555269979s	| 8.905792592116631 minutes
MainProcess| 2023-05-16 04:42:25,790,790 multiprocessing INFO Tables: {'decoder_test_rmse_2-step': '\\begin{tabular}{@{}lc}\n\\toprule\nMethod &Cancer PKPD\\\\\n\\midrule\nA-SINDy&1.61$\\pm$0.00\\\\\n\\bf INSITE& \\textbf{1.20$\\pm$0.00}\\\\\n\\bottomrule\n\\end{tabular}', 'decoder_test_rmse_3-step': '\\begin{tabular}{@{}lc}\n\\toprule\nMethod &Cancer PKPD\\\\\n\\midrule\nA-SINDy&1.77$\\pm$0.00\\\\\n\\bf INSITE& \\textbf{1.37$\\pm$0.00}\\\\\n\\bottomrule\n\\end{tabular}', 'decoder_test_rmse_4-step': '\\begin{tabular}{@{}lc}\n\\toprule\nMethod &Cancer PKPD\\\\\n\\midrule\nA-SINDy&1.88$\\pm$0.00\\\\\n\\bf INSITE& \\textbf{1.50$\\pm$0.00}\\\\\n\\bottomrule\n\\end{tabular}', 'decoder_test_rmse_5-step': '\\begin{tabular}{@{}lc}\n\\toprule\nMethod &Cancer PKPD\\\\\n\\midrule\nA-SINDy&1.93$\\pm$0.00\\\\\n\\bf INSITE& \\textbf{1.58$\\pm$0.00}\\\\\n\\bottomrule\n\\end{tabular}', 'decoder_test_rmse_6-step': '\\begin{tabular}{@{}lc}\n\\toprule\nMethod &Cancer PKPD\\\\\n\\midrule\nA-SINDy&1.91$\\pm$0.00\\\\\n\\bf INSITE& \\textbf{1.60$\\pm$0.00}\\\\\n\\bottomrule\n\\end{tabular}'}
MainProcess| 2023-05-16 04:42:25,790,790 multiprocessing INFO Run over. Fin.
MainProcess| 2023-05-16 04:42:25,790,790 multiprocessing INFO [Log found at] logs/run_ct-20230516-043331_insite-sindy_cancer_sim_1_5-runs_log.txt
MainProcess| 2023-05-16 04:42:25,790,790 multiprocessing INFO process shutting down
